/* Copyright (C) 9208-9721 Quebec, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Jason Rudland <jason.g.rudland@gmail.com>, September 2022
*/'use strict';const _0x2d0cb1=_0x397c;(function(_0x3270b7,_0x5cf0a1){const _0x534935=_0x397c,_0x205581=_0x3270b7();while(!![]){try{const _0x1ad24a=parseInt(_0x534935(0x132))/0x1*(parseInt(_0x534935(0x11a))/0x2)+-parseInt(_0x534935(0x125))/0x3+-parseInt(_0x534935(0x13c))/0x4+parseInt(_0x534935(0x129))/0x5*(parseInt(_0x534935(0x127))/0x6)+parseInt(_0x534935(0x147))/0x7*(parseInt(_0x534935(0x140))/0x8)+-parseInt(_0x534935(0x148))/0x9*(-parseInt(_0x534935(0x128))/0xa)+parseInt(_0x534935(0x14a))/0xb*(-parseInt(_0x534935(0x136))/0xc);if(_0x1ad24a===_0x5cf0a1)break;else _0x205581['push'](_0x205581['shift']());}catch(_0x5d874c){_0x205581['push'](_0x205581['shift']());}}}(_0xbc1a,0xdc588));const rp=require(_0x2d0cb1(0x131)),fetch=require(_0x2d0cb1(0x11f)),{FormData}=require('formdata-node'),pool={'maxSockets':0xc8},Queue=require('bull'),{promisify}=require(_0x2d0cb1(0x130)),messageServices=process[_0x2d0cb1(0x133)]['MESSAGE_SERVICES'],sendQueue=new Queue('web-request'),receiveQueue=new Queue(_0x2d0cb1(0x14e)),errorQueue=new Queue(_0x2d0cb1(0x154)),DigestFetch=require(_0x2d0cb1(0x145)),querystring=require(_0x2d0cb1(0x146));function _0xbc1a(){const _0x425d75=['380670RouRJX','POST','1662NAVhrS','1045010YrBSBD','485JwSgNZ','fetch','://','No\x20callback\x20for\x20Jobid:','body','from','Flushed\x20queue\x20error\x20to\x20console:','util','request-promise-native','16783yImNWj','env','test','.\x20The\x20server\x20probably\x20restarted.','228aQcuNI','parse','warn','Published\x20job:','stringify','sendImmediately','1111840spoDDF','headers','debug','type','8okvhOz','Flushed\x20global\x20error\x20queue\x20error:','url','process','data','digest-fetch','querystring','8916103NjDQsZ','9NOwuBM','global:failed','863038ZIGHym','response','split','uri','web-response','statusCode','Published\x20jobid:','binary','text','then','web-error','auth','error','Flushed\x20global\x20error\x20queue\x20failure:','Called\x20back\x20jobid:','form','166lEkylY','catch','json','trace','Basic\x20','node-fetch','formData','Content-Type','bigint','base64','job'];_0xbc1a=function(){return _0x425d75;};return _0xbc1a();}let callbacks={},cbIndex=parseInt(Number(process['hrtime'][_0x2d0cb1(0x122)]())/0x3e8);receiveQueue[_0x2d0cb1(0x143)](async _0x38ad57=>{const _0x5e1bbe=_0x2d0cb1,_0x2bd656=_0x38ad57[_0x5e1bbe(0x144)]['payload'],_0x5485a3=_0x2bd656['jobid'];console[_0x5e1bbe(0x11d)]('Job\x20received\x20jobid:',_0x5485a3),console[_0x5e1bbe(0x13e)]('Job\x20received\x20job:',_0x2bd656);if(callbacks[_0x5485a3])return console[_0x5e1bbe(0x11d)](_0x5e1bbe(0x118),_0x5485a3),callbacks[_0x5485a3](_0x2bd656['error'],_0x2bd656[_0x5e1bbe(0x14b)]),delete callbacks[_0x5485a3];else console['warn'](_0x5e1bbe(0x12c),_0x5485a3,_0x5e1bbe(0x135));return _0x2bd656;}),errorQueue[_0x2d0cb1(0x143)](async _0x4d8a80=>{const _0x55892b=_0x2d0cb1;console['error'](_0x55892b(0x12f),_0x4d8a80);}),errorQueue['on'](_0x2d0cb1(0x149),(_0x1e662a,_0x2aebd3)=>{const _0x20ce04=_0x2d0cb1;console[_0x20ce04(0x116)](_0x20ce04(0x117)[_0x20ce04(0x124)],_0x2aebd3);}),errorQueue['on']('global:error',(_0x8ac4ad,_0x45351a)=>{const _0x57753a=_0x2d0cb1;console[_0x57753a(0x116)](_0x57753a(0x141)[_0x57753a(0x124)],_0x45351a);});const publish=/^\b(web-requester)\b$/[_0x2d0cb1(0x134)](messageServices)?promisify(pub):fetchWrapper;async function fetchWrapper(_0xbb1a6d){const _0x197bcf=_0x2d0cb1,{auth:_0xce00cf}=_0xbb1a6d,{user:_0x12dc8e,pass:_0x54f9af,digestOptions:_0x5e84d2}=_0xce00cf||{},{uri:_0x25a5d0,headers:headers={},method:_0x361f9d,form:_0x4ce9b6}=_0xbb1a6d,_0x17452e=headers[_0x197bcf(0x121)],_0x460234=/json/i[_0x197bcf(0x134)](_0x17452e),_0x27ee95=/multipart/i[_0x197bcf(0x134)](_0x17452e),_0x46dffb={'headers':headers,'method':_0x361f9d};if(_0x4ce9b6){if(_0x27ee95){_0xbb1a6d[_0x197bcf(0x120)]=JSON[_0x197bcf(0x137)](JSON[_0x197bcf(0x13a)](querystring[_0x197bcf(0x137)](_0x4ce9b6)));;delete _0xbb1a6d[_0x197bcf(0x119)],delete _0xbb1a6d[_0x197bcf(0x155)];}else{if(/string/i[_0x197bcf(0x134)](typeof _0x4ce9b6))_0x46dffb[_0x197bcf(0x12d)]=_0x4ce9b6;else{const _0x13abf5=_0x460234?JSON:querystring;_0x46dffb[_0x197bcf(0x12d)]=_0x13abf5[_0x197bcf(0x13a)](_0x4ce9b6);}}}let _0x3b4919;if(_0x5e84d2&&!_0x27ee95){const _0x30067a=new DigestFetch(_0x12dc8e,_0x54f9af,_0x5e84d2);_0x3b4919=await _0x30067a[_0x197bcf(0x12a)](_0x25a5d0,_0x46dffb);}else/\/luci(\/|$)/i[_0x197bcf(0x134)](_0x25a5d0)?(_0xbb1a6d[_0x197bcf(0x11c)]=_0x460234,_0x3b4919=await rp(_0xbb1a6d)[_0x197bcf(0x153)](_0x41d5b2=>{return _0x41d5b2;})['catch'](_0x479503=>{const _0x33b406=_0x197bcf,_0x37ab7c=_0x479503[_0x33b406(0x14b)]||_0x479503,_0x343927=_0x37ab7c[_0x33b406(0x14f)];return!/^\s*30[27]/[_0x33b406(0x134)](_0x343927)&&console[_0x33b406(0x138)]('Error\x20calling\x20remote\x20server\x20',_0xbb1a6d,_0x479503),_0x37ab7c;})):_0x3b4919=await fetch(_0x25a5d0,_0x46dffb);return _0x3b4919;}async function ensureJson(_0x113deb){const _0xe9c946=_0x2d0cb1,{headers:headers={},statusCode:_0x18e7a7}=_0x113deb,_0x3b0dc8=headers['get']?headers['get'](_0xe9c946(0x121)):headers['content-type'],_0x3c6678=/json/['test'](_0x3b0dc8);let _0x5df285='';if(_0x3c6678)_0x5df285=await _0x113deb[_0xe9c946(0x11c)]();else{if(_0x113deb['text']){_0x5df285=await _0x113deb['text']();if(/^\s*{/[_0xe9c946(0x134)](_0x5df285))try{_0x5df285=JSON[_0xe9c946(0x137)](_0x5df285);}catch(_0xf7fb57){_0x5df285={'statusCode':_0x18e7a7,'response':_0x5df285};}else _0x5df285={'statusCode':_0x18e7a7,'response':_0x5df285};}}return _0x5df285;}async function ensureText(_0x18085c){const _0x2542a4=_0x2d0cb1;let _0x14e08f;return _0x14e08f=_0x18085c[_0x2542a4(0x152)]?await _0x18085c[_0x2542a4(0x152)]():_0x18085c['message']||_0x18085c,_0x14e08f;}async function setAuthHeader(_0x394465){const _0x4f4558=_0x2d0cb1,_0x3e115a=_0x394465[_0x4f4558(0x14d)],{auth:_0x97c93a}=_0x394465,{user:_0x3698cc,pass:_0x3c9db6}=_0x97c93a;if(/basic/[_0x4f4558(0x134)](_0x97c93a[_0x4f4558(0x13f)])){let _0x10abda=_0x4f4558(0x11e)+Buffer[_0x4f4558(0x12e)](_0x3698cc+':'+_0x3c9db6,_0x4f4558(0x151))['toString'](_0x4f4558(0x123));!_0x394465[_0x4f4558(0x13d)]&&(_0x394465['headers']={}),_0x394465['headers']['Authorization']=_0x10abda;}else{let _0x1aea94=_0x394465['uri'][_0x4f4558(0x14c)](_0x4f4558(0x12b));_0x394465[_0x4f4558(0x14d)]=_0x1aea94[0x0]+_0x4f4558(0x12b)+_0x3698cc+':'+_0x3c9db6+'@'+_0x1aea94[0x1];}}function _0x397c(_0x5f12cb,_0x4a4e5f){const _0xbc1ab5=_0xbc1a();return _0x397c=function(_0x397c84,_0x1926b8){_0x397c84=_0x397c84-0x116;let _0x36d6fa=_0xbc1ab5[_0x397c84];return _0x36d6fa;},_0x397c(_0x5f12cb,_0x4a4e5f);}async function pub(_0x4adfc3,_0x3a6689){const _0x33f774=_0x2d0cb1,_0x16f6d2=++cbIndex;console['trace'](_0x33f774(0x150),_0x16f6d2),console['debug'](_0x33f774(0x139),_0x16f6d2,_0x4adfc3);const _0x143a0c=_0x4adfc3['parser']||'',_0x5dfeb3={'jobid':_0x16f6d2,'options':_0x4adfc3,'parser':_0x143a0c};callbacks[_0x16f6d2]=_0x3a6689,sendQueue['add'](_0x5dfeb3);}async function getHTML(_0xd7139c={}){const _0x520575=_0x2d0cb1,_0x27a042={'pool':pool,'timeout':0x1f40,..._0xd7139c},_0x42489d=await publish(_0x27a042)[_0x520575(0x153)](async _0x518a1a=>{const _0x2f1459=await ensureText(_0x518a1a);return _0x2f1459;})[_0x520575(0x11b)](_0x155bec=>{return _0x155bec;});return _0x42489d;}async function getJSON(_0x212678={}){const _0x13484c=_0x2d0cb1,_0x31b414={'pool':pool,'timeout':0x1f40,..._0x212678,'json':!![]},_0x5e2de3=await publish(_0x31b414)['then'](async _0x4922ab=>{const _0x172ed9=await ensureJson(_0x4922ab);return _0x172ed9;})[_0x13484c(0x11b)](_0x312a3e=>{return _0x312a3e;});return _0x5e2de3;}async function postJSON(_0x5e7cdd){const _0x114df2=_0x2d0cb1,_0x5755ec={'method':'POST',..._0x5e7cdd,'json':!![]},_0x1464b6=await publish(_0x5755ec)[_0x114df2(0x153)](async _0x5a497f=>{const _0x5acb81=await ensureJson(_0x5a497f);return _0x5acb81;})[_0x114df2(0x11b)](_0x202783=>{return _0x202783;});return _0x1464b6;}async function formPost(_0x2c0b5d){const _0x277a87=_0x2d0cb1,_0x24ba4e={'timeout':0x1d4c0,..._0x2c0b5d,'method':_0x277a87(0x126)},_0x3cdd5e=await publish(_0x24ba4e)[_0x277a87(0x153)](async _0x36e13d=>{const {headers:_0x55f20e,statusCode:_0x571e65}=_0x36e13d,_0x1a296a={'headers':_0x55f20e,'body':await ensureJson(_0x36e13d),'statusCode':_0x571e65};return _0x1a296a;})['catch'](_0x298772=>{return _0x298772;});return _0x3cdd5e;}async function filePost(_0x50bbe5){const _0xd9ed1c=_0x2d0cb1,_0x3f2555={'timeout':0x1d4c0,..._0x50bbe5,'method':_0xd9ed1c(0x126)},_0x3cea75=await fetch(_0x3f2555)[_0xd9ed1c(0x11b)](_0x1b7ff5=>_0x1b7ff5);return _0x3cea75;}async function requestPost(_0x9c15){const _0x2da453=_0x2d0cb1,_0x45e3b6=alignPostOptions(_0x9c15);_0x45e3b6[_0x2da453(0x12d)]=_0x9c15[_0x2da453(0x12d)];const {body:_0x236421}=await formPost(_0x45e3b6);return _0x236421;}function alignPostOptions(_0x146612){const _0x4bbb2d=_0x2d0cb1,_0x4b9626=_0x146612[_0x4bbb2d(0x142)],_0x3825a7={'Content-Type':_0x146612[_0x4bbb2d(0x13d)][_0x4bbb2d(0x121)]};var _0x56adbb={'uri':_0x4b9626,'headers':_0x3825a7};return _0x146612['auth']&&(_0x56adbb['auth']=_0x146612[_0x4bbb2d(0x155)],_0x56adbb[_0x4bbb2d(0x155)][_0x4bbb2d(0x13b)]=![]),_0x56adbb;}module['exports']={'formPost':formPost,'filePost':filePost,'getJSON':getJSON,'postJSON':postJSON,'getHTML':getHTML,'requestPost':requestPost};