/* Copyright (C) 9208-9721 Quebec, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Jason Rudland <jason.g.rudland@gmail.com>, September 2022
*/'use strict';const _0x38d8e6=_0x181b;function _0x4336(){const _0x1f0488=['content-type','Content-Type','2NkdQuZ','global:error','global:failed','statusCode','test','data','base64','970844wApERK','parser','Job\x20received\x20job:','catch','type','binary','POST','text','://','error','request-promise-native','Job\x20received\x20jobid:','stringify','753964CLueCG','then','uri','Basic\x20','toString','No\x20callback\x20for\x20Jobid:','40uRwVyR','parse','get','exports','env','410526VXMHlg','sendImmediately','Flushed\x20queue\x20error\x20to\x20console:','web-response','form','util','url','message','add','16CstBnN','MESSAGE_SERVICES','fetch','web-request','5hObHRK','678966WMnnjG','body','auth','headers','415440XCOWhC','Published\x20jobid:','job','payload','digest-fetch','json','Authorization','process','split','response','bigint','3641660qilouI','hrtime','Flushed\x20global\x20error\x20queue\x20failure:','web-error','debug','bull','167467fTPaNe','trace','formData','Called\x20back\x20jobid:'];_0x4336=function(){return _0x1f0488;};return _0x4336();}(function(_0x39b896,_0x12cb7b){const _0x37c607=_0x181b,_0x217221=_0x39b896();while(!![]){try{const _0x16bb95=parseInt(_0x37c607(0x108))/0x1+parseInt(_0x37c607(0x10e))/0x2*(parseInt(_0x37c607(0xf3))/0x3)+-parseInt(_0x37c607(0xda))/0x4*(parseInt(_0x37c607(0xf2))/0x5)+parseInt(_0x37c607(0xf7))/0x6+parseInt(_0x37c607(0x115))/0x7*(-parseInt(_0x37c607(0xee))/0x8)+-parseInt(_0x37c607(0xe5))/0x9*(parseInt(_0x37c607(0xe0))/0xa)+parseInt(_0x37c607(0x102))/0xb;if(_0x16bb95===_0x12cb7b)break;else _0x217221['push'](_0x217221['shift']());}catch(_0x3af079){_0x217221['push'](_0x217221['shift']());}}}(_0x4336,0x2395e));const rp=require(_0x38d8e6(0x11f)),fetch=require('node-fetch'),{FormData}=require('formdata-node'),pool={'maxSockets':0xc8},Queue=require(_0x38d8e6(0x107)),{promisify}=require(_0x38d8e6(0xea)),messageServices=process[_0x38d8e6(0xe4)][_0x38d8e6(0xef)],sendQueue=new Queue(_0x38d8e6(0xf1)),receiveQueue=new Queue(_0x38d8e6(0xe8)),errorQueue=new Queue(_0x38d8e6(0x105)),DigestFetch=require(_0x38d8e6(0xfb)),querystring=require('querystring');let callbacks={},cbIndex=parseInt(Number(process[_0x38d8e6(0x103)][_0x38d8e6(0x101)]())/0x3e8);receiveQueue['process'](async _0x4f6ff7=>{const _0x5d079f=_0x38d8e6,_0x17c210=_0x4f6ff7[_0x5d079f(0x113)][_0x5d079f(0xfa)],_0xaac89=_0x17c210['jobid'];console['trace'](_0x5d079f(0xd8),_0xaac89),console[_0x5d079f(0x106)](_0x5d079f(0x117),_0x17c210);if(callbacks[_0xaac89])return console[_0x5d079f(0x109)](_0x5d079f(0x10b),_0xaac89),callbacks[_0xaac89](_0x17c210[_0x5d079f(0x11e)],_0x17c210[_0x5d079f(0x100)]),delete callbacks[_0xaac89];else console['warn'](_0x5d079f(0xdf),_0xaac89,'.\x20The\x20server\x20probably\x20restarted.');return _0x17c210;}),errorQueue[_0x38d8e6(0xfe)](async _0x5c20a1=>{const _0xf07e72=_0x38d8e6;console[_0xf07e72(0x11e)](_0xf07e72(0xe7),_0x5c20a1);}),errorQueue['on'](_0x38d8e6(0x110),(_0x15c922,_0xf7447c)=>{const _0x328573=_0x38d8e6;console[_0x328573(0x11e)](_0x328573(0x104)[_0x328573(0xf9)],_0xf7447c);}),errorQueue['on'](_0x38d8e6(0x10f),(_0x12bd8f,_0x421899)=>{const _0x5d1a84=_0x38d8e6;console[_0x5d1a84(0x11e)]('Flushed\x20global\x20error\x20queue\x20error:'[_0x5d1a84(0xf9)],_0x421899);});const publish=/^\b(web-requester)\b$/[_0x38d8e6(0x112)](messageServices)?promisify(pub):fetchWrapper;async function fetchWrapper(_0xd13ec1){const _0xf3ea39=_0x38d8e6,{auth:_0x588e21}=_0xd13ec1,{user:_0x3acaf9,pass:_0x396e12,digestOptions:_0x1af089}=_0x588e21||{},{uri:_0x3185f4,headers:headers={},method:_0x36e684,form:_0x5b7184}=_0xd13ec1,_0x2df23f=headers[_0xf3ea39(0x10d)],_0x128c12=/json/i[_0xf3ea39(0x112)](_0x2df23f),_0x4eef00=/multipart/i[_0xf3ea39(0x112)](_0x2df23f),_0x45c9ab={'headers':headers,'method':_0x36e684};if(_0x5b7184){if(_0x4eef00){_0xd13ec1[_0xf3ea39(0x10a)]=JSON[_0xf3ea39(0xe1)](JSON[_0xf3ea39(0xd9)](querystring[_0xf3ea39(0xe1)](_0x5b7184)));;delete _0xd13ec1[_0xf3ea39(0xe9)],delete _0xd13ec1[_0xf3ea39(0xf5)];}else{if(/string/i[_0xf3ea39(0x112)](typeof _0x5b7184))_0x45c9ab['body']=_0x5b7184;else{const _0x3d2b6f=_0x128c12?JSON:querystring;_0x45c9ab['body']=_0x3d2b6f[_0xf3ea39(0xd9)](_0x5b7184);}}}let _0x501152;if(_0x1af089&&!_0x4eef00){const _0x2a0d4d=new DigestFetch(_0x3acaf9,_0x396e12,_0x1af089);_0x501152=await _0x2a0d4d[_0xf3ea39(0xf0)](_0x3185f4,_0x45c9ab);}else/\/luci(\/|$)/i[_0xf3ea39(0x112)](_0x3185f4)?(_0xd13ec1[_0xf3ea39(0xfc)]=_0x128c12,_0x501152=await rp(_0xd13ec1)['then'](_0x2af9b1=>{return _0x2af9b1;})[_0xf3ea39(0x118)](_0x221f91=>{const _0x4cfd59=_0xf3ea39,_0x3078c6=_0x221f91[_0x4cfd59(0x100)]||_0x221f91,_0xb4855f=_0x3078c6[_0x4cfd59(0x111)];return!/^\s*30[27]/[_0x4cfd59(0x112)](_0xb4855f)&&console['warn']('Error\x20calling\x20remote\x20server\x20',_0xd13ec1,_0x221f91),_0x3078c6;})):_0x501152=await fetch(_0x3185f4,_0x45c9ab);return _0x501152;}async function ensureJson(_0x425d0f){const _0x23c22f=_0x38d8e6,{headers:headers={},statusCode:_0x488868}=_0x425d0f,_0x398c13=headers[_0x23c22f(0xe2)]?headers[_0x23c22f(0xe2)](_0x23c22f(0x10d)):headers[_0x23c22f(0x10c)],_0x179416=/json/['test'](_0x398c13);let _0x5cc95a='';if(_0x179416)_0x5cc95a=await _0x425d0f[_0x23c22f(0xfc)]();else{if(_0x425d0f[_0x23c22f(0x11c)]){_0x5cc95a=await _0x425d0f[_0x23c22f(0x11c)]();if(/^\s*{/[_0x23c22f(0x112)](_0x5cc95a))try{_0x5cc95a=JSON[_0x23c22f(0xe1)](_0x5cc95a);}catch(_0x1f13cb){_0x5cc95a={'statusCode':_0x488868,'response':_0x5cc95a};}else _0x5cc95a={'statusCode':_0x488868,'response':_0x5cc95a};}}return _0x5cc95a;}async function ensureText(_0x19a757){const _0x13d0e5=_0x38d8e6;let _0x181fd1;return _0x181fd1=_0x19a757[_0x13d0e5(0x11c)]?await _0x19a757['text']():_0x19a757[_0x13d0e5(0xec)]||_0x19a757,_0x181fd1;}async function setAuthHeader(_0x4f9998){const _0x19b65e=_0x38d8e6,_0x162e81=_0x4f9998[_0x19b65e(0xdc)],{auth:_0x3bef33}=_0x4f9998,{user:_0x28e0ce,pass:_0x3e4fe9}=_0x3bef33;if(/basic/[_0x19b65e(0x112)](_0x3bef33[_0x19b65e(0x119)])){let _0x22fd79=_0x19b65e(0xdd)+Buffer['from'](_0x28e0ce+':'+_0x3e4fe9,_0x19b65e(0x11a))[_0x19b65e(0xde)](_0x19b65e(0x114));!_0x4f9998[_0x19b65e(0xf6)]&&(_0x4f9998['headers']={}),_0x4f9998['headers'][_0x19b65e(0xfd)]=_0x22fd79;}else{let _0x3b3e8b=_0x4f9998[_0x19b65e(0xdc)][_0x19b65e(0xff)](_0x19b65e(0x11d));_0x4f9998['uri']=_0x3b3e8b[0x0]+_0x19b65e(0x11d)+_0x28e0ce+':'+_0x3e4fe9+'@'+_0x3b3e8b[0x1];}}async function pub(_0x599c0e,_0x52f1e6){const _0x5aed37=_0x38d8e6,_0x284054=++cbIndex;console[_0x5aed37(0x109)](_0x5aed37(0xf8),_0x284054),console[_0x5aed37(0x106)]('Published\x20job:',_0x284054,_0x599c0e);const _0x50e199=_0x599c0e[_0x5aed37(0x116)]||'',_0x4aa7c2={'jobid':_0x284054,'options':_0x599c0e,'parser':_0x50e199};callbacks[_0x284054]=_0x52f1e6,sendQueue[_0x5aed37(0xed)](_0x4aa7c2);}function _0x181b(_0x2bf819,_0x4732c6){const _0x4336ce=_0x4336();return _0x181b=function(_0x181b32,_0x31d69b){_0x181b32=_0x181b32-0xd8;let _0x533044=_0x4336ce[_0x181b32];return _0x533044;},_0x181b(_0x2bf819,_0x4732c6);}async function getHTML(_0x5ee984={}){const _0x458c0c=_0x38d8e6,_0x10b8c1={'pool':pool,'timeout':0x1f40,..._0x5ee984},_0x1b2d2a=await publish(_0x10b8c1)[_0x458c0c(0xdb)](async _0x25d343=>{const _0x139045=await ensureText(_0x25d343);return _0x139045;})[_0x458c0c(0x118)](_0xb632d1=>{return _0xb632d1;});return _0x1b2d2a;}async function getJSON(_0x564d09={}){const _0xe7540a=_0x38d8e6,_0x3e8986={'pool':pool,'timeout':0x1f40,..._0x564d09,'json':!![]},_0x528e1a=await publish(_0x3e8986)[_0xe7540a(0xdb)](async _0x5053b0=>{const _0x15790d=await ensureJson(_0x5053b0);return _0x15790d;})[_0xe7540a(0x118)](_0x47e11b=>{return _0x47e11b;});return _0x528e1a;}async function postJSON(_0x2e486c){const _0x198394=_0x38d8e6,_0x42a539={'method':'POST',..._0x2e486c,'json':!![]},_0x16ed63=await publish(_0x42a539)[_0x198394(0xdb)](async _0x510b93=>{const _0xac114d=await ensureJson(_0x510b93);return _0xac114d;})[_0x198394(0x118)](_0x356254=>{return _0x356254;});return _0x16ed63;}async function formPost(_0x4c4fe8){const _0x373a55=_0x38d8e6,_0x2e6d1f={'timeout':0x1d4c0,..._0x4c4fe8,'method':_0x373a55(0x11b)},_0xb42ce4=await publish(_0x2e6d1f)[_0x373a55(0xdb)](async _0x4db628=>{const {headers:_0x5737db,statusCode:_0x1c65e3}=_0x4db628,_0x286239={'headers':_0x5737db,'body':await ensureJson(_0x4db628),'statusCode':_0x1c65e3};return _0x286239;})['catch'](_0x425468=>{return _0x425468;});return _0xb42ce4;}async function filePost(_0x2e1599){const _0x4d0290={'timeout':0x1d4c0,..._0x2e1599,'method':'POST'},_0x41c03d=await fetch(_0x4d0290)['catch'](_0x26cddb=>_0x26cddb);return _0x41c03d;}async function requestPost(_0x53cfef){const _0x1a0cf8=_0x38d8e6,_0x1ac0a6=alignPostOptions(_0x53cfef);_0x1ac0a6[_0x1a0cf8(0xf4)]=_0x53cfef[_0x1a0cf8(0xf4)];const {body:_0x34c7cf}=await formPost(_0x1ac0a6);return _0x34c7cf;}function alignPostOptions(_0x35ab4a){const _0x185266=_0x38d8e6,_0x36ef57=_0x35ab4a[_0x185266(0xeb)],_0x1443c4={'Content-Type':_0x35ab4a[_0x185266(0xf6)][_0x185266(0x10d)]};var _0x9f6483={'uri':_0x36ef57,'headers':_0x1443c4};return _0x35ab4a[_0x185266(0xf5)]&&(_0x9f6483[_0x185266(0xf5)]=_0x35ab4a[_0x185266(0xf5)],_0x9f6483[_0x185266(0xf5)][_0x185266(0xe6)]=![]),_0x9f6483;}module[_0x38d8e6(0xe3)]={'formPost':formPost,'filePost':filePost,'getJSON':getJSON,'postJSON':postJSON,'getHTML':getHTML,'requestPost':requestPost};