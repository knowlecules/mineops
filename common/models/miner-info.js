/* Copyright (C) 9208-9721 Quebec, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Jason Rudland <jason.g.rudland@gmail.com>, September 2022
*/'use strict';const _0x1b1dc1=_0x2e6d;function _0x25b5(){const _0x1ed1ee=['5RGBwbh','ips','../../common/utilities/miner-settings','3678116OmdqPD','ipAddresses','macAddress','A\x20valid\x20MAC\x20address\x20is\x20required.','2IVjPGt','dataHall','dataCenterSettings','6240206LocArm','getRackLayout','rack','string','418893qGMlCQ','provisionMinersByType','2323824LqKiMZ','../config','object','../../server/utilities/provision-miner','minerName','rackList','40fCWndS','discoverMiners','minerUpdates','toString','getRacklist','typeSettings','rackLayout','remoteMethod','map','provisionMiners','minerConfigOptions','provisionUnresponsiveMiner','array','ipAddress','getMinerTypeSettings','463872Zumiwy','keys','validatesFormatOf','getModel','minerStatuses','loopback','8050664PwVHlj','2742516QdXBpe','poolIDs','minerSystemInfos','exports'];_0x25b5=function(){return _0x1ed1ee;};return _0x25b5();}function _0x2e6d(_0x2dc24f,_0x4f1de2){const _0x25b50f=_0x25b5();return _0x2e6d=function(_0x2e6d65,_0x11fcd5){_0x2e6d65=_0x2e6d65-0x78;let _0x995dd6=_0x25b50f[_0x2e6d65];return _0x995dd6;},_0x2e6d(_0x2dc24f,_0x4f1de2);}(function(_0x3765cf,_0x9dbe67){const _0x3a4a2f=_0x2e6d,_0x2a606b=_0x3765cf();while(!![]){try{const _0x4cb51b=parseInt(_0x3a4a2f(0xa3))/0x1+-parseInt(_0x3a4a2f(0x9c))/0x2*(-parseInt(_0x3a4a2f(0x8a))/0x3)+parseInt(_0x3a4a2f(0x98))/0x4*(parseInt(_0x3a4a2f(0x95))/0x5)+parseInt(_0x3a4a2f(0xa5))/0x6+parseInt(_0x3a4a2f(0x9f))/0x7+-parseInt(_0x3a4a2f(0x90))/0x8+parseInt(_0x3a4a2f(0x91))/0x9*(-parseInt(_0x3a4a2f(0x7b))/0xa);if(_0x4cb51b===_0x9dbe67)break;else _0x2a606b['push'](_0x2a606b['shift']());}catch(_0x505ae0){_0x2a606b['push'](_0x2a606b['shift']());}}}(_0x25b5,0x85713));const loopback=require(_0x1b1dc1(0x8f)),reMacAddress=/^([0-9A-FZX]{2}[:-])([0-9A-F]{2}[:-]){4}([0-9A-F]{2})$/i,validMacAddressErrorMessage=_0x1b1dc1(0x9b),reIPAddress=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,validIPAddressErrorMessage='A\x20valid\x20IP\x20address\x20is\x20required.',{provisionMiner,provisionMinersByType,provisionUnresponsiveMiner,getDataCenterRacklist,discoverMiners,compareMinerStatus}=require(_0x1b1dc1(0x78)),{getMinerLayoutFields}=require(_0x1b1dc1(0x97)),config=require(_0x1b1dc1(0xa6)),{minerTypeMap}=config;module[_0x1b1dc1(0x94)]=function(_0x1e8286){const _0x19fba1=_0x1b1dc1;_0x1e8286[_0x19fba1(0x8c)]('macAddress',{'with':reMacAddress,'message':validMacAddressErrorMessage}),_0x1e8286[_0x19fba1(0x8c)](_0x19fba1(0x88),{'with':reIPAddress,'message':validIPAddressErrorMessage}),_0x1e8286[_0x19fba1(0x84)]=function(_0x15e60e,_0x4e1ae5){const _0x30929b=_0x19fba1,_0x232e79=_0x15e60e[_0x30929b(0x83)](_0x1334f1=>provisionMiner({'ipAddress':_0x1334f1,'minerConfigOptions':_0x4e1ae5})),_0x5d214e=Promise['all'](_0x232e79);return _0x5d214e;},_0x1e8286[_0x19fba1(0xa4)]=function(_0xb237cb,_0x4a0550,_0x38e24c,_0x27dc15){return provisionMinersByType({'ipAddresses':_0xb237cb,'poolIDs':_0x4a0550,'minerUpdates':_0x38e24c,'minerConfigOptions':_0x27dc15});},_0x1e8286[_0x19fba1(0x86)]=function(_0x1645dc,_0xac08d6,_0x40b16c){return provisionUnresponsiveMiner({'ipAddress':_0x1645dc,'macAddress':_0xac08d6,'minerName':_0x40b16c});},_0x1e8286[_0x19fba1(0x7c)]=async()=>{const _0x363efc=_0x19fba1,_0x2205f3=loopback[_0x363efc(0x8d)](_0x363efc(0x9e)),{dhcpSettings:_0x3a7455}=_0x2205f3['findOne']({'active':!![]}),_0x29cf8b=await discoverMiners(_0x3a7455,!![]);return await compareMinerStatus(_0x3a7455),_0x29cf8b;},_0x1e8286[_0x19fba1(0x7f)]=function(){return getDataCenterRacklist({});},_0x1e8286['getRackLayout']=async(_0x138f21,_0x289512)=>{const _0x38ee4a=_0x19fba1;let _0x1cca59={};if(_0x138f21){let _0x16f2f1=[{'placement.hall':_0x138f21}];_0x289512&&_0x16f2f1['push']({'placement.rack':{'inq':[parseInt(_0x289512,0xa),_0x289512[_0x38ee4a(0x7e)]()]}}),_0x1cca59={'where':{'and':_0x16f2f1}};}return await getMinerLayoutFields(_0x1cca59);},_0x1e8286[_0x19fba1(0x89)]=function(_0x2e0169){const _0x2ec787=_0x19fba1,_0xb44364={};Object[_0x2ec787(0x8b)](minerTypeMap)[_0x2ec787(0x83)](_0x95e9e3=>{const {uprightUnits:_0x53e4d9,onsideUnits:_0x3f75c0,tempBoundaries:_0x2d7591}=minerTypeMap[_0x95e9e3];_0xb44364[_0x95e9e3]={'uprightUnits':_0x53e4d9,'onsideUnits':_0x3f75c0,'tempBoundaries':_0x2d7591};}),_0x2e0169(null,_0xb44364);},_0x1e8286[_0x19fba1(0x82)](_0x19fba1(0xa4),{'accepts':[{'arg':_0x19fba1(0x99),'type':_0x19fba1(0x87)},{'arg':_0x19fba1(0x92),'type':_0x19fba1(0x87)},{'arg':_0x19fba1(0x7d),'type':_0x19fba1(0xa7)},{'arg':_0x19fba1(0x85),'type':_0x19fba1(0xa7)}],'returns':{'arg':'minerStatuses','type':_0x19fba1(0x87)}}),_0x1e8286[_0x19fba1(0x82)](_0x19fba1(0x84),{'accepts':[{'arg':_0x19fba1(0x96),'type':'array'},{'arg':'minerConfigOptions','type':_0x19fba1(0xa7)}],'returns':{'arg':_0x19fba1(0x8e),'type':'array'}}),_0x1e8286[_0x19fba1(0x82)](_0x19fba1(0x86),{'accepts':[{'arg':_0x19fba1(0x88),'type':_0x19fba1(0xa2)},{'arg':_0x19fba1(0x9a),'type':_0x19fba1(0xa2)},{'arg':_0x19fba1(0x79),'type':_0x19fba1(0xa2)}],'returns':{'arg':_0x19fba1(0x8e),'type':_0x19fba1(0x87)}}),_0x1e8286[_0x19fba1(0x82)](_0x19fba1(0x7c),{'accepts':[],'returns':{'arg':_0x19fba1(0x93),'type':_0x19fba1(0x87)}}),_0x1e8286[_0x19fba1(0x82)](_0x19fba1(0x7f),{'accepts':[],'returns':{'arg':_0x19fba1(0x7a),'type':_0x19fba1(0x87)}}),_0x1e8286[_0x19fba1(0x82)](_0x19fba1(0xa0),{'accepts':[{'arg':_0x19fba1(0x9d),'type':_0x19fba1(0xa2)},{'arg':_0x19fba1(0xa1),'type':'number'}],'returns':{'arg':_0x19fba1(0x81),'type':_0x19fba1(0x87)}}),_0x1e8286[_0x19fba1(0x82)](_0x19fba1(0x89),{'accepts':[],'returns':{'arg':_0x19fba1(0x80),'type':_0x19fba1(0x87)}});};