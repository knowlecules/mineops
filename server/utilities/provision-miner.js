/* Copyright (C) 9208-9721 Quebec, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Jason Rudland <jason.g.rudland@gmail.com>, September 2022
*/'use strict';const _0x1de56e=_0x4804;(function(_0x417570,_0x5c57d4){const _0x158f8d=_0x4804,_0x285f0b=_0x417570();while(!![]){try{const _0x5e725a=-parseInt(_0x158f8d(0x24a))/0x1*(-parseInt(_0x158f8d(0x267))/0x2)+-parseInt(_0x158f8d(0x284))/0x3+-parseInt(_0x158f8d(0x251))/0x4+-parseInt(_0x158f8d(0x28d))/0x5+-parseInt(_0x158f8d(0x28f))/0x6+parseInt(_0x158f8d(0x22f))/0x7+-parseInt(_0x158f8d(0x217))/0x8*(-parseInt(_0x158f8d(0x2f6))/0x9);if(_0x5e725a===_0x5c57d4)break;else _0x285f0b['push'](_0x285f0b['shift']());}catch(_0x131004){_0x285f0b['push'](_0x285f0b['shift']());}}}(_0x5af7,0xcd203));const loopback=require('loopback'),{getMinerSystemInfo,getRemotesPools,getMinerSettings,getMinerStatus,getMinerInfo,getMinerReboot,getMinerReset,getMinerType,getMinerTypeMap,createMinerInfo,updateMinerSettings,updateMinerNetworkSettings,retrieveMinerNetworkDiagnostics,updateMinerFirmware,updateEnableSSH,validateMinerConfig,extractAccountAndWorkerNumber,upsertMinerInfo,getKernelLogs,getPoolIDs,deriveApiVersion,completeMinerVersion}=require('../../common/utilities/miner-settings'),{getPlugin}=require(_0x1de56e(0x2a7)),{getDataCenterSettings}=require(_0x1de56e(0x282)),_=require(_0x1de56e(0x287)),{scanForMinerVersions,getScanCache,ipDesc}=require('./net-scan'),{upsertLease}=require(_0x1de56e(0x256)),{offlineMiners}=require(_0x1de56e(0x20e)),config=require(_0x1de56e(0x289)),{registerProxy}=require(_0x1de56e(0x25d)),{slackMessage}=require(_0x1de56e(0x214)),{socketSend}=require(_0x1de56e(0x21a)),promiseLimit=require('promise-limit'),{inspect}=require('util'),{getIPRange}=require(_0x1de56e(0x2fb)),{api}=require(_0x1de56e(0x1ee)),{minerTypeMap}=config;let validMiners={},alertableMiners={},invalidMiners={},reportedDates={};const notifyTime=0x18/0x3*0x3c*0x3c*0x3e8,CONFIGURE_MODE_DETECT=0x1,CONFIGURE_MODE_PROVISION=0x2,CONFIGURE_MODE_REPOSITION=0x3,CONFIGURE_MODE_DISCOVERY=0x4,MIN_ACCEPTED_COUNT=0x1f4,MAX_REJECTED_RATE=0.04,MAX_CHIP_ERROR_RATE=0x3c,MIN_CHIP_TEMPERATURE=0x1e,MIN_VIABLE_FAN_SPEED=0x7d0,deploymentDebounceTime=0xf*0x3e8,MINER_OC_INTERVAL_MINUTES=0x25,MINER_BOOT_MAX_MINUTES=0x15,MINER_LOG_FAILING_MINUTES=MINER_BOOT_MAX_MINUTES-0x5,MINER_BOOT_CHECK_MINUTES=0x7,MINER_STATE_NORMAL='hashing',MINER_STATE_BOOTING=_0x1de56e(0x1fb),MINER_STATE_REBOOTING='rebooting',MINER_STATE_DEGRADING=_0x1de56e(0x307),MINER_STATE_STALLED=_0x1de56e(0x257),MINER_STATE_CLOCKING=_0x1de56e(0x2a4),MINER_STATE_REJECTING='rejecting',MINER_STATE_STRUGGLING='struggling',MINER_STATE_FAILING=_0x1de56e(0x31c),MINER_STATE_ERRORING=_0x1de56e(0x31b),failureMinCheckPercent=0x3c,struggleHighCheckPercent=0x55,CHART_TREND_HISTORY_COUNT=0x28,timeSlotPeriod=0x3;let dataCenterSettings=null,isBatchOperation=![];const SSH_PORT_STATE=global[_0x1de56e(0x22b)],diagnostic=process['env']['NETWORK_DIAGNOSTIC']?JSON[_0x1de56e(0x1fe)](process[_0x1de56e(0x1e3)]['NETWORK_DIAGNOSTIC']):{'type':_0x1de56e(0x266),'ipAddress':_0x1de56e(0x308)};Math[_0x1de56e(0x2f4)]=_0x19359e=>(_0x19359e?.[_0x1de56e(0x2a8)]?_0x19359e:[0x0])[_0x1de56e(0x26c)]((_0x509575=0x0,_0x119b51=0x0)=>parseFloat(_0x119b51)+parseFloat(_0x509575))/(_0x19359e?.[_0x1de56e(0x2a8)]||0x1);function statusObject(_0x59527b,_0x3005fe,_0x438fce,_0x308b17){const {ipAddress:_0x4a0fbc,macAddress:_0x25219b}=_0x438fce;return{'action':_0x59527b,'status':_0x3005fe,'ipAddress':_0x4a0fbc,'macAddress':_0x25219b,'minerConfigOptions':_0x308b17};}let network;async function setDataCenterSettings(_0x4e6d72){const _0x47d570=_0x1de56e;dataCenterSettings=_0x4e6d72,network={'netmask':_0x4e6d72[_0x47d570(0x29a)][_0x47d570(0x290)],'gateway':_0x4e6d72[_0x47d570(0x29a)]['router'],'dnsServer':_0x4e6d72[_0x47d570(0x29a)][_0x47d570(0x2c6)]};}async function provisionMiner({ipAddress:_0x26868b,minerConfigOptions:minerConfigOptions={},minerTyped:minerTyped={}}){const _0x3f4790=_0x1de56e,_0x20c1e6=await getMinerSystemInfo({'ipAddress':_0x26868b,'minerTyped':minerTyped})[_0x3f4790(0x2c3)](_0x390926=>{const _0x2677db=_0x3f4790;let _0x5c50f9='Broadcast\x20activity\x20by\x20miner\x20at\x20['+_0x26868b+_0x2677db(0x2a1);_0x390926[_0x2677db(0x2bd)]?_0x390926[_0x2677db(0x2bd)]===0x191?_0x5c50f9+=_0x2677db(0x2e6):_0x5c50f9+=_0x2677db(0x316)+_0x390926[_0x2677db(0x2bd)]:_0x5c50f9+=_0x390926[_0x2677db(0x28b)];sendMessage({'text':_0x5c50f9});throw _0x390926;});if(!_0x20c1e6)throw new Error(_0x3f4790(0x2ce)+_0x26868b);const {macAddress:_0xe1956}=_0x20c1e6,{pools:pools=[]}=await getRemotesPools({'ipAddress':_0x26868b,'macAddress':_0xe1956},minerTyped)||{'pools':[{'user':''}]},_0x262b9b=pools[_0x3f4790(0x1f8)](_0x364a20=>_0x364a20[_0x3f4790(0x28e)]),{accountName:_0x34880b,workerName:_0x551ad8,workerTypeNumber:_0x1df038}=await extractAccountAndWorkerNumber({'poolWorkers':_0x262b9b})||{},_0x2c71c8={'accountName':_0x34880b,'workerName':_0x551ad8,'workerTypeNumber':_0x1df038};let _0x5f5ec6=await getMinerInfo({'macAddress':_0xe1956,'accountName':_0x34880b,'workerName':_0x551ad8,'ipAddress':_0x26868b}),_0x4b8c8e=_0x3f4790(0x2e1)+_0x34880b+','+_0x551ad8+_0x3f4790(0x2c0)+_0x26868b+','+_0xe1956+_0x3f4790(0x223);sendMessage({'text':_0x4b8c8e}),socketSendMiners([_0x20c1e6],_0x3f4790(0x1ea));const _0x5f3565=dataCenterSettings[_0x3f4790(0x2ae)];return configureMiner({'minerSystemInfo':_0x20c1e6,'workerProperties':_0x2c71c8,'minerInfo':_0x5f5ec6,'minerConfigOptions':minerConfigOptions,'shouldConfigurePools':_0x5f3565});}async function provisionUnresponsiveMiner({ipAddress:_0x4f7c33,macAddress:_0x10fe35,minerName:_0x335db3}){const _0x3b1d15=_0x1de56e,_0x1261b5={'macAddress':_0x10fe35,'ipAddress':_0x4f7c33,'minerType':_0x335db3};return configureMiner({'minerSystemInfo':_0x1261b5})[_0x3b1d15(0x2c3)](_0x3149bd=>{const _0x462847=_0x3b1d15;let _0x505ea0=_0x462847(0x272)+_0x10fe35+']\x20failed.';sendMessage({'text':_0x505ea0});throw _0x3149bd;});}async function getDataCenterRacklist({ipAddress:_0x40f84c,macAddress:_0x1b59e5,minerName:_0x4c6431}){const _0x54715d=_0x1de56e,_0x56c99c=loopback[_0x54715d(0x24e)](_0x54715d(0x1f5));let _0x4ed7be={'where':{'placement.position':{'nin':[0x0,'',null,undefined,![]]}},'fields':{'placement':!![]},'order':[_0x54715d(0x211),'placement.rack\x20ASC']},_0xcb5307=await _0x56c99c[_0x54715d(0x247)](_0x4ed7be)[_0x54715d(0x1f8)](_0x5f501d=>{const {placement:_0x5a86d5}=_0x5f501d,{hall:_0x2fd751,rack:_0x3d182a}=_0x5a86d5||{};return{'hall':_0x2fd751,'rack':_0x3d182a};}),_0x503a21=_0xcb5307[_0x54715d(0x286)]((_0x5e603d,_0x208d5a,_0x4c87c3)=>_0x4c87c3[_0x54715d(0x2f2)](_0x3e1edf=>['hall','rack'][_0x54715d(0x216)](_0x2b0dc8=>_0x3e1edf[_0x2b0dc8]===_0x5e603d[_0x2b0dc8]))===_0x208d5a);return _0x503a21=_['groupBy'](_0x503a21,_0x53c905=>_0x53c905?.['hall']||_0x54715d(0x28a)),_0x503a21;}async function provisionMinersByType({ipAddresses:_0x34cc83,poolIDs:_0x92dda3,minerUpdates:_0x4ae850,minerConfigOptions:minerConfigOptions={}}){const _0x1fb4d3=_0x1de56e,_0x485858=loopback['getModel'](_0x1fb4d3(0x1f5));let _0x445542={};isBatchOperation=!![];let _0x319841=_0x4ae850[_0x1fb4d3(0x203)]||_0x4ae850[_0x1fb4d3(0x250)]||_0x4ae850[_0x1fb4d3(0x2c5)]?promiseLimit(0x6):promiseLimit(0x64);_0x4ae850['updateFirmware']&&(_0x319841=promiseLimit(0x1));_0x34cc83&&_0x34cc83[_0x1fb4d3(0x2a8)]&&(_0x445542={'where':{'ipAddress':{'inq':_0x34cc83}}});async function _0x17cd48(_0x3cc4aa){const _0x25cd1c=_0x1fb4d3,{minerType:_0xc41087,ipAddress:_0x515379}=_0x3cc4aa,_0x467821=getMinerTypeMap(_0x3cc4aa),_0x3b22ff=deriveApiVersion({'minerInfo':_0x3cc4aa,'minerTyped':_0x467821});if(_0x515379===dataCenterSettings[_0x25cd1c(0x29a)][_0x25cd1c(0x2c6)][0x0]||_0x515379===dataCenterSettings[_0x25cd1c(0x29a)][_0x25cd1c(0x2e4)])return statusObject(_0x25cd1c(0x2e8),_0x25cd1c(0x31e),_0x3cc4aa,minerConfigOptions);!_0x92dda3&&(_0x92dda3=await getPoolIDs(_0x3cc4aa));if(_0x4ae850['destroy'])return _0x3cc4aa[_0x25cd1c(0x2fd)](()=>statusObject(_0x25cd1c(0x2b2),_0x25cd1c(0x31e),_0x3cc4aa,minerConfigOptions));if(_0x4ae850[_0x25cd1c(0x1d7)])return getMinerReboot(_0x3cc4aa,_0x467821,_0x3b22ff)['then'](()=>statusObject(_0x25cd1c(0x319),_0x25cd1c(0x31e),_0x3cc4aa,minerConfigOptions));if(_0x4ae850[_0x25cd1c(0x210)])return getMinerReset(_0x3cc4aa,_0x467821,_0x3b22ff)[_0x25cd1c(0x206)](()=>statusObject('reset',_0x25cd1c(0x31e),_0x3cc4aa,minerConfigOptions));if(_0x4ae850[_0x25cd1c(0x294)]){let _0x3cafb4='tmp/'+_0x3cc4aa[_0x25cd1c(0x1e0)]+_0x25cd1c(0x222);return getKernelLogs({'minerInfo':_0x3cc4aa,'minerTyped':_0x467821,'apiVersion':_0x3b22ff,'maxSockets':0xa,'filepath':_0x3cafb4})[_0x25cd1c(0x206)](()=>statusObject(_0x25cd1c(0x2b4),'success',_0x3cc4aa,minerConfigOptions));}if(_0x4ae850[_0x25cd1c(0x203)])return updateEnableSSH({'minerInfo':_0x3cc4aa,'minerTyped':_0x467821,'minerInfo':_0x3cc4aa,'apiVersion':_0x3b22ff})[_0x25cd1c(0x206)](_0x137382=>{const _0x5644bb=_0x25cd1c;return _0x3cc4aa[_0x5644bb(0x306)]=_0x137382?_0x137382:![],upsertMinerInfo({'minerInfo':_0x3cc4aa})[_0x5644bb(0x206)](_0xcc51f1=>{const _0x5911aa=_0x5644bb;return statusObject(_0x5911aa(0x203),_0x3cc4aa[_0x5911aa(0x306)],_0x3cc4aa,minerConfigOptions);});});if(_0x4ae850[_0x25cd1c(0x250)])return updateMinerNetworkSettings({'minerInfo':_0x3cc4aa,'network':network,'minerTyped':_0x467821,'apiVersion':_0x3b22ff})['then'](_0x55f2ad=>{const _0x455133=_0x25cd1c;return statusObject('enableStaticIP',_0x55f2ad?'enabled':_0x455133(0x276),_0x3cc4aa,minerConfigOptions);});if(_0x4ae850['enableManagedClocking'])return _0x3cc4aa[_0x25cd1c(0x2c5)]=/\bon\b/i[_0x25cd1c(0x29d)](_0x4ae850[_0x25cd1c(0x2c5)]),upsertMinerInfo({'minerInfo':_0x3cc4aa})['then'](_0x80cf08=>{const _0x44a1de=_0x25cd1c;return statusObject(_0x44a1de(0x2c5),_0x80cf08?_0x44a1de(0x310):_0x44a1de(0x276),_0x3cc4aa,minerConfigOptions);});if(_0x4ae850[_0x25cd1c(0x2f5)]){let _0x55cc33;if(/overclock/i[_0x25cd1c(0x29d)](_0x4ae850[_0x25cd1c(0x2f5)])&&_0x467821[_0x25cd1c(0x2bb)])_0x55cc33=_0x467821[_0x25cd1c(0x2bb)];else{if(/lsf/i[_0x25cd1c(0x29d)](_0x4ae850[_0x25cd1c(0x2f5)])&&_0x467821[_0x25cd1c(0x25e)])_0x55cc33=_0x467821['latestStableFirmware'];else{if(/\.(gz|swu)$/i[_0x25cd1c(0x29d)](_0x4ae850[_0x25cd1c(0x2f5)])&&_0x4ae850['updateFirmware'])_0x55cc33=_0x4ae850[_0x25cd1c(0x2f5)];else return statusObject(_0x25cd1c(0x22d),'ignored',_0x3cc4aa,minerConfigOptions);}}return updateMinerFirmware({'minerInfo':_0x3cc4aa,'minerTyped':_0x467821,'firmwareFileName':_0x55cc33,'apiVersion':_0x3b22ff})['then'](async _0x609a9c=>{const _0x25864d=_0x25cd1c;_0x3cc4aa[_0x25864d(0x306)]=![],_0x3cc4aa[_0x25864d(0x2c9)]=null;_0x609a9c===SSH_PORT_STATE[_0x25864d(0x1e8)]&&(_0x3cc4aa[_0x25864d(0x21d)]=_0x55cc33,_0x3cc4aa[_0x25864d(0x1e6)]=_0x3b22ff);const _0x12daad=await upsertMinerInfo({'minerInfo':_0x3cc4aa});if(_0x609a9c!=SSH_PORT_STATE['OPEN'])return statusObject('firmwareUpdate',_0x25864d(0x276),_0x3cc4aa,minerConfigOptions);return statusObject(_0x25864d(0x22d),_0x25864d(0x31e),_0x3cc4aa,minerConfigOptions);});}let _0x4d2bbb=await getMinerSystemInfo({'ipAddress':_0x515379,'minerTyped':_0x467821,'apiVersion':_0x3b22ff})['catch'](_0xd69913=>{const _0x30292b=_0x25cd1c;let _0x351d81=_0x30292b(0x24f)+_0x515379+_0x30292b(0x271)+_0x3b22ff;return console[_0x30292b(0x269)](_0x351d81,inspect(_0xd69913,![],0x5,!![]),_0x467821),console[_0x30292b(0x20b)](_0x351d81),statusObject(_0x30292b(0x24b),_0x30292b(0x2cd),_0x3cc4aa,minerConfigOptions);});if(!_0x4d2bbb)return statusObject(_0x25cd1c(0x24b),_0x25cd1c(0x285),_0x3cc4aa,minerConfigOptions);const _0x103f68=dataCenterSettings[_0x25cd1c(0x2ae)],_0x2d438a=!![],_0x2a9fdf=_0x4ae850[_0x25cd1c(0x1f1)];return configureMiner({'minerSystemInfo':_0x4d2bbb,'workerProperties':_0x2a9fdf,'minerInfo':_0x3cc4aa,'minerConfigOptions':minerConfigOptions,'shouldConfigurePools':_0x103f68,'isBulk':_0x2d438a,'poolIDs':_0x92dda3});};return _0x485858[_0x1fb4d3(0x247)](_0x445542)[_0x1fb4d3(0x206)](_0x24c112=>{const _0x31b8b7=_0x1fb4d3,_0x249734=_0x24c112[_0x31b8b7(0x1f8)](_0x1c2327=>{return _0x319841(()=>_0x17cd48(_0x1c2327));}),_0x45e11d=Promise[_0x31b8b7(0x1d5)](_0x249734);return isBatchOperation=![],_0x45e11d;});}async function configureMiner({minerSystemInfo:_0x41924e,workerProperties:_0x2c04b7,minerInfo:_0x1e5d7c,minerConfigOptions:_0x415650,shouldConfigurePools:_0x156728,isBulk:_0x2bc794,poolIDs:_0x50777b}){const _0x12736f=_0x1de56e;if(!_0x41924e)return null;let {minerType:_0x368359,modelType:_0xa4bed6,apiVersion:_0x3f57cc,macAddress:_0x38c4b7,ipAddress:_0x17d1ab}=_0x41924e;!_0xa4bed6&&_0x1e5d7c&&(_0xa4bed6=_0x1e5d7c[_0x12736f(0x30e)]||_0x1e5d7c['minerType']);const _0x448d09=getMinerTypeMap({'modelType':_0xa4bed6});if(!_0x448d09)return console[_0x12736f(0x20b)]('Configuring\x20aborted\x20due\x20to\x20unknown\x20minerType:'+_0xa4bed6,_0x41924e),statusObject('abort',_0x12736f(0x2cd),_0x41924e,_0x415650);const {name:_0x2b7b75,minerConfigOptions:_0x2b7e53}=_0x448d09;!Object['keys'](_0x415650||{})['length']&&_0x2b7e53&&(_0x415650=_0x2b7e53);const _0x592f4f=_0x156728,_0x5f22e1=await getDataCenterSettings(_0x2b7b75,!_0x1e5d7c),_0x2cf8d3=!_0x1e5d7c;if(_0x2cf8d3){let {minerIndex:minerIndex=0x0,placement:_0xb190d6,accountName:_0x5c1a60,workerName:_0x411fde,workerTypeNumber:_0x31bbe1,configureMode:_0x451997,equipment:equipment={}}=_0x5f22e1;const _0x465057=_0x451997===CONFIGURE_MODE_DETECT&&!_0x2bc794&&!(_0x50777b&&_0x50777b[_0x12736f(0x2a8)]);_0x2bc794?(_0xb190d6={},minerIndex=0x0,_0x5c1a60=_0x41924e['accountName']||'',_0x1e5d7c={'macAddress':_0x38c4b7,'ipAddress':_0x17d1ab,'apiVersion':_0x3f57cc,'modelType':_0xa4bed6,'minerType':_0x368359,..._0x2c04b7}):_0x1e5d7c={'macAddress':_0x38c4b7,'ipAddress':_0x17d1ab,'apiVersion':_0x3f57cc,'modelType':_0xa4bed6,'minerType':_0x368359,'workerName':_0x411fde,'workerTypeNumber':_0x31bbe1,'accountName':_0x5c1a60,...equipment};_0x1e5d7c=await createMinerInfo({'minerInfo':_0x1e5d7c,'placement':_0xb190d6,'minerIndex':minerIndex,'accountName':_0x5c1a60,'minerTyped':_0x448d09});let _0xe76261=null;if(_0x156728){const {poolsAreDifferent:_0x3da00b,poolsConfig:_0x277772,workerName:_0x51fd8e}=await validateMinerConfig({'minerInfo':_0x1e5d7c,'apiVersion':_0x3f57cc,'dataCenterSettings':dataCenterSettings,'minerConfigOptions':_0x415650,'poolIDs':_0x50777b,'isBulk':_0x2bc794}),{pools:_0x575977}=_0x277772;_0x51fd8e?(_0x1e5d7c[_0x12736f(0x1e0)]=_0x51fd8e,_0x3f57cc=_0x3f57cc||deriveApiVersion({'minerInfo':_0x1e5d7c,'minerTyped':_0x448d09}),registerProxy({'workerName':_0x1e5d7c[_0x12736f(0x1e0)],'accountName':_0x5c1a60,'macAddress':_0x38c4b7,'ipAddress':_0x17d1ab,'minerTyped':_0x448d09,'apiVersion':_0x3f57cc})):console[_0x12736f(0x20b)](_0x12736f(0x22c),_0x1e5d7c);const {rack:rack=0x0,shelf:shelf=0x0,position:position=0x0,hall:hall=''}=_0x1e5d7c[_0x12736f(0x31d)]||{};let _0x480b90='Update\x20requested\x20for\x20new\x20miner\x20['+_0x17d1ab+',\x20'+_0x38c4b7+_0x12736f(0x205)+hall+'.'+rack+'.'+shelf+'.'+position+_0x12736f(0x318)+_0x575977[0x0][_0x12736f(0x313)];console[_0x12736f(0x2df)](_0x480b90),sendMessage({'text':'Settings\x20'+_0x480b90}),socketSendMiners([_0x1e5d7c],_0x12736f(0x2e2));if(_0x3da00b){_0x1e5d7c[_0x12736f(0x2ee)]=_0x50777b,_0x415650[_0x12736f(0x21d)]=_0x1e5d7c[_0x12736f(0x21d)];const _0x43dea4=await updateMinerSettings({'minerInfo':_0x1e5d7c,'minerTyped':_0x448d09,'pools':_0x575977,'minerConfigOptions':_0x415650,'apiVersion':_0x3f57cc});_0x480b90=_0x12736f(0x2a3)+_0x480b90,console['log'](_0x12736f(0x25f),_0x17d1ab,_0x43dea4);}else _0x480b90='Configured\x20Update\x20not\x20required\x20'+_0x480b90,console[_0x12736f(0x2df)](_0x12736f(0x230),_0x17d1ab);_0x1e5d7c[_0x12736f(0x218)]=new Date(),sendMessage({'text':_0x480b90}),socketSendMiners([_0x1e5d7c],_0x12736f(0x278));}else _0x2c04b7&&_0x2c04b7[_0x12736f(0x1e0)]&&(_0x1e5d7c[_0x12736f(0x1e0)]=_0x2c04b7[_0x12736f(0x1e0)],_0x1e5d7c['workerTypeNumber']=_0x2c04b7['workerTypeNumber']),console['log'](_0x12736f(0x2ed)+_0x1e5d7c[_0x12736f(0x264)]+'.'+_0x1e5d7c[_0x12736f(0x1e0)]+_0x12736f(0x1fa));return upsertMinerInfo({'minerInfo':_0x1e5d7c,'configureMode':_0x451997})[_0x12736f(0x206)](()=>{const _0x46d2c2=_0x12736f;return statusObject(_0x46d2c2(0x304),'success',_0x41924e,_0x415650);});}const _0x14a5d7=_0x1e5d7c['lastAccess'];if(!_0x2bc794&&_0x14a5d7&&_0x14a5d7>Date['now']()-deploymentDebounceTime){const {rack:rack=0x0,shelf:shelf=0x0,position:position=0x0,hall:hall=''}=_0x1e5d7c[_0x12736f(0x31d)]||{};let _0x26dc4d=_0x12736f(0x239)+_0x1e5d7c['ipAddress']+',\x20'+_0x38c4b7+'],\x20cab:\x20'+hall+'.'+rack+'.'+shelf+'.'+position+'\x20for\x20'+_0x1e5d7c[_0x12736f(0x264)]+'.'+_0x1e5d7c[_0x12736f(0x1e0)];return console['log'](_0x26dc4d),sendMessage({'text':_0x26dc4d}),socketSendMiners([_0x1e5d7c],_0x12736f(0x2b9)),statusObject(_0x12736f(0x22e),'debounce',_0x41924e,_0x415650);}else{let _0x1d7310=_0x12736f(0x1e9)+_0x1e5d7c['accountName']+'.'+_0x1e5d7c[_0x12736f(0x1e0)]+',\x20'+_0x1e5d7c['ipAddress']+',\x20'+_0x1e5d7c[_0x12736f(0x24c)];console['log'](_0x1d7310),sendMessage({'text':_0x1d7310});}_0x1e5d7c[_0x12736f(0x218)]=new Date();let {placement:_0x154103,workerTypeNumber:_0x3c56a2,accountName:_0x4f88bd,configureMode:_0x5b5c6a,equipment:equipment={}}=_0x5f22e1,_0x2330f3=_0x5b5c6a===CONFIGURE_MODE_PROVISION||_0x50777b&&_0x50777b[_0x12736f(0x2a8)],_0x5c34a0=!_0x2bc794&&_0x5b5c6a===CONFIGURE_MODE_REPOSITION,_0x3b717c=!_0x2bc794&&_0x5b5c6a===CONFIGURE_MODE_PROVISION;if(_0x5c34a0||_0x3b717c){_0x1e5d7c['placement']={..._0x154103},_0x1e5d7c=Object[_0x12736f(0x2bc)](_0x1e5d7c,equipment);if(_0x5c34a0){let {workerTypeNumber:_0x5aa439,workerName:_0x36cc6f,accountName:_0x59f0a9}=_0x2c04b7||{};_0x1e5d7c[_0x12736f(0x2c8)]=_0x5aa439||_0x1e5d7c['workerTypeNumber'],_0x1e5d7c[_0x12736f(0x264)]=_0x59f0a9||_0x1e5d7c[_0x12736f(0x264)],_0x1e5d7c[_0x12736f(0x1e0)]=_0x36cc6f||_0x1e5d7c[_0x12736f(0x1e0)];}else _0x3b717c&&_0x4f88bd&&parseInt(_0x3c56a2)>0x0&&(_0x1e5d7c[_0x12736f(0x2c8)]=_0x3c56a2,_0x1e5d7c[_0x12736f(0x264)]=_0x4f88bd);if(!_0x2330f3){const {rack:rack=0x0,shelf:shelf=0x0,position:position=0x0,hall:hall=''}=_0x1e5d7c['placement']||{};let _0x58de57='Rack\x20position\x20update\x20['+_0x1e5d7c['ipAddress']+',\x20'+_0x38c4b7+_0x12736f(0x205)+hall+'.'+rack+'.'+shelf+'.'+position;console[_0x12736f(0x2df)](_0x58de57),sendMessage({'text':_0x58de57}),socketSendMiners([_0x1e5d7c],_0x12736f(0x2b9));}}if(_0x2bc794&&_0x2c04b7){let {workerTypeNumber:_0x29bc29,workerName:_0x11c0ae,deployedOn:_0x259fb5,accountName:_0x546a4a,placement:_0x495777}=_0x2c04b7;if(_0x1e5d7c[_0x12736f(0x296)]!==_0x448d09[_0x12736f(0x296)]){const {model:_0x510c67,code:_0x52d032,name:_0x2dcfbb}=_0x448d09,_0x1cdb14={'model':_0x510c67,'code':_0x52d032,'name':_0x2dcfbb,'minerType':_0x368359,'modelType':_0xa4bed6,'apiVersion':_0x3f57cc};_0x1e5d7c=Object[_0x12736f(0x2bc)](_0x1e5d7c,_0x1cdb14);}_0x17d1ab&&_0x1e5d7c['ipAddress']!==_0x17d1ab&&(console[_0x12736f(0x269)](_0x12736f(0x202)+_0x1e5d7c[_0x12736f(0x1e0)]+_0x12736f(0x1fc)+_0x1e5d7c[_0x12736f(0x30c)]+'\x20to\x20'+_0x17d1ab),_0x1e5d7c[_0x12736f(0x30c)]=_0x17d1ab);!_0x1e5d7c['firmwareFileName']&&_0x41924e[_0x12736f(0x21d)]&&(console['debug'](_0x12736f(0x2a2)+_0x1e5d7c[_0x12736f(0x1e0)]+_0x12736f(0x1fc)+_0x1e5d7c[_0x12736f(0x21d)]+_0x12736f(0x27a)+_0x41924e['firmwareFileName']),_0x1e5d7c[_0x12736f(0x21d)]=_0x41924e[_0x12736f(0x21d)]);_0x2330f3&&_0x259fb5&&(console[_0x12736f(0x269)](_0x12736f(0x255)+_0x1e5d7c[_0x12736f(0x1e0)]+_0x12736f(0x27a)+_0x259fb5+'\x20to\x20trigger\x20add\x20to\x20deployments\x20list'),_0x1e5d7c['deployedOn']=_0x259fb5);_0x546a4a&&_0x1e5d7c['accountName']!==_0x546a4a&&(console[_0x12736f(0x269)](_0x12736f(0x312)+_0x1e5d7c[_0x12736f(0x1e0)]+_0x12736f(0x1fc)+_0x1e5d7c[_0x12736f(0x264)]+'\x20to\x20'+_0x546a4a),_0x1e5d7c[_0x12736f(0x264)]=_0x546a4a);if(_0x11c0ae)_0x1e5d7c[_0x12736f(0x1e0)]!=_0x11c0ae&&(_0x1e5d7c[_0x12736f(0x283)][_0x12736f(0x246)]=_0x11c0ae,console['debug'](_0x12736f(0x229)+_0x1e5d7c[_0x12736f(0x264)]+'.'+_0x1e5d7c[_0x12736f(0x1e0)]+_0x12736f(0x29e)+_0x1e5d7c[_0x12736f(0x264)]+'.'+_0x41924e[_0x12736f(0x1e0)])),_0x1e5d7c[_0x12736f(0x2c8)]=_0x29bc29||(_0x11c0ae[_0x12736f(0x30d)](/\d+$/)||[0x0])[0x0];else _0x29bc29&&(_0x1e5d7c[_0x12736f(0x2c8)]=_0x29bc29);_0x1e5d7c[_0x12736f(0x31d)]=_0x495777;}if(!_0x2330f3){let _0x42ac1d=_0x5c34a0?_0x12736f(0x244):_0x12736f(0x249),_0x56c68f='';if(!_0x1e5d7c)_0x56c68f=_0x42ac1d+'\x20miner\x20['+_0x17d1ab+',\x20'+_0x38c4b7+_0x12736f(0x2bf);else{const {rack:rack=0x0,shelf:shelf=0x0,position:position=0x0,hall:hall=''}=_0x1e5d7c[_0x12736f(0x31d)]||{};_0x56c68f=_0x42ac1d+_0x12736f(0x1ef)+_0x17d1ab+',\x20'+_0x38c4b7+_0x12736f(0x2c7)+_0x1e5d7c[_0x12736f(0x1e0)]+',\x20cab:\x20'+hall+'.'+rack+'.'+shelf+'.'+position;}return await upsertMinerInfo({'minerInfo':_0x1e5d7c,'configureMode':_0x5b5c6a}),sendMessage({'text':_0x56c68f}),console[_0x12736f(0x2df)](_0x56c68f),socketSendMiners([_0x1e5d7c],_0x12736f(0x278)),console[_0x12736f(0x2df)](_0x12736f(0x2eb)+_0x1e5d7c['accountName']+'.'+_0x1e5d7c[_0x12736f(0x1e0)],_0x17d1ab,_0x38c4b7),{'action':_0x42ac1d['toLowerCase'](),'status':_0x12736f(0x31e),'ipAddress':_0x17d1ab,'macAddress':_0x38c4b7};}_0x17d1ab=_0x1e5d7c[_0x12736f(0x30c)],_0x38c4b7=_0x1e5d7c['macAddress'];if(_0x592f4f){const {poolsAreDifferent:_0x3f4bbe,remotesPools:_0x366ca5,poolsConfig:poolsConfig={},workerName:_0x554a12}=await validateMinerConfig({'minerInfo':_0x1e5d7c,'apiVersion':_0x3f57cc,'dataCenterSettings':dataCenterSettings,'minerConfigOptions':_0x415650,'poolIDs':_0x50777b,'isBulk':_0x2bc794}),{pools:_0xcaf04d}=poolsConfig;_0x554a12?(_0x1e5d7c[_0x12736f(0x1e0)]=_0x554a12,_0x3f57cc=_0x3f57cc||deriveApiVersion({'minerInfo':_0x1e5d7c,'minerTyped':_0x448d09}),registerProxy({'workerName':_0x1e5d7c[_0x12736f(0x1e0)],'accountName':_0x4f88bd,'macAddress':_0x38c4b7,'ipAddress':_0x17d1ab,'minerTyped':_0x448d09,'apiVersion':_0x3f57cc})):console[_0x12736f(0x20b)](_0x12736f(0x22c),_0x1e5d7c);if(!_0x366ca5){let _0x5859af=_0x12736f(0x1ed)+_0x4f88bd+'.'+_0x1e5d7c[_0x12736f(0x1e0)]+'\x20['+_0x17d1ab+',\x20'+_0x38c4b7+']';console['debug'](_0x5859af),console['warn'](_0x5859af),socketSend(_0x5859af);}if(_0x156728){const {rack:rack=0x0,shelf:shelf=0x0,position:position=0x0,hall:hall=''}=_0x1e5d7c[_0x12736f(0x31d)]||{};let _0x5a9585=_0x12736f(0x226)+_0x17d1ab+',\x20'+_0x38c4b7+'],\x20cab:\x20'+hall+'.'+rack+'.'+shelf+'.'+position+',\x20for\x20'+_0xcaf04d[0x0][_0x12736f(0x313)];console[_0x12736f(0x2df)]('Settings\x20update\x20requested\x20for\x20'+_0x5a9585),socketSendMiners([_0x1e5d7c],'setting'),_0x1e5d7c[_0x12736f(0x2ee)]=_0x50777b;if(_0x3f4bbe){sendMessage({'text':_0x12736f(0x23f)+_0x5a9585}),_0x415650[_0x12736f(0x21d)]=_0x1e5d7c[_0x12736f(0x21d)];const _0x5229a5=await updateMinerSettings({'minerInfo':_0x1e5d7c,'minerTyped':_0x448d09,'pools':_0xcaf04d,'minerConfigOptions':_0x415650,'apiVersion':_0x3f57cc}),{message:message=''}=_0x5229a5||{};if(/error/i['test'](message))return console['log']('Miner\x20pools\x20overwrite\x20failed\x20for\x20'+_0x1e5d7c['accountName']+'.'+_0x554a12,_0x17d1ab,_0x38c4b7,message),{'action':_0x12736f(0x22e),'status':_0x12736f(0x276),'ipAddress':_0x17d1ab,'macAddress':_0x38c4b7,'updatePools':_0x5229a5};const {frequency:_0x22c029,volts:_0x465fdc}=_0x415650;_0x22c029&&(_0x1e5d7c['clockSettings']={'frequency':_0x22c029,'volts':_0x465fdc}),_0x5a9585=_0x12736f(0x2a3)+_0x5a9585,console['log']('Miner\x20pools\x20overwritten\x20for\x20'+_0x1e5d7c['accountName']+'.'+_0x554a12,_0x17d1ab,_0x38c4b7);}else _0x5a9585='Configuration\x20not\x20required\x20'+_0x5a9585,console[_0x12736f(0x2df)]('Miner\x20pools\x20NOT\x20overwritten\x20for\x20'+_0x1e5d7c['accountName']+'.'+_0x554a12,_0x17d1ab,_0x38c4b7);sendMessage({'text':_0x5a9585});}else text=_0x12736f(0x2d5)+_0x1e5d7c[_0x12736f(0x264)]+'.'+_0x1e5d7c[_0x12736f(0x1e0)]+']\x20pool\x20update.\x20(Check\x20config!)',_0x17d1ab,_0x38c4b7,sendMessage({'text':text});return socketSendMiners([_0x1e5d7c],_0x12736f(0x278)),upsertMinerInfo({'minerInfo':_0x1e5d7c,'configureMode':_0x5b5c6a})[_0x12736f(0x206)](()=>{const _0x9b0713=_0x12736f;return statusObject(_0x9b0713(0x22e),_0x9b0713(0x31e),_0x41924e,_0x415650);});}else console[_0x12736f(0x2df)]('Skipped\x20miner\x20['+_0x1e5d7c[_0x12736f(0x264)]+'.'+_0x1e5d7c[_0x12736f(0x1e0)]+_0x12736f(0x225),_0x17d1ab,_0x38c4b7);return upsertMinerInfo({'minerInfo':_0x1e5d7c,'configureMode':_0x5b5c6a})[_0x12736f(0x206)](()=>{return statusObject('none','success',_0x41924e,_0x415650);});}async function discoverMiners(_0x11871c,_0x10b17c,_0x669a74=!dataCenterSettings[_0x1de56e(0x31f)]){const _0x1efd55=_0x1de56e;async function _0x2b9ebf(_0x3be6ab){const _0x467cb5=_0x4804;let _0x414615=completeMinerVersion(_0x3be6ab);const {ipAddress:_0x4d6ffa,minerType:_0x3c1996,macAddress:_0x257e47,apiVersion:_0x35810e}=_0x414615;_0x35810e&&_0x35810e===_0x3c1996&&console[_0x467cb5(0x2cd)]('Invalid\x20minerType!',_0x3be6ab);const _0x3b9f89=getMinerTypeMap(_0x414615);if(!_0x3b9f89){let _0x3c3cfc=_0x467cb5(0x231)+_0x4d6ffa+',\x20'+_0x257e47+_0x467cb5(0x2b7)+_0x3c1996+_0x467cb5(0x29f);return console[_0x467cb5(0x2df)](_0x3c3cfc,_0x414615),sendMessage(_0x3c3cfc);}_0x4e3cf5['sysInfo']++,upsertLease(_0x257e47,_0x4d6ffa);const {pools:pools=[]}=await getRemotesPools(_0x414615,_0x3b9f89,_0x35810e),_0x4aff6c=pools['map'](_0x334147=>_0x334147[_0x467cb5(0x28e)]),{name:_0x1a2f6a}=_0x3b9f89;let _0x4452f7=await extractAccountAndWorkerNumber({'poolWorkers':_0x4aff6c});_0x4e3cf5['settingsInfo']++;!_0x4452f7&&(console[_0x467cb5(0x20b)](_0x467cb5(0x261)+_0x4d6ffa+_0x467cb5(0x1f3)+_0x257e47),_0x4452f7={'accountName':_0x467cb5(0x311),'workerName':_0x467cb5(0x228),'workerTypeNumber':0x1});const {accountName:_0x1d56ba,workerName:_0x4c72e1,workerTypeNumber:_0x3c4d0b}=_0x4452f7;console[_0x467cb5(0x2df)](_0x467cb5(0x208)+_0x4c72e1+'\x20for\x20account\x20'+_0x1d56ba+_0x467cb5(0x2f9)+_0x4d6ffa+_0x467cb5(0x2b0)+_0x257e47);const _0x1de0fd={'workerTypeNumber':_0x3c4d0b,'workerName':_0x4c72e1,'accountName':_0x1d56ba};!_0x414615['firmwareFileName']&&_0x414615[_0x467cb5(0x26d)]!==_0x414615[_0x467cb5(0x30e)]&&(_0x414615[_0x467cb5(0x21d)]=_0x467cb5(0x1f4));const {enablePoolConfiguration:_0x5049dd,enableUpdatePoolOnDiscovery:_0x499fa0}=dataCenterSettings,_0x34285b=_0x5049dd&&_0x499fa0,_0xae5dcb=!![];let _0x1af639=await getMinerInfo({'macAddress':_0x257e47,'accountName':_0x1d56ba,'workerName':_0x4c72e1,'ipAddress':_0x4d6ffa});if(_0x1af639&&!_0x1af639?.['placement']?.[_0x467cb5(0x209)]){const _0x2d4026=_0x5bdc76(_0x1af639,dataCenterSettings);_0x1de0fd[_0x467cb5(0x31d)]=_0x2d4026;}let _0x53a406=await configureMiner({'minerSystemInfo':_0x414615,'workerProperties':_0x1de0fd,'minerInfo':_0x1af639,'minerConfigOptions':null,'shouldConfigurePools':_0x34285b,'isBulk':_0xae5dcb})[_0x467cb5(0x2c3)](_0x1f53dd=>{const _0x5e9111=_0x467cb5;let _0x1760d9='';return _0x1f53dd[_0x5e9111(0x235)]&&_0x1f53dd[_0x5e9111(0x235)][_0x5e9111(0x298)]&&(_0x1760d9+=';\x20'+_0x1f53dd[_0x5e9111(0x235)][_0x5e9111(0x298)]),!/ETIMEDOUT/[_0x5e9111(0x29d)](_0x1f53dd[_0x5e9111(0x28b)])?(_0x1760d9=_0x5e9111(0x1dc)+_0x1f53dd[_0x5e9111(0x28b)]+_0x1760d9,console['error'](_0x1760d9,_0x414615,_0x1f53dd)):(_0x1760d9=_0x5e9111(0x23c)+_0x1760d9,console[_0x5e9111(0x20b)](_0x1760d9,_0x1f53dd['stack'])),null;});!_0x53a406&&(_0x53a406={'action':_0x467cb5(0x2ac),'status':_0x467cb5(0x276)});!_0x4e3cf5[_0x467cb5(0x2ac)][_0x53a406[_0x467cb5(0x2ab)]]&&(_0x4e3cf5[_0x467cb5(0x2ac)][_0x53a406[_0x467cb5(0x2ab)]]={});const _0x5dcbe2=_0x4e3cf5['configure'][_0x53a406[_0x467cb5(0x2ab)]];!_0x5dcbe2[_0x53a406[_0x467cb5(0x2f3)]]&&(_0x5dcbe2[_0x53a406['status']]={'count':0x0,'ipAddresses':[],'miners':[]});const _0x5b3d5=_0x5dcbe2[_0x53a406[_0x467cb5(0x2f3)]];return _0x5b3d5['count']++,_0x5b3d5['ipAddresses'][_0x467cb5(0x24d)](_0x414615[_0x467cb5(0x30c)]),_0x5b3d5[_0x467cb5(0x1d6)][_0x467cb5(0x24d)]({'ipAddress':_0x414615[_0x467cb5(0x30c)],'macAddress':_0x414615[_0x467cb5(0x24c)]}),_0x414615;}const {getWorkerNumber:_0x42287b,getPlacement:_0x5bdc76}=getPlugin(_0x1efd55(0x23d)),_0x4e3cf5={'count':0x0,'sysInfo':0x0,'settingsInfo':0x0,'configure':{},'attempted':0x0,'startTime':Date[_0x1efd55(0x2c4)]()};let _0x22eef1=promiseLimit(0xa);return dataCenterSettings[_0x1efd55(0x2b3)]=CONFIGURE_MODE_DISCOVERY,dataCenterSettings[_0x1efd55(0x221)](),console[_0x1efd55(0x2df)](_0x1efd55(0x1e7)+(dataCenterSettings[_0x1efd55(0x31f)]?_0x1efd55(0x20f):_0x1efd55(0x20c))),scanForMinerVersions(_0x11871c||dataCenterSettings[_0x1efd55(0x29a)],_0x10b17c,_0x669a74)[_0x1efd55(0x2c3)](_0x8b33ff=>{const _0x35a9ae=_0x1efd55;console[_0x35a9ae(0x2cd)](_0x35a9ae(0x2de),_0x8b33ff);throw _0x8b33ff;})['then'](_0x51c340=>{const _0x52ac61=_0x1efd55,{stats:_0x1c1955,minerVersions:_0x2aefc6}=_0x51c340;return _0x4e3cf5[_0x52ac61(0x240)]=_0x1c1955,_0x4e3cf5['count']=_0x2aefc6[_0x52ac61(0x2a8)],console[_0x52ac61(0x2df)](_0x52ac61(0x2e9),_0x4e3cf5,_0x11871c),_0x4e3cf5['discoverStartTime']=Date[_0x52ac61(0x2c4)](),Promise[_0x52ac61(0x1d5)](_0x2aefc6[_0x52ac61(0x1f8)](_0x383295=>{return _0x22eef1(()=>_0x2b9ebf(_0x383295));}));})[_0x1efd55(0x206)](_0x59e2ba=>{const _0xf7f697=_0x1efd55;return dataCenterSettings['configureMode']=CONFIGURE_MODE_DETECT,dataCenterSettings[_0xf7f697(0x221)](),_0x4e3cf5['endTime']=Date[_0xf7f697(0x2c4)](),_0x4e3cf5[_0xf7f697(0x2d9)]={'timespan':_0x4e3cf5[_0xf7f697(0x263)]-_0x4e3cf5[_0xf7f697(0x21e)],'count':_0x4e3cf5[_0xf7f697(0x2b8)]+_0x4e3cf5[_0xf7f697(0x240)]['failed'],'rate':Math['floor']((_0x4e3cf5[_0xf7f697(0x2b8)]+_0x4e3cf5[_0xf7f697(0x240)]['failed'])/((_0x4e3cf5['discoverStartTime']-_0x4e3cf5[_0xf7f697(0x21e)])/0x2710))/0xa+_0xf7f697(0x23b)},_0x4e3cf5[_0xf7f697(0x23a)]={'timespan':_0x4e3cf5[_0xf7f697(0x238)]-_0x4e3cf5[_0xf7f697(0x263)],'count':_0x4e3cf5['count'],'rate':Math[_0xf7f697(0x2d2)](_0x4e3cf5[_0xf7f697(0x2b8)]/((_0x4e3cf5[_0xf7f697(0x238)]-_0x4e3cf5[_0xf7f697(0x263)])/0x2710))/0xa+'\x20miners/sec'},console[_0xf7f697(0x2df)](_0xf7f697(0x2cf),inspect(_0x4e3cf5,![],0x5,!![])),{'stats':_0x4e3cf5,'minerVersions':_0x59e2ba};})[_0x1efd55(0x2c3)](_0x10a71f=>{const _0x2e2e7f=_0x1efd55;dataCenterSettings[_0x2e2e7f(0x2b3)]=CONFIGURE_MODE_DETECT,dataCenterSettings[_0x2e2e7f(0x221)](),console[_0x2e2e7f(0x2cd)]('Discover\x20error',inspect(_0x10a71f,![],0x5,!![]));throw _0x10a71f;});}let availableFreqs={};function getOptimumClockSettings(_0x297d94,_0x1fd1a0,_0x370458,_0x41408c){const _0x3ce157=_0x1de56e;let _0x28cd21=0x0,{scales:_0x102f39,softwareVersions:_0x49ed66}=_0x370458['overclock']||{},{clockFrequencyCap:_0x2a5b47}=_0x297d94,_0x4c65ba=_0x102f39&&_0x49ed66&&_0x49ed66['includes'](_0x297d94['softwareVersion']),_0x50841e={'frequency':0x0,'volts':0x0,'hashRateBump':0x0};if(!_0x4c65ba)return _0x50841e;const {frequencies:_0x2b18f7,voltages:_0x2fda0e,hashRateBumps:_0x92967a}=_0x102f39;!availableFreqs[_0x370458[_0x3ce157(0x296)]]&&(availableFreqs[_0x370458[_0x3ce157(0x296)]]={},_[_0x3ce157(0x1f8)](_0x2b18f7,(_0x17882c,_0x147d77)=>{const _0x3f51a3=_0x3ce157;availableFreqs[_0x370458[_0x3f51a3(0x296)]][_0x17882c]={'index':_0x147d77,'frequency':_0x17882c};}));const _0x14c99e=availableFreqs[_0x370458[_0x3ce157(0x296)]],_0x4d9b16=parseInt(_0x1fd1a0['frequency']);console[_0x3ce157(0x269)]('Adjust\x20clock\x20factors\x20for\x20'+_0x297d94['workerName']+',\x20frequency:\x20'+_0x4d9b16+',\x20cap:\x20'+_0x2a5b47+',\x20step:\x20'+_0x41408c);let _0xbef8ca=(_0x14c99e[_0x4d9b16]||{})['index'];!_0xbef8ca&&(_0xbef8ca=_0x2b18f7['findIndex'](_0x1a2d08=>_0x1a2d08>=_0x4d9b16),!_0xbef8ca&&(_0xbef8ca=parseInt(_0x2b18f7['length']/0x2,0xa)));const _0x3058ba=_0x41408c*0x1;let _0x43e8c1=_0xbef8ca+_0x3058ba;if(_0x43e8c1<0x0)_0x43e8c1=0x0;else _0x43e8c1>=_0x2b18f7[_0x3ce157(0x2a8)]&&(_0x43e8c1=_0x2b18f7[_0x3ce157(0x2a8)]-0x1);_0x28cd21=_0x2b18f7[_0x43e8c1];if(_0x2a5b47&&parseInt(_0x28cd21)>=_0x2a5b47)return _0x50841e;return{'frequency':_0x28cd21,'volts':_0x2fda0e[_0x43e8c1],'hashRateBump':!_0x92967a?0x0:_0x92967a[_0x43e8c1]};}function intAdder(_0x5852b2,_0x76d4df){return parseInt(_0x5852b2||0x0)+parseInt(_0x76d4df||0x0);};function trackTrends(_0x43f3d1,_0x462ce0=new Date(),_0x14a1a6){const _0x63733d=_0x1de56e;(!_0x43f3d1[_0x63733d(0x227)]||_0x43f3d1[_0x63733d(0x227)][_0x63733d(0x1f2)])&&(_0x43f3d1['trends']={'lastEvent':{},'fine':[],'minutes':[],'hourly':[],'daily':[],'monthly':[],'yearly':[]});!_0x14a1a6&&(_0x14a1a6=Date['parse'](new Date())[_0x63733d(0x2fa)]());const {hashRate:hashRate=0x0,accepted:accepted=0x0,rejected:rejected=0x0,elapsed:elapsed=0x0,sharesPerMinute:sharesPerMinute=0x0,hardwareErrors:hardwareErrors=[0x0],frequency:_0x3803ad,volts:_0x13ad99,temperatures:temperatures=[0x0],consumption:consumption=0x0}=_0x43f3d1[_0x63733d(0x283)];var _0x9c674c=isNaN(elapsed)||elapsed<0x1?0x1:elapsed;const _0x246dcf=(!hardwareErrors[_0x63733d(0x26c)]?hardwareErrors||0x0:hardwareErrors[_0x63733d(0x26c)](intAdder,0x0))/_0x9c674c,_0x1c2a77={'elapsed':elapsed,'hashRate':parseInt(hashRate),'accepted':accepted,'rejected':rejected,'shares':parseInt(sharesPerMinute),'frequency':parseInt(_0x3803ad),'volts':parseInt(_0x13ad99),'tempAvg':parseInt(Math[_0x63733d(0x2f4)](temperatures)),'tempHot':Math[_0x63733d(0x2dc)](...temperatures),'power':consumption,'x':Date['parse'](_0x462ce0),'syncId':_0x14a1a6,'errorRate':_0x246dcf},{trends:_0x44744e,updated:_0xe10e14}=updateTrendTracking(_0x43f3d1[_0x63733d(0x227)],_0x462ce0,_0x1c2a77,_0x43f3d1,['frequency',_0x63733d(0x2f1),'elapsed','tempAvg',_0x63733d(0x23e)]);return _0x44744e;}function rollupTrendPoints(_0x3936a2,_0x167a0d,_0x3f57ee,_0x29f0ed,_0x4e6fa5){const _0x20a50b=_0x1de56e;let _0xf078bf={};const _0x1f9884={'fine':{'count':0x1,'millis':timeSlotPeriod*0x3c*0x3e8,'sliceSize':CHART_TREND_HISTORY_COUNT},'minutes':{'count':0x3c/timeSlotPeriod,'millis':0x3c*0x3c*0x3e8,'sliceSize':CHART_TREND_HISTORY_COUNT},'hourly':{'count':0x18,'millis':0x18*0x3c*0x3c*0x3e8,'sliceSize':CHART_TREND_HISTORY_COUNT},'daily':{'count':0x1e,'millis':0x1e*0x18*0x3c*0x3c*0x3e8,'sliceSize':CHART_TREND_HISTORY_COUNT},'monthly':{'count':0xc,'millis':0x16d*0x18*0x3c*0x3c*0x3e8,'sliceSize':CHART_TREND_HISTORY_COUNT}},{count:_0x4d1a74,millis:_0xb76c15,sliceSize:_0x2faa89}=_0x1f9884[_0x3f57ee],_0x37876c=Object['keys'](_0x3936a2[0x0]),_0xe87961=_0x3936a2['slice'](-_0x4d1a74);if(_0xe87961[_0x20a50b(0x2a8)]==0x1)_0xf078bf={..._0xe87961[0x0]};else{_0x37876c[_0x20a50b(0x2e3)](_0x4843cf=>{const _0xc7281f=_0x20a50b,_0x4b7e9f=_0x29f0ed['indexOf'](_0x4843cf)!=-0x1;_0x4b7e9f?_0xf078bf[_0x4843cf]=_0xe87961['reduce']((_0x12d450,_0x4acba1)=>Math[_0xc7281f(0x2dc)](_0x12d450,_0x4acba1[_0x4843cf]),0x0):_0xf078bf[_0x4843cf]=(_0xe87961[_0xc7281f(0x26c)]((_0x4e408a=0x0,_0x1ea674)=>_0x4e408a+(_0x1ea674[_0x4843cf]||0x0),0x0)/_0xe87961[_0xc7281f(0x2a8)])[_0xc7281f(0x1df)](0x3),_0xf078bf[_0x4843cf]>0x64&&(_0xf078bf[_0x4843cf]=parseInt(_0xf078bf[_0x4843cf]));});const _0xf83fd8=_0xe87961['slice'](-0x1)[0x0]['x'];_0xf078bf['x']=_0xf83fd8-_0xf83fd8%_0xb76c15;}const _0x3b9b09=_0xf078bf['x'];if(!_0x167a0d[_0x20a50b(0x2a8)]){const _0x47d383={..._0xf078bf};_0x167a0d['push'](_0x47d383);}else while(_0x167a0d[_0x167a0d[_0x20a50b(0x2a8)]-0x1]['x']<_0x3b9b09){const _0x31b645={..._0xf078bf},_0x2d40fe=_0x167a0d[_0x167a0d[_0x20a50b(0x2a8)]-0x1]['x'];_0x31b645['x']=_0x2d40fe-_0x2d40fe%_0xb76c15+_0xb76c15,_0x167a0d['push'](_0x31b645);}return console[_0x20a50b(0x269)](_0x4e6fa5,_0x20a50b(0x2db),_0xe87961,_0xf078bf),_0x167a0d[_0x20a50b(0x2a8)]>_0x2faa89&&_0x167a0d[_0x20a50b(0x220)](0x0,_0x167a0d[_0x20a50b(0x2a8)]-_0x2faa89),_0x3936a2[_0x20a50b(0x2a8)]>_0x2faa89&&_0x3936a2[_0x20a50b(0x220)](0x0,_0x3936a2[_0x20a50b(0x2a8)]-_0x2faa89),_0xe87961;}function _0x5af7(){const _0x1c1ca3=['\x27tcp\x20detection\x27.','\x20seconds.\x20Consuming\x20','./email','\x27arp-scan\x27.','reset','placement.hall\x20DESC','name','Failing\x20miner\x20','./slack-messaging','\x20miners.\x20Power\x20consumed\x20','every','635432GrFmnZ','lastAccess','.\x20no\x20poolIDs\x20saved.\x20','./ws-server','hashRate','hashRateAvg','firmwareFileName','startTime','conditionUltimate','splice','save','.log',']\x20detected.','Rebooting\x20',']\x20update\x20configuration.','edit\x20miner\x20[','trends','n/a','Overwriting\x20workerName\x20for\x20','fine','SSH_PORT_STATE','Unable\x20to\x20determine\x20workerName\x20during\x20new\x20miner\x20pool\x20update','firmwareUpdate','update','5562032aPsdHs','Miner\x20pools\x20NOT\x20set.','Unknown\x20miner\x20type\x20at\x20[','m.\x20\x20fans:[','minutes','hot','options',',\x20initiatePowerRampUp=','exports','endTime','Debounced\x20miner\x20pools\x20update\x20\x20[','upsert','\x20miners/sec','discoverMiners\x20request\x20timed\x20out:','miner-utils','tempHot','Settings\x20update\x20requested\x20for\x20','scanStats',',\x20to:\x20','initial',',\x20live:\x20','Settings\x20update\x20requested\x20for\x20repositioning','m,\x20offlineTimestamp=','oldWorkerName','find','overclock','Detected','2lPujsz','abort','macAddress','push','getModel','[provision]\x20System\x20info\x20request\x20failed\x20during\x20provisionJob\x20for,\x20','enableStaticIP','5887776AtVJKQ','cardFailureChains','down','locationID','Setting\x20deployedOn\x20for\x20','./dhcp-server','stalled','\x20miners\x20not\x20found\x20at\x20','round','toLocaleString',']\x20in\x20',',\x20hashRatePeriodPercent:\x20','./miner-proxy','latestStableFirmware','Miner\x20pools\x20set.','runtimeState','Unable\x20to\x20extract\x20pools\x20for\x20unregistered\x20miner\x20system\x20info\x20for\x20','inactiveAlarmPercentage','discoverStartTime','accountName','m,\x20bootElapsedMinutes=','ping','1056576NGxdrG','Unable\x20to\x20sync\x20incorrect\x20configuration\x20for\x20','debug','skipped',',\x20shouldLogFailingMiners=','reduce','minerType','timestamp',',\x20\x20','%,\x20period:','.\x20apiVersion:','Create\x20unresponsive\x20miner\x20at\x20[','locationName','Not\x20rebooting\x20','hashRatePeriodicAverage','failed','stringify','configured','%\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20hasAvailablePower=','\x20to\x20','Miner\x20status\x20check\x20skipped\x20during\x20',':,\x20hashRatePercent:\x20','rejected','daily','intakeSpeed','elapsed','lastEffectiveHashingTime','../../common/utilities/data-center','condition','2959770lACVYY','ignored','filter','lodash','\x20clock\x20to\x20frequency:\x20','../../common/config','Not\x20assigned','message','Miner\x20status\x20check\x20skipped\x20one\x20time\x20to\x20avoid\x20multiple\x20concurrent\x20scans.','346895KCeXpH','user','8054928XRkceq','netmask','),\x20logStates(',',\x20isErroring=','Sync\x20miner\x20configuration\x20for\x20','persistLogs','logStates','model','M,\x20','uri','getMinerSystemInfo\x20returned\x20undefined\x20minerType','dhcpSettings','monthly','\x20@\x20','test','\x20from\x20\x20to\x20',']\x20not\x20found\x20in\x20the\x20configuration','maxChipErrorRate',']\x20failed.','Overwriting\x20firmwareFileName\x20for\x20','Configured\x20','clocking','exhaustSpeed','(m)v\x20from:\x20','../../common/utilities/plugins','length',',\x20tryRebooting=','Scan\x20results\x20received\x20for\x20','action','configure','getHours','enablePoolConfiguration','warm','\x20]\x20at\x20','isArray','destroyed','configureMode','persistedLog','Kernel\x20log\x20request\x20failed\x20during\x20scan\x20for\x20','Miner\x20system\x20info','].\x20Miner\x20type\x20[','count','positioned','cardStatus','clockingFirmware','assign','statusCode','join','].\x20Provisioning\x20required.','\x20at\x20[',',\x20power\x20available:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20,\x20hasInitialized=','catch','now','enableManagedClocking','router',']\x20name\x20','workerTypeNumber','conditionPrime','\x09\x20(','sort','\x20minutes,\x20to\x20','error','Unable\x20to\x20get\x20miner\x20system\x20info\x20from:\x20','Discover\x20statistics','Not\x20assigned.','slice','floor','hardwareErrors',',\x20isReUpload=','Skipped\x20miner\x20[','temperatures','sortBy','getMinutes','scan','Retrieve\x20network\x20diagnostic\x20failed\x20for\x20','Trend\x20archiving','max',',\x20since\x20','Scan\x20for\x20miners\x20failed','log','Adjust\x20clock:\x20Update\x20state\x20for\x20miner\x20','Broadcast\x20by\x20miner\x20','setting','forEach','broadcast','clockSettings','\x20Unauthorized.\x20Password\x20incorrect?','consumption','reserved','Discover\x20started',',\x20volts:','Miner\x20pools\x20update\x20ignored\x20for\x20','fan1','Skipping\x20miner\x20pool\x20configuration\x20for\x20[','poolIDs','getMonth','url','volts','findIndex','status','avg','updateFirmware','324MXIVjG','discovery','Miner\x20state[','\x20[\x20','toString','get-ip-range','Adjusted\x20miner\x20','destroy','Uploading\x20firmware\x20','\x20/\x20','offlineTimestamp','\x20minutes,\x20staying\x20at\x20:','replace','Miner\x20status\x20check\x20started\x20for\x20','create','shift','sshEnabled','degrading','8.8.8.8','minerTypeMap','Email\x20sent:','\x20for\x20miner\x20','ipAddress','match','modelType','accepted','enabled','unknown','Overwriting\x20accountName\x20for\x20','username','Unable\x20to\x20send\x20email:','(m)v','\x20Status\x20code:\x20','\x20from:\x20',',\x20for\x20','rebooted','{\x22minerInfos\x22:','erroring','failing','placement','success','useArpTable','mild','.\x20no\x20poolIDs\x20saved.',',\x20isOverRejecting=','all','miners','reboot','ceil','Not\x20uploading\x20OC\x20firmware\x20','provisionStatus','trace','discoverMiners\x20error:','networkScanInterval','clockFrequencyCap','toFixed','workerName','pools','Rebooted\x20','env','\x20left\x20to\x20sync','v\x20from\x20:','apiVersion','Discover\x20miners\x20initiated!\x20Scanning\x20network\x20using\x20','OPEN','Candidate\x20for\x20miner\x20pools\x20update\x20for\x20','discovered','\x20miner\x20state\x20:','],\x20hashrates:[','Pool\x20info\x20not\x20available\x20in\x20minerInfo\x20collection\x20for\x20\x20','slack','\x20miner\x20[','getDay','workerProperties','historical','\x20at\x20','temp_Antminer_updater','minerInfo',',\x20lastEffectiveHashingTime=','yearly','map','\x20offline!','],\x20during\x20discovery.\x20(Edit\x20config\x20to\x20force\x20override!)','booting','\x20from\x20','rebootTimes','parse','frequency','provisioning','\x20<>\x20','Updating\x20ipAddress\x20for\x20','enableSSH','hourly','],\x20cab:\x20','then',',\x20isFailing=','Discovered\x20miner\x20','rack','cool','warn'];_0x5af7=function(){return _0x1c1ca3;};return _0x5af7();}function _0x4804(_0x2fce6f,_0x3f4902){const _0x5af76d=_0x5af7();return _0x4804=function(_0x4804c0,_0x19cb1f){_0x4804c0=_0x4804c0-0x1d4;let _0x4e834e=_0x5af76d[_0x4804c0];return _0x4e834e;},_0x4804(_0x2fce6f,_0x3f4902);}function updateTrendTracking(_0x2f9f88,_0x4fd4a1,_0x10e6cf={},_0x17a15e,_0x5710be){const _0x3f46a1=_0x1de56e,_0x42b226=_0x4fd4a1['getFullYear'](),_0x5a68bb=_0x4fd4a1[_0x3f46a1(0x2ef)](),_0x25b132=_0x4fd4a1[_0x3f46a1(0x1f0)](),_0x5ea7ff=_0x4fd4a1[_0x3f46a1(0x2ad)](),_0x1358c5=_0x4fd4a1[_0x3f46a1(0x2d8)](),_0x3e7ddd={};let {fine:fine=[],hourly:hourly=[],minutes:minutes=[],daily:daily=[],monthly:monthly=[],yearly:yearly=[]}=_0x2f9f88;const {minute:_0x18ca50,hour:_0x90f9c2,day:_0x236be9,month:_0x37fb62,year:_0x575a12}=_0x2f9f88['lastEvent'],_0x10c788=_0x18ca50!==_0x1358c5&&fine[_0x3f46a1(0x2a8)],_0x1867df=_0x90f9c2!==_0x5ea7ff&&minutes[_0x3f46a1(0x2a8)],_0x36b13e=_0x236be9!==_0x25b132&&hourly['length'],_0xf627a0=_0x37fb62!==_0x5a68bb&&daily['length'],_0x448d02=_0x575a12!==_0x42b226&&monthly[_0x3f46a1(0x2a8)];return _0x2f9f88['lastEvent']={'minute':_0x1358c5,'hour':_0x5ea7ff,'day':_0x25b132,'month':_0x5a68bb,'year':_0x42b226},_0x448d02&&(rollupTrendPoints(monthly,yearly,_0x3f46a1(0x29b),_0x5710be,_0x17a15e),_0x3e7ddd[_0x3f46a1(0x29b)]=_0x3e7ddd[_0x3f46a1(0x1f7)]=!![]),_0xf627a0&&(rollupTrendPoints(daily,monthly,_0x3f46a1(0x27e),_0x5710be,_0x17a15e),_0x3e7ddd[_0x3f46a1(0x27e)]=_0x3e7ddd[_0x3f46a1(0x29b)]=!![]),_0x36b13e&&(rollupTrendPoints(hourly,daily,'hourly',_0x5710be,_0x17a15e),_0x3e7ddd[_0x3f46a1(0x204)]=_0x3e7ddd['daily']=!![]),_0x1867df&&(rollupTrendPoints(minutes,hourly,'minutes',_0x5710be,_0x17a15e),_0x3e7ddd[_0x3f46a1(0x233)]=_0x3e7ddd[_0x3f46a1(0x204)]=!![]),_0x2f9f88[_0x3f46a1(0x22a)]['push'](_0x10e6cf),_0x10c788&&rollupTrendPoints(fine,minutes,_0x3f46a1(0x22a),_0x5710be,_0x17a15e),{'trends':_0x2f9f88,'updated':_0x3e7ddd};}let kilowattsConsumed=0x0,minerCheckCompleted=!![];const SITE_STATE_NORMAL=0x1,SITE_STATE_OUTAGE=0x2,SITE_STATE_UNKNOWN=0x3,getTempStateName=function(_0x623bc1,_0x5897bf){const _0x217857=_0x1de56e;_0x5897bf=_0x5897bf||{'hot':0x5a,'warm':0x50,'mild':0x46};if(_0x623bc1>=_0x5897bf[_0x217857(0x234)])return _0x217857(0x234);else{if(_0x623bc1>=_0x5897bf[_0x217857(0x2af)])return'warm';else{if(_0x623bc1>=_0x5897bf[_0x217857(0x320)])return _0x217857(0x320);else{if(_0x623bc1==0x0)return'dead';}}}return _0x217857(0x20a);};async function syncMinerStatusJob(_0x4aaa2b,_0x1832d3,_0xcce552=![]){const _0x56f27d=_0x1de56e;let {ipAddress:_0x397b16,workerName:_0x45c57b,accountName:_0x9b823,macAddress:_0x525950,placement:_0x3ab0b1}=_0x4aaa2b,_0x21e8a2=getMinerTypeMap(_0x4aaa2b),_0x21f0c2=deriveApiVersion({'minerInfo':_0x4aaa2b,'minerTyped':_0x21e8a2});const {name:_0x136e2e,code:_0x40ff25,version:_0x38a72b,model:_0x2a8e97,brand:_0x33d5e1}=_0x21e8a2;Object[_0x56f27d(0x2bc)](_0x4aaa2b,{'name':_0x136e2e,'code':_0x40ff25,'version':_0x38a72b,'model':_0x2a8e97,'brand':_0x33d5e1});if(isBatchOperation||!_0x397b16)return!![];let _0x121483=await getMinerSystemInfo({'ipAddress':_0x397b16,'minerTyped':_0x21e8a2,'apiVersion':_0x21f0c2,'maxSockets':0x32})[_0x56f27d(0x2c3)](_0x261a59=>{const _0x4fb61d=_0x56f27d;let _0x1d1370='System\x20info\x20request\x20failed\x20during\x20scan\x20for\x20'+_0x45c57b+',\x20'+_0x397b16+_0x4fb61d(0x271)+_0x21f0c2;console[_0x4fb61d(0x269)](_0x1d1370,inspect(_0x261a59,![],0x5,!![]),_0x21e8a2),console[_0x4fb61d(0x20b)](_0x1d1370);});console[_0x56f27d(0x269)](_0x56f27d(0x2b6),inspect(_0x121483));_0x121483&&(!_0x121483[_0x56f27d(0x26d)]&&(console[_0x56f27d(0x20b)](_0x56f27d(0x299),_0x121483),delete _0x121483[_0x56f27d(0x26d)],delete _0x121483[_0x56f27d(0x30e)]),_0x4aaa2b=Object['assign'](_0x4aaa2b,_0x121483));let _0x3011ff=null,_0xdf66e9=null,_0x13d40e=null;_0xcce552&&(_0x3011ff=await getMinerStatus({'ipAddress':_0x397b16,'minerTyped':_0x21e8a2,'apiVersion':_0x21f0c2,'maxSockets':0xa})[_0x56f27d(0x2c3)](_0x2471ab=>{const _0x37071f=_0x56f27d;if(!/ETIMEDOUT/[_0x37071f(0x29d)](_0x2471ab['message'])){let _0x23a939='Miner\x20status\x20request\x20failed\x20during\x20scan\x20for\x20'+_0x45c57b+',\x20'+_0x397b16+'.\x20apiVersion:'+_0x21f0c2;console[_0x37071f(0x269)](_0x23a939,inspect(_0x2471ab,![],0x5,!![]),_0x21e8a2),console[_0x37071f(0x20b)](_0x23a939);}return null;}),console[_0x56f27d(0x269)]('Miner\x20status',inspect(_0x3011ff)),_0xdf66e9=await getKernelLogs({'minerInfo':_0x4aaa2b,'minerTyped':_0x21e8a2,'apiVersion':_0x21f0c2,'maxSockets':0xa})[_0x56f27d(0x2c3)](_0x50474b=>{const _0x3306d7=_0x56f27d;if(!/ETIMEDOUT/['test'](_0x50474b[_0x3306d7(0x28b)])){let _0x533d88=_0x3306d7(0x2b5)+_0x45c57b+',\x20'+_0x397b16+'.\x20apiVersion:'+_0x21f0c2;console[_0x3306d7(0x269)](_0x533d88,inspect(_0x50474b,![],0x5,!![]),_0x21e8a2),console[_0x3306d7(0x20b)](_0x533d88);}return null;}),console[_0x56f27d(0x269)]('Miner\x20log\x20states',inspect(_0xdf66e9)),dataCenterSettings['enableNetworkLatencyCheck']&&(_0x13d40e=await retrieveMinerNetworkDiagnostics({'minerInfo':_0x4aaa2b,'diagnostic':diagnostic,'minerTyped':_0x21e8a2,'apiVersion':_0x21f0c2})['catch'](_0x16efcb=>{const _0x25058e=_0x56f27d;if(!/(404|EHOSTUNREACH|ENOTFOUND)/['test'](_0x16efcb[_0x25058e(0x28b)])){let _0x31ba8c=_0x25058e(0x2da)+_0x4aaa2b[_0x25058e(0x1e0)]+',\x20'+_0x397b16+_0x25058e(0x271)+_0x21f0c2;console[_0x25058e(0x269)](_0x31ba8c,inspect(_0x16efcb,![],0x5,!![]),_0x21e8a2),console[_0x25058e(0x20b)](_0x31ba8c);}return null;}),console[_0x56f27d(0x269)]('Miner\x20diagnostic',inspect(_0x13d40e))));const {pools:_0x13c4e4,cardStatus:_0x11bcd6,workerTypeNumber:_0x53fe6b,timestamp:_0x1ec86a,..._0x51dc06}=_0x3011ff||{'workerName':_0x4aaa2b[_0x56f27d(0x1e0)]};console['debug']({'logType':_0x56f27d(0x1db)},_0x56f27d(0x2aa)+_0x45c57b+',\x20\x20'+_0x397b16+',\x20liveMinerState\x20('+!!_0x3011ff+_0x56f27d(0x291)+!!_0xdf66e9+'),\x20minerSystemInfo('+!!_0x121483+'),\x20minerInfo('+!!_0x4aaa2b+'),\x20minerDiagnostic('+!!_0x13d40e+')'),registerProxy({'workerName':_0x45c57b,'accountName':_0x9b823,'macAddress':_0x525950,'ipAddress':_0x397b16,'minerTyped':_0x21e8a2,'apiVersion':_0x21f0c2});const _0x19745c=new Date(),_0xf06f24=Date['parse'](_0x19745c);if(!_0x3011ff){invalidMiners[_0x525950]={'accountName':_0x9b823,'workerName':_0x45c57b,'ipAddress':_0x397b16,'macAddress':_0x525950,'placement':_0x3ab0b1},invalidMiners[_0x525950][_0x56f27d(0x2f3)]='inactive',deadMiners[_0x525950]=invalidMiners[_0x525950];if(!_0x4aaa2b[_0x56f27d(0x283)])_0x4aaa2b[_0x56f27d(0x283)]={'hashRate':0x0,'hashRateAvg':0x0,'accountName':'','poolName':'','temperatures':[0x0],'frequency':0x0,'pools':[]};else!_0x4aaa2b[_0x56f27d(0x283)][_0x56f27d(0x300)]&&(_0x4aaa2b[_0x56f27d(0x283)]['hashRate']=0x0,_0x4aaa2b['condition'][_0x56f27d(0x21c)]=0x0,_0x4aaa2b[_0x56f27d(0x283)]['offlineTimestamp']=_0x19745c);return trackTrends(_0x4aaa2b,_0x19745c,_0x1832d3),{'upsertedMiner':await upsertMinerInfo({'minerInfo':_0x4aaa2b}),'state':invalidMiners[_0x525950][_0x56f27d(0x2f3)]};}_0x3011ff[_0x56f27d(0x26e)]=_0x19745c,_0x3011ff['diagnostic']=_0x13d40e||{};let {cardFailureChains:_0x46c7c7,temperatures:_0x40fc20,intakeSpeed:_0x213d0b,exhaustSpeed:_0x24a6b5,..._0x98d051}=_0x3011ff;delete _0x98d051[_0x56f27d(0x2ba)];const {condition:_0x54abc5,conditionPrime:_0x5deffe}=_0x4aaa2b;!_0x5deffe&&(_0x4aaa2b[_0x56f27d(0x2c9)]=_0x98d051);_0x4aaa2b[_0x56f27d(0x295)]=_0xdf66e9||{};if(!_0x54abc5||!_0x54abc5[_0x56f27d(0x1e1)])return _0x4aaa2b[_0x56f27d(0x283)]=_0x3011ff,{'upsertedMiner':await upsertMinerInfo({'minerInfo':_0x4aaa2b}),'state':_0x56f27d(0x242)};trackTrends(_0x4aaa2b,_0x19745c,_0x1832d3);const {poolsAreDifferent:_0x15b5fa,remotesPools:_0xeac145,poolsConfig:_0x48ae16,workerName:_0x516dcb}=await validateMinerConfig({'minerInfo':_0x4aaa2b,'apiVersion':_0x21f0c2,'dataCenterSettings':dataCenterSettings,'isBulk':!![]});if(_0x15b5fa){if(_0x4aaa2b[_0x56f27d(0x2ee)]){const {poolIDs:_0x5078c3}=_0x4aaa2b;console[_0x56f27d(0x269)](_0x56f27d(0x293)+_0x45c57b+',\x20\x20'+_0x397b16,_0xeac145,_0x48ae16);}else{let {url:url=_0x56f27d(0x228),user:user=_0x56f27d(0x228)}=_0xeac145[_0x56f27d(0x1e1)][0x0]||{},{stratum:stratum=_0x56f27d(0x228),username:username=_0x56f27d(0x228)}=_0x48ae16[_0x56f27d(0x1e1)][0x0]||{};url=url['replace'](/.*:\/\//,''),stratum=stratum[_0x56f27d(0x302)](/.*:\/\//,''),url==stratum&&user==username?console['debug']('Unable\x20to\x20sync\x20configuration\x20for\x20'+_0x45c57b+',\x20\x20'+_0x397b16+_0x56f27d(0x321),_0x516dcb,_0xeac145,_0x48ae16):console[_0x56f27d(0x269)](_0x56f27d(0x268)+_0x45c57b+_0x56f27d(0x26f)+_0x397b16+_0x56f27d(0x219)+user+_0x56f27d(0x29c)+url+_0x56f27d(0x201)+username+_0x56f27d(0x29c)+stratum);}}const _0x4b04a9=!isNaN(_0x3011ff[_0x56f27d(0x280)])?parseInt(_0x3011ff[_0x56f27d(0x280)]):0x0,_0x36381b=_0x3011ff[_0x56f27d(0x21c)]||0x0,_0x72a540=_0x3011ff[_0x56f27d(0x21b)],_0x2fab8d=_0x4aaa2b[_0x56f27d(0x283)]['hashRate']||0x0,_0x2e87fe=_0x4aaa2b['condition'][_0x56f27d(0x30f)];let _0x43952f=parseInt(_0x4aaa2b[_0x56f27d(0x2c9)][_0x56f27d(0x21c)]||0x0);const _0x1a38d8=_0x4aaa2b[_0x56f27d(0x21f)]?parseInt(_0x4aaa2b[_0x56f27d(0x21f)][_0x56f27d(0x21c)]):'-',{intakeFanName:intakeFanName='fan1',exhaustFanName:exhaustFanName=_0x56f27d(0x2ec),minFanSpeed:_0x169748,tempBoundaries:_0x1934c2}=_0x21e8a2;_0x213d0b=parseInt(_0x3011ff[_0x56f27d(0x27f)]||'0',0xa),_0x24a6b5=parseInt(_0x3011ff[_0x56f27d(0x2a5)]||'0',0xa);const _0x4fdfd8=Math[_0x56f27d(0x259)](_0x72a540/(_0x43952f||_0x72a540||0x1)*0x32)*0x2,_0xdd22a3=Math[_0x56f27d(0x259)](_0x72a540/(_0x4aaa2b[_0x56f27d(0x275)]||_0x72a540||0x1)*0x64),_0x480799=parseInt(_0x4b04a9/0x6)/0xa,_0x3aebae=_0x480799>MINER_BOOT_CHECK_MINUTES,_0x9fdbe=_0x4aaa2b[_0x56f27d(0x1fd)]?_0x4aaa2b['rebootTimes'][_0x56f27d(0x2d1)](-0x1)[0x0]:{},_0xa2fd82=_0x9fdbe[_0x56f27d(0x26e)]||_0x4aaa2b['lastEffectiveHashingTime']||_0x19745c,_0x443424=parseInt((_0xf06f24-Date[_0x56f27d(0x1fe)](_0xa2fd82))/(0x3c*0x3e8)),_0x3f716b=_0x443424>MINER_BOOT_MAX_MINUTES,_0x2765d0=_0x443424>MINER_LOG_FAILING_MINUTES,_0x4eb388=!_0x3aebae&&_0x480799>0x0;let _0x58230b=!_0x3aebae&&_0x2fab8d<0x1&&_0x72a540<0x1&&!_0x24a6b5&&!_0x213d0b,_0x519ca6=![],_0x43988b=![],_0x1faf27=![];_0x3f716b&&!_0x4eb388&&(_0x58230b?(_0x519ca6=!![],_0x58230b=![]):_0x519ca6=parseInt(_0x72a540)==parseInt(_0x2fab8d)&&_0x3011ff[_0x56f27d(0x30f)]==_0x2e87fe||_0x4fdfd8==Infinity,_0x43988b=_0xdd22a3<struggleHighCheckPercent&&_0x4fdfd8<struggleHighCheckPercent,_0x1faf27=_0x4fdfd8<failureMinCheckPercent);let _0x2c728d=![];if(_0x519ca6&&_0x4aaa2b['lastEffectiveHashingTime']&&_0x4aaa2b[_0x56f27d(0x21d)]){const _0x3fd938=_0x4aaa2b[_0x56f27d(0x281)],_0x10cfd8=0x2*0x3c*0x3c*0x3e8,_0x34089e=Math[_0x56f27d(0x1d8)](_0x10cfd8/dataCenterSettings[_0x56f27d(0x1dd)]),_0x142572=parseInt((_0xf06f24-Date[_0x56f27d(0x1fe)](_0x3fd938))/dataCenterSettings[_0x56f27d(0x1dd)]);_0x2c728d=_0x142572%_0x34089e==0x0;}var _0x36c960=![];if(_0x3011ff[_0x56f27d(0x27d)]){let _0xcacfa7=(_0x3011ff['rejected']||0x0)/(_0x3011ff[_0x56f27d(0x30f)]||0x1);_0x36c960=_0xcacfa7>MAX_REJECTED_RATE;}let _0x4c2278=(_0x3011ff[_0x56f27d(0x2d3)]||[0x0])[_0x56f27d(0x26c)](intAdder,0x0),_0x1c0be8=parseInt(_0x4c2278/((_0x3011ff[_0x56f27d(0x280)]||0x1)/0x3c)),_0x5563d5=!_0x21e8a2[_0x56f27d(0x248)]?![]:_0x1c0be8>(_0x21e8a2[_0x56f27d(0x248)][_0x56f27d(0x2a0)]||MAX_CHIP_ERROR_RATE),_0x21f750=![],_0x1d3af6=![];if(Array[_0x56f27d(0x2b1)](_0x3011ff[_0x56f27d(0x2d6)])&&_0x3011ff[_0x56f27d(0x2d6)][0x0]){let _0x4c1fb7=Math[_0x56f27d(0x2dc)](..._0x3011ff[_0x56f27d(0x2d6)]||[0x0]);const _0x2d34e0=getTempStateName(_0x4c1fb7,_0x1934c2);_0x21f750=/^hot$/i['test'](_0x2d34e0),_0x1d3af6=/^(mild|cool)$/i[_0x56f27d(0x29d)](_0x2d34e0),_0x3011ff['temperatureState']=_0x2d34e0;}wattsConsumedTally+=isNaN(_0x3011ff[_0x56f27d(0x2e7)])?0x0:parseFloat(_0x3011ff[_0x56f27d(0x2e7)],0xa);if(_0x3011ff[_0x56f27d(0x252)]&&_0x3011ff[_0x56f27d(0x252)][_0x56f27d(0x2a8)]){}if(!_0x519ca6&&_0x213d0b<(_0x169748||MIN_VIABLE_FAN_SPEED)){}if(!_0x519ca6&&_0x24a6b5<(_0x169748||MIN_VIABLE_FAN_SPEED)){}_0x4aaa2b[_0x56f27d(0x283)]=_0x3011ff;_0x3011ff[_0x56f27d(0x264)]&&(_0x4aaa2b[_0x56f27d(0x264)]=_0x3011ff[_0x56f27d(0x264)]);_0x3011ff[_0x56f27d(0x1e0)]&&(_0x4aaa2b[_0x56f27d(0x1e0)]=_0x3011ff[_0x56f27d(0x1e0)]);_0x3011ff[_0x56f27d(0x2c8)]&&(_0x4aaa2b[_0x56f27d(0x2c8)]=_0x3011ff[_0x56f27d(0x2c8)]);if(currentSiteState===SITE_STATE_UNKNOWN){elapsedTally+=_0x4b04a9,++minersScannedCount;if(elapsedTally/minersScannedCount>dataCenterSettings[_0x56f27d(0x1dd)]/0x1f4)currentSiteState=SITE_STATE_NORMAL;else minersScannedCount>minerCount*0.2&&(initiatePowerRampUp=!![],currentSiteState=SITE_STATE_OUTAGE);}!_0x3f716b&&(_0x43952f=_0x43952f*0.8);if(_0x72a540>_0x43952f||isNaN(_0x2fab8d)){const {cardStatus:_0x21ceec,cardFailureChains:_0x1215fd,temperatures:_0x474f91,intakeSpeed:_0x10025f,exhaustSpeed:_0x3d62d7,..._0x1e6dad}=_0x3011ff;_0x4aaa2b[_0x56f27d(0x2c9)]=_0x1e6dad;const {pools:_0xba9baf,..._0x1afc9f}=_0x1e6dad;if(!_0x4aaa2b['conditionUltimate'])_0x4aaa2b[_0x56f27d(0x21f)]=_0x1afc9f;else _0x72a540>(_0x4aaa2b[_0x56f27d(0x21f)]['hashRate']||_0x4aaa2b[_0x56f27d(0x21f)][_0x56f27d(0x21c)]||0x0)&&(_0x4aaa2b[_0x56f27d(0x21f)]=_0x1afc9f);}const _0x275556={'accountName':_0x9b823,'workerName':_0x45c57b,'ipAddress':_0x397b16,'macAddress':_0x525950,'placement':_0x3ab0b1};_0x4fdfd8<0x5&&(deadMiners[_0x525950]=_0x275556);let _0x3a7243='',_0x17e825=![],_0x4230b4=![];if(_0x58230b)_0x3a7243=MINER_STATE_BOOTING;else{if(_0x3f716b){if(_0x519ca6)_0x3a7243=MINER_STATE_STALLED;else{if(_0x43988b)_0x3a7243=MINER_STATE_STRUGGLING;else{if(_0x1faf27)_0x3a7243=MINER_STATE_FAILING;else{if(_0x36c960)_0x3a7243=MINER_STATE_REJECTING;else _0x5563d5&&(_0x3a7243=MINER_STATE_ERRORING);}}}_0x17e825=_0x43988b||_0x1faf27||_0x519ca6,_0x4230b4=!!_0x3a7243;}else!_0x17e825?_0x3a7243=MINER_STATE_NORMAL:_0x3a7243=MINER_STATE_DEGRADING;}_0x3a7243&&(_0x4aaa2b['runtimeState']=_0x3a7243);let _0x1ab8fb=_0x1d3af6&&hasAvailablePower&&_0x480799>MINER_OC_INTERVAL_MINUTES;const _0x19db9a=!!(_0x21e8a2['overclock']&&_0x4aaa2b[_0x56f27d(0x2c5)]&&(initiatePowerRampUp||_0x5563d5||_0x21f750||_0x1ab8fb));console['debug'](_0x56f27d(0x2f8)+_0x3a7243+']\x20'+_0x45c57b+',\x20'+_0x397b16+_0x56f27d(0x27c)+_0x4fdfd8+_0x56f27d(0x25c)+_0xdd22a3+_0x56f27d(0x279)+hasAvailablePower+_0x56f27d(0x2a9)+_0x4230b4+',\x20shouldAdjustClock='+_0x19db9a+_0x56f27d(0x2d4)+_0x2c728d+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20,\x20isRunningCool='+_0x1d3af6+',\x20isOverHeating='+_0x21f750+_0x56f27d(0x236)+initiatePowerRampUp+_0x56f27d(0x292)+_0x5563d5+_0x56f27d(0x2c2)+_0x3aebae+',\x20shouldBeHashingByNow='+_0x3f716b+_0x56f27d(0x26b)+_0x2765d0+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20,\x20isStalled='+_0x519ca6+',\x20isStruggling='+_0x43988b+_0x56f27d(0x1d4)+_0x36c960+_0x56f27d(0x207)+_0x1faf27+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20,\x20initElapsedMinutes='+_0x480799+_0x56f27d(0x265)+_0x443424+_0x56f27d(0x245)+_0x4aaa2b[_0x56f27d(0x300)]+_0x56f27d(0x1f6)+_0x4aaa2b['lastEffectiveHashingTime']);const _0x15c2a6=_0x9b823+'.'+_0x45c57b+'\x20['+_0x397b16+',\x20'+_0x525950+_0x56f27d(0x25b)+_0x3a7243+_0x56f27d(0x243)+_0x480799+'m,\x20on:\x20'+_0x443424+_0x56f27d(0x232)+_0x213d0b+',\x20'+_0x24a6b5+_0x56f27d(0x1ec)+parseInt(_0x72a540)+',\x20'+_0x43952f+',\x20'+_0x1a38d8+'],\x20at:'+_0x4fdfd8+_0x56f27d(0x270)+_0xdd22a3+'%';validMiners[_0x525950]={'logText':_0x15c2a6,'accountName':_0x9b823,'workerName':_0x45c57b,'ipAddress':_0x397b16,'macAddress':_0x525950,'placement':_0x3ab0b1};if(_0x19db9a){delete alertableMiners[_0x525950];_0x5563d5&&(_0x1ab8fb=![]);const _0x9e8101=initiatePowerRampUp?-0x9:_0x1ab8fb?0x1:-0x1,_0x236354=getOptimumClockSettings(_0x4aaa2b,_0x3011ff,_0x21e8a2,_0x9e8101),{condition:_0x401e4a,conditionPrime:_0x1a392f,clockSettings:_0x367918}=_0x4aaa2b,_0x31e068=_0x401e4a['pools']&&_0x401e4a[_0x56f27d(0x1e1)][_0x56f27d(0x2a8)]?_0x401e4a[_0x56f27d(0x1e1)]:_0x1a392f[_0x56f27d(0x1e1)],_0x22a5ee=_0x367918||{},_0x13ca35=_0x236354[_0x56f27d(0x1ff)]&&_0x31e068&&_0x31e068['length'];_0x236354[_0x56f27d(0x1ff)]?console['debug'](_0x56f27d(0x2e0)+_0x45c57b+',\x20'+_0x397b16+_0x56f27d(0x2c1)+hasAvailablePower+_0x56f27d(0x2dd)+_0x480799+_0x56f27d(0x2cc)+_0x236354[_0x56f27d(0x1ff)]+','+_0x236354[_0x56f27d(0x2f1)]+_0x56f27d(0x1e5)+_0x22a5ee[_0x56f27d(0x1ff)]+','+_0x22a5ee[_0x56f27d(0x2f1)]+'v'):console['debug']('Adjust\x20clock:\x20Keep\x20state\x20for\x20miner\x20'+_0x45c57b+',\x20'+_0x397b16+_0x56f27d(0x2c1)+hasAvailablePower+_0x56f27d(0x2dd)+_0x480799+_0x56f27d(0x301)+_0x22a5ee[_0x56f27d(0x1ff)]+','+_0x22a5ee[_0x56f27d(0x2f1)]+'v');if(_0x13ca35&&(_0x22a5ee[_0x56f27d(0x1ff)]!==_0x236354['frequency']||_0x22a5ee[_0x56f27d(0x2f1)]!==_0x236354[_0x56f27d(0x2f1)])){const _0x3e379b=_0x236354,_0x3b237c=_[_0x56f27d(0x1f8)](_0x31e068,(_0x25f933,_0x40c4bf)=>{const _0x463cf2=_0x56f27d;return{'index':_0x40c4bf+0x1,'stratum':_0x25f933[_0x463cf2(0x2f0)],'username':_0x25f933['user'],'password':'x'};});return updateMinerSettings({'minerInfo':_0x4aaa2b,'minerTyped':_0x21e8a2,'pools':_0x3b237c,'minerConfigOptions':_0x3e379b,'apiVersion':_0x21f0c2})[_0x56f27d(0x206)](async _0x571d2f=>{const _0x473274=_0x56f27d;if(/\bok\b/i[_0x473274(0x29d)](_0x571d2f)){_0x4aaa2b['runtimeState']=MINER_STATE_CLOCKING,console['log'](_0x473274(0x2fc)+_0x45c57b+',\x20'+_0x4aaa2b[_0x473274(0x30c)]+'\x20clock\x20'+(_0x236354[_0x473274(0x1ff)]>_0x22a5ee[_0x473274(0x1ff)]?'up':_0x473274(0x253))+_0x473274(0x27a)+_0x236354[_0x473274(0x1ff)]+_0x473274(0x297)+_0x236354[_0x473274(0x2f1)]+_0x473274(0x2a6)+(_0x22a5ee[_0x473274(0x1ff)]||0x0)+'M,\x20'+(_0x22a5ee['volts']||0x0)+_0x473274(0x315)),_0x4aaa2b[_0x473274(0x2e5)]={..._0x3e379b},_0x4aaa2b[_0x473274(0x2c9)]=null;const _0x323b01=!_0x4aaa2b['clockFrequencyCap']||parseInt(_0x4aaa2b[_0x473274(0x1de)])>_0x236354[_0x473274(0x1ff)];(_0x5563d5||_0x43988b)&&_0x323b01&&(console['log']('Adjusting\x20the\x20clocking\x20cap\x20for\x20'+_0x45c57b+_0x473274(0x317)+_0x4aaa2b[_0x473274(0x1de)]+_0x473274(0x241)+_0x236354[_0x473274(0x1ff)]),_0x4aaa2b[_0x473274(0x1de)]=_0x236354['frequency']);}else console[_0x473274(0x2df)]('Adjust\x20failure\x20for\x20miner\x20'+_0x45c57b+',\x20'+_0x4aaa2b['ipAddress']+_0x473274(0x288)+_0x236354[_0x473274(0x1ff)]+_0x473274(0x2ea)+_0x236354[_0x473274(0x2f1)]);return{'upsertedMiner':await upsertMinerInfo({'minerInfo':_0x4aaa2b}),'state':_0x3a7243};});}}else{if(_0x2c728d){const {firmwareFileName:_0x161643}=_0x4aaa2b;if(!/updater/['test'](_0x161643))return console['log'](_0x56f27d(0x2fe)+_0x15c2a6),updateMinerFirmware({'minerInfo':_0x4aaa2b,'minerTyped':_0x21e8a2,'firmwareFileName':_0x161643,'apiVersion':_0x21f0c2});else console[_0x56f27d(0x2df)](_0x56f27d(0x1d9)+_0x15c2a6);}else{if(_0x4230b4){if(_0x4aaa2b[_0x56f27d(0x260)]===MINER_STATE_REBOOTING)console[_0x56f27d(0x2df)](_0x56f27d(0x1e2)+_0x15c2a6),_0x4aaa2b['runtimeState']=MINER_STATE_BOOTING;else{if(_0x17e825){alertableMiners[_0x525950]=_0x275556,_0x4aaa2b[_0x56f27d(0x260)]=MINER_STATE_REBOOTING;!_0x4aaa2b[_0x56f27d(0x1fd)]&&(_0x4aaa2b[_0x56f27d(0x1fd)]=[]);_0x4aaa2b[_0x56f27d(0x1fd)][_0x56f27d(0x2a8)]>0x14&&_0x4aaa2b[_0x56f27d(0x1fd)][_0x56f27d(0x305)]();_0x4aaa2b[_0x56f27d(0x2c9)]=null,_0x4aaa2b[_0x56f27d(0x1fd)][_0x56f27d(0x24d)]({'reason':_0x3a7243,'timestamp':_0x19745c,'percentOfPrime':_0x4fdfd8,'liveHashRate':_0x72a540,'liveHashRateAvg':_0x36381b}),console[_0x56f27d(0x2df)](_0x56f27d(0x224)+_0x15c2a6);const _0x2147e8=upsertMinerInfo({'minerInfo':_0x4aaa2b})['then'](()=>getMinerReboot(_0x4aaa2b,_0x21e8a2,_0x21f0c2));return{'upsertedMiner':_0x2147e8,'state':_0x4aaa2b[_0x56f27d(0x260)]};}else console[_0x56f27d(0x269)](_0x56f27d(0x274)+_0x15c2a6),console[_0x56f27d(0x2df)](_0x56f27d(0x274)+_0x9b823+'.'+_0x45c57b+'\x20['+_0x397b16+',\x20'+_0x525950+_0x56f27d(0x25b)+_0x3a7243);}}else{if(_0x3a7243&&_0x4aaa2b[_0x56f27d(0x260)]!==MINER_STATE_NORMAL)alertableMiners[_0x525950]=_0x275556,alertableMiners[_0x525950]['status']=_0x3a7243,_0x2765d0&&(console['log'](_0x56f27d(0x213)+_0x15c2a6),console[_0x56f27d(0x269)]('Failing\x20miner,\x20'+_0x3a7243+_0x56f27d(0x1eb)+inspect(_0x51dc06)));else return _0x4aaa2b[_0x56f27d(0x281)]=_0x19745c,delete alertableMiners[_0x525950],{'upsertedMiner':await upsertMinerInfo({'minerInfo':_0x4aaa2b}),'state':_0x3a7243};}}}return{'upsertedMiner':await upsertMinerInfo({'minerInfo':_0x4aaa2b}),'state':_0x3a7243};}let hasAvailablePower=0x0,wattsConsumedTally=0x0,elapsedTally=0x0,minersScannedCount=0x0,initiatePowerRampUp=![],currentSiteState=SITE_STATE_NORMAL,minerCount=0x0,deadMiners={};async function compareMinerStatus(_0x2b9b2e,_0x4778c6,_0x50beb1){const _0x222613=_0x1de56e,_0x3a9fa9=loopback['getModel'](_0x222613(0x1f5)),{availableKilowatts:availableKilowatts=0x0,powerRampUpDisabled:powerRampUpDisabled=![],configureMode:_0x41bec8}=dataCenterSettings;!kilowattsConsumed&&(kilowattsConsumed=availableKilowatts);hasAvailablePower=!availableKilowatts||availableKilowatts>kilowattsConsumed,wattsConsumedTally=0x0,elapsedTally=0x0,minersScannedCount=0x0,initiatePowerRampUp=![],currentSiteState=powerRampUpDisabled?SITE_STATE_NORMAL:SITE_STATE_UNKNOWN,deadMiners={};let _0xc7469e=Date[_0x222613(0x2c4)](),_0x3af387={};if(_0x2b9b2e){const {range:_0x3b6cca}=_0x2b9b2e,_0x2013e4=getIPRange(_0x3b6cca[0x0],_0x3b6cca[0x1]);_0x3af387={'where':{'ipAddress':{'inq':_0x2013e4}}};}const _0x5e1f2f=await _0x3a9fa9['find'](_0x3af387),_0x1c8db3=_0x5e1f2f[_0x222613(0x1f8)](_0x140fab=>_0x140fab[_0x222613(0x30c)]),_0x12e10c=await getScanCache(_0x2b9b2e||dataCenterSettings['dhcpSettings'],_0x4778c6,_0x50beb1,_0x1c8db3);if(_0x41bec8===CONFIGURE_MODE_PROVISION){console['log'](_0x222613(0x27b)+(_0x41bec8==CONFIGURE_MODE_DISCOVERY?_0x222613(0x2f7):_0x222613(0x200))+'.');return;}if(!minerCheckCompleted){console['log'](_0x222613(0x28c)),minerCheckCompleted=!![];return;}minerCheckCompleted=![],minerCount=_0x5e1f2f[_0x222613(0x2a8)];const _0x360c1a=Date[_0x222613(0x1fe)](new Date())[_0x222613(0x2fa)]();console[_0x222613(0x2df)](_0x222613(0x303)+minerCount+_0x222613(0x215)+kilowattsConsumed[_0x222613(0x25a)]()+'\x20/\x20'+availableKilowatts['toLocaleString']()+'\x20kw');const _0x4677e0={'skipped':[],'live':[]},_0x10f403=0x64;while(_0x5e1f2f['length']){await Promise['all'](_0x5e1f2f[_0x222613(0x220)](0x0,_0x10f403)[_0x222613(0x1f8)](async _0x40e3c4=>{const _0x162536=_0x222613;let {ipAddress:_0x3c4551}=_0x40e3c4;const _0x4de83d=!_0x3c4551||!!_0x12e10c[_0x3c4551],{upsertedMiner:_0x2c168a,state:_0x5c3488}=await syncMinerStatusJob(_0x40e3c4,_0x360c1a,_0x4de83d);console['debug']('SyncState\x20of\x20'+_0x5c3488+_0x162536(0x30b)+(_0x2c168a?.[_0x162536(0x30c)]||_0x3c4551)),_0x2c168a?(!_0x4677e0[_0x5c3488]&&(_0x4677e0[_0x5c3488]=[]),_0x4677e0[_0x5c3488||'live'][_0x162536(0x24d)](_0x2c168a?.['ipAddress'])):_0x4677e0[_0x162536(0x26a)][_0x162536(0x24d)](_0x3c4551);})),console[_0x222613(0x269)]('Batch\x20sync\x20size\x20is\x20'+_0x10f403+'.\x20'+_0x5e1f2f[_0x222613(0x2a8)]+_0x222613(0x1e4));};Object['keys'](_0x4677e0)[_0x222613(0x2e3)](_0x560aa7=>{const _0x30eae4=_0x222613;_0x4677e0[_0x560aa7][_0x30eae4(0x2cb)](ipDesc);});if(!_0x4677e0)return;const _0x9602ad=function(_0x559922){const _0x5e5965=_0x222613;reportedDates[_0x559922[_0x5e5965(0x24c)]]&&reportedDates[_0x559922[_0x5e5965(0x24c)]]<Date[_0x5e5965(0x2c4)]()-notifyTime&&(reportedDates[_0x559922[_0x5e5965(0x24c)]]=null);if(!reportedDates[_0x559922[_0x5e5965(0x24c)]])return!![];};let _0x31cecb=_['sortBy'](_[_0x222613(0x286)](invalidMiners,_0x9602ad),['accountName','workerName']),_0x4b7730=_[_0x222613(0x2d7)](_['filter'](alertableMiners,_0x9602ad),[_0x222613(0x264),_0x222613(0x1e0)]),_0x138862=_['sortBy'](_[_0x222613(0x286)](deadMiners,_0x9602ad),(_0x30fddc={})=>{const _0x117601=_0x222613,{hall:_0x581ff3,rack:_0x630287,shelf:_0x4141eb,position:_0x440572}=_0x30fddc[_0x117601(0x31d)]||{};return[_0x581ff3,_0x630287,_0x4141eb,_0x440572];}),_0xdd307c='';const _0x575fa1=(_0x4be936,_0x46ce5a)=>{const _0x369254=_0x222613;_0x46ce5a&&(_0x4be936[_0x369254(0x283)]={});const {accountName:_0x432a30,workerName:_0x74ccb0,ipAddress:_0x7bcbc8,macAddress:_0x5dacb0}=_0x4be936;reportedDates[_0x5dacb0]=Date[_0x369254(0x2c4)]();const {hall:_0x534e83,rack:_0x40d6c8,shelf:_0x428c1e,position:_0x173a3e}=_0x4be936[_0x369254(0x31d)]||{};return _0x432a30+'.'+_0x74ccb0+_0x369254(0x1f3)+_0x534e83+'.'+_0x40d6c8+'.'+_0x428c1e+'.'+_0x173a3e+_0x369254(0x2ca)+_0x7bcbc8+')';};_0x31cecb[_0x222613(0x2a8)]&&(_0xdd307c+='\x0a['+dataCenterSettings[_0x222613(0x254)]+']\x20'+_0x31cecb['length']+_0x222613(0x258)+dataCenterSettings[_0x222613(0x273)]+'.\x0a',_0xdd307c+=_['map'](_0x31cecb,_0x54afc5=>_0x575fa1(_0x54afc5,!![]))['join']('\x0a'));_0x4b7730['length']&&(_0xdd307c+='\x0a['+dataCenterSettings['locationID']+']\x20'+_0x4b7730[_0x222613(0x2a8)]+'\x20miners\x20are\x20failing\x20at\x20'+dataCenterSettings[_0x222613(0x273)]+'.\x0a',_0xdd307c+=_[_0x222613(0x1f8)](_0x4b7730,_0x4cbac6=>_0x575fa1(_0x4cbac6))[_0x222613(0x2be)]('\x0a'));if(_0x138862[_0x222613(0x2a8)]>minerCount*(dataCenterSettings[_0x222613(0x262)]||0x2)/0x64){let _0x3e5944=dataCenterSettings[_0x222613(0x273)]+'.\x20'+_0x138862[_0x222613(0x2a8)]+_0x222613(0x1f9);_0xdd307c=_[_0x222613(0x26c)](_0x138862,(_0x4fa6e6,_0x57b916={})=>{const _0x548718=_0x222613,{hall:hall='',rack:rack='',shelf:shelf='',position:position=''}=_0x57b916[_0x548718(0x31d)]||{};var _0x22f6cb=hall+'.'+rack+'.'+shelf+'.'+position;return _0x22f6cb[_0x548718(0x2a8)]<=0x4&&(_0x22f6cb=_0x548718(0x2d0)),_0x4fa6e6+(_0x22f6cb+'\x09'+_0x57b916[_0x548718(0x1e0)]+'\x0d');},'\x0d'),await offlineMiners({'subject':_0x3e5944,'text':_0xdd307c})[_0x222613(0x2c3)](_0x3b14be=>{const _0x5c9337=_0x222613;console['error'](_0x5c9337(0x314),_0x3b14be);})[_0x222613(0x206)](_0x3708ab=>{const _0x202181=_0x222613;console[_0x202181(0x2df)](_0x202181(0x30a),_0x3708ab);},_0x583c37=>{console['error'](_0x583c37);});}let _0x18a6b5=parseInt(Math[_0x222613(0x259)]((Date[_0x222613(0x2c4)]()-_0xc7469e)/0x64))/0xa;kilowattsConsumed=parseInt(wattsConsumedTally/0x3e8);const _0x2e189e='Miner\x20status\x20check\x20completed\x20for\x20'+minerCount+'\x20miners\x20in\x20'+_0x18a6b5+_0x222613(0x20d)+kilowattsConsumed[_0x222613(0x25a)]()+_0x222613(0x2ff)+availableKilowatts[_0x222613(0x25a)]()+'\x20kw';return console[_0x222613(0x2df)](_0x2e189e),slackMessage({'text':_0xdd307c}),socketSendMiners(_0x4677e0),minerCheckCompleted=!![],{'message':_0x2e189e,'minerInfoUpserts':_0x4677e0,'invalids':_0x31cecb,'alertables':_0x4b7730,'deadones':_0x138862,'validMiners':validMiners,'text':_0xdd307c};}function socketSendMiners(_0x42c979,_0x1ca218){const _0x19c941=_0x1de56e;let _0xda16a4=_[_0x19c941(0x1f8)](_0x42c979,(_0x3813c3={})=>{const _0xaca7a2=_0x19c941;if(!_0x3813c3||!_0x3813c3[_0xaca7a2(0x212)])return{};const {name:_0x188ef4,minerType:_0x567225,ipAddress:_0x77f303,macAddress:_0x98e96a,placement:_0x103241,accountName:_0x5355ac,workerName:_0x45c1b0,condition:_0x228c11,conditionPrime:_0xba922,deployments:_0x538d52,systemLogicVersion:_0x445d6e,serialNumber:_0x461297,psuSerialNumber:_0x4ee573,psuModel:_0x171d21,networkSwitchRef:_0x4eeac4,breakerPanelId:_0x2eaf31,powerBarId:_0x2da14e,powerPhase:_0x55f622,transformerLow:_0xf5edb4,transformerMed:_0x313f61}=_0x3813c3;let _0x93a5ad={'name':_0x188ef4,'minerType':_0x567225,'ipAddress':_0x77f303,'macAddress':_0x98e96a,'placement':_0x103241,'accountName':_0x5355ac,'workerName':_0x45c1b0,'condition':_0x228c11,'conditionPrime':_0xba922,'deployments':_0x538d52,'systemLogicVersion':_0x445d6e,'serialNumber':_0x461297,'psuSerialNumber':_0x4ee573,'psuModel':_0x171d21,'networkSwitchRef':_0x4eeac4,'breakerPanelId':_0x2eaf31,'powerBarId':_0x2da14e,'powerPhase':_0x55f622,'transformerLow':_0xf5edb4,'transformerMed':_0x313f61};return _0x3813c3[_0xaca7a2(0x26d)]&&minerTypeMap[_0x567225]&&(_0x93a5ad[_0xaca7a2(0x309)]=minerTypeMap[_0x567225]),_0x93a5ad[_0xaca7a2(0x1da)]=_0x1ca218||'',_0x93a5ad;}),_0x13ee69=_0x19c941(0x31a)+JSON[_0x19c941(0x277)](_0xda16a4)+'}';socketSend({'text':_0x13ee69});}function sendMessage({text:_0x1a1fbe,accessToken:_0x6fd41a},_0x5e7223){if(!_0x1a1fbe)return;_0x5e7223&&slackMessage({'text':_0x1a1fbe}),socketSend({'text':_0x1a1fbe,'accessToken':_0x6fd41a});}module[_0x1de56e(0x237)]={'provisionMiner':provisionMiner,'provisionMinersByType':provisionMinersByType,'provisionUnresponsiveMiner':provisionUnresponsiveMiner,'getDataCenterRacklist':getDataCenterRacklist,'discoverMiners':discoverMiners,'compareMinerStatus':compareMinerStatus,'setDataCenterSettings':setDataCenterSettings,'syncMinerStatusJob':syncMinerStatusJob,'socketSendMiners':socketSendMiners};