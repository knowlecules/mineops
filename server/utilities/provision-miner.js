/* Copyright (C) 9208-9721 Quebec, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Jason Rudland <jason.g.rudland@gmail.com>, September 2022
*/'use strict';const _0x187b5b=_0x2130;(function(_0x56f528,_0x530018){const _0x2bf84d=_0x2130,_0x1e2c29=_0x56f528();while(!![]){try{const _0x1ae99d=parseInt(_0x2bf84d(0x1f8))/0x1+parseInt(_0x2bf84d(0x213))/0x2*(parseInt(_0x2bf84d(0x1f9))/0x3)+parseInt(_0x2bf84d(0x11d))/0x4*(-parseInt(_0x2bf84d(0x1cd))/0x5)+parseInt(_0x2bf84d(0x156))/0x6+parseInt(_0x2bf84d(0x136))/0x7*(parseInt(_0x2bf84d(0x16f))/0x8)+-parseInt(_0x2bf84d(0x12f))/0x9+parseInt(_0x2bf84d(0x1c1))/0xa*(-parseInt(_0x2bf84d(0x12c))/0xb);if(_0x1ae99d===_0x530018)break;else _0x1e2c29['push'](_0x1e2c29['shift']());}catch(_0x49d77a){_0x1e2c29['push'](_0x1e2c29['shift']());}}}(_0x3000,0x8f6ec));const loopback=require(_0x187b5b(0xeb)),{getMinerSystemInfo,getRemotesPools,getMinerSettings,getMinerStatus,getMinerInfo,getMinerReboot,getMinerReset,getMinerType,getMinerTypeMap,createMinerInfo,updateMinerSettings,updateMinerNetworkSettings,retrieveMinerNetworkDiagnostics,updateMinerFirmware,updateEnableSSH,validateMinerConfig,extractAccountAndWorkerNumber,upsertMinerInfo,getKernelLogs,getPoolIDs,deriveApiVersion,completeMinerVersion}=require(_0x187b5b(0x101)),{getPlugin}=require(_0x187b5b(0x1ad)),{getDataCenterSettings}=require(_0x187b5b(0x199)),_=require(_0x187b5b(0x107)),{scanForMinerVersions,getScanCache,ipDesc}=require(_0x187b5b(0x1a4)),{upsertLease}=require(_0x187b5b(0x174)),{offlineMiners}=require(_0x187b5b(0xc9)),config=require('../../common/config'),{registerProxy}=require(_0x187b5b(0x1a9)),{slackMessage}=require(_0x187b5b(0x20c)),{socketSend}=require(_0x187b5b(0xee)),promiseLimit=require(_0x187b5b(0x1b3)),{inspect}=require(_0x187b5b(0x144)),{getIPRange}=require(_0x187b5b(0x106)),{api}=require(_0x187b5b(0xca)),{minerTypeMap}=config;let validMiners={},alertableMiners={},invalidMiners={},reportedDates={};const notifyTime=0x18/0x3*0x3c*0x3c*0x3e8,CONFIGURE_MODE_DETECT=0x1,CONFIGURE_MODE_PROVISION=0x2,CONFIGURE_MODE_REPOSITION=0x3,CONFIGURE_MODE_DISCOVERY=0x4,MIN_ACCEPTED_COUNT=0x1f4,MAX_REJECTED_RATE=0.04,MAX_CHIP_ERROR_RATE=0x3c,MIN_CHIP_TEMPERATURE=0x1e,MIN_VIABLE_FAN_SPEED=0x7d0,deploymentDebounceTime=0xf*0x3e8,MINER_OC_INTERVAL_MINUTES=0x25,MINER_BOOT_MAX_MINUTES=0x15,MINER_LOG_FAILING_MINUTES=MINER_BOOT_MAX_MINUTES-0x5,MINER_BOOT_CHECK_MINUTES=0x7,MINER_STATE_NORMAL='hashing',MINER_STATE_BOOTING=_0x187b5b(0x113),MINER_STATE_REBOOTING=_0x187b5b(0x1e4),MINER_STATE_DEGRADING='degrading',MINER_STATE_STALLED=_0x187b5b(0x1a6),MINER_STATE_CLOCKING='clocking',MINER_STATE_REJECTING=_0x187b5b(0x126),MINER_STATE_STRUGGLING=_0x187b5b(0x135),MINER_STATE_FAILING=_0x187b5b(0xd8),MINER_STATE_ERRORING='erroring',failureMinCheckPercent=0x3c,struggleHighCheckPercent=0x55,CHART_TREND_HISTORY_COUNT=0x28,timeSlotPeriod=0x3;let dataCenterSettings=null,isBatchOperation=![];const SSH_PORT_STATE=global['SSH_PORT_STATE'],diagnostic=process['env']['NETWORK_DIAGNOSTIC']?JSON[_0x187b5b(0x1a7)](process[_0x187b5b(0x112)][_0x187b5b(0x1bf)]):{'type':'ping','ipAddress':_0x187b5b(0xcd)};Math['avg']=_0x5de8b6=>(_0x5de8b6?.['length']?_0x5de8b6:[0x0])[_0x187b5b(0xba)]((_0x30a595=0x0,_0x50e790=0x0)=>parseFloat(_0x50e790)+parseFloat(_0x30a595))/(_0x5de8b6?.[_0x187b5b(0x1ca)]||0x1);function _0x2130(_0x1fa312,_0x26eb84){const _0x3000b9=_0x3000();return _0x2130=function(_0x21306c,_0xa643cf){_0x21306c=_0x21306c-0xb4;let _0x56b72c=_0x3000b9[_0x21306c];return _0x56b72c;},_0x2130(_0x1fa312,_0x26eb84);}function statusObject(_0x3e60ec,_0x371a60,_0x2207b0,_0x30349f){const {ipAddress:_0x562dcf,macAddress:_0x23fcb4}=_0x2207b0;return{'action':_0x3e60ec,'status':_0x371a60,'ipAddress':_0x562dcf,'macAddress':_0x23fcb4,'minerConfigOptions':_0x30349f};}let network;async function setDataCenterSettings(_0x14b761){const _0x55ea1c=_0x187b5b;dataCenterSettings=_0x14b761,network={'netmask':_0x14b761[_0x55ea1c(0x190)][_0x55ea1c(0x143)],'gateway':_0x14b761[_0x55ea1c(0x190)][_0x55ea1c(0x1d1)],'dnsServer':_0x14b761['dhcpSettings'][_0x55ea1c(0x1d1)]};}async function provisionMiner({ipAddress:_0x525f0c,minerConfigOptions:minerConfigOptions={},minerTyped:minerTyped={}}){const _0x2651c7=_0x187b5b,_0x207568=await getMinerSystemInfo({'ipAddress':_0x525f0c,'minerTyped':minerTyped})[_0x2651c7(0x1c5)](_0x14d5df=>{const _0x473853=_0x2651c7;let _0x2f9739=_0x473853(0x17d)+_0x525f0c+_0x473853(0x10d);_0x14d5df[_0x473853(0x218)]?_0x14d5df[_0x473853(0x218)]===0x191?_0x2f9739+=_0x473853(0x1e3):_0x2f9739+=_0x473853(0x1dd)+_0x14d5df[_0x473853(0x218)]:_0x2f9739+=_0x14d5df[_0x473853(0x1f4)];sendMessage({'text':_0x2f9739});throw _0x14d5df;});if(!_0x207568)throw new Error(_0x2651c7(0xf6)+_0x525f0c);const {macAddress:_0x518108}=_0x207568,{pools:pools=[]}=await getRemotesPools({'ipAddress':_0x525f0c,'macAddress':_0x518108},minerTyped)||{'pools':[{'user':''}]},_0x3fc893=pools[_0x2651c7(0x1fa)](_0x1e03e9=>_0x1e03e9[_0x2651c7(0x16d)]),{accountName:_0x828f91,workerName:_0x5435b5,workerTypeNumber:_0x2539f1}=await extractAccountAndWorkerNumber({'poolWorkers':_0x3fc893})||{},_0x4e5d9d={'accountName':_0x828f91,'workerName':_0x5435b5,'workerTypeNumber':_0x2539f1};let _0x2b2a08=await getMinerInfo({'macAddress':_0x518108,'accountName':_0x828f91,'workerName':_0x5435b5,'ipAddress':_0x525f0c}),_0x857458='Broadcast\x20by\x20miner\x20'+_0x828f91+','+_0x5435b5+_0x2651c7(0xb7)+_0x525f0c+','+_0x518108+_0x2651c7(0x1d2);sendMessage({'text':_0x857458}),socketSendMiners([_0x207568],_0x2651c7(0x1f1));const _0x1ee4b8=dataCenterSettings['enablePoolConfiguration'];return configureMiner({'minerSystemInfo':_0x207568,'workerProperties':_0x4e5d9d,'minerInfo':_0x2b2a08,'minerConfigOptions':minerConfigOptions,'shouldConfigurePools':_0x1ee4b8});}async function provisionUnresponsiveMiner({ipAddress:_0x58b30e,macAddress:_0xdb0c2,minerName:_0x208502}){const _0x4ea642={'macAddress':_0xdb0c2,'ipAddress':_0x58b30e,'minerType':_0x208502};return configureMiner({'minerSystemInfo':_0x4ea642})['catch'](_0xbb65ba=>{let _0x450eef='Create\x20unresponsive\x20miner\x20at\x20['+_0xdb0c2+']\x20failed.';sendMessage({'text':_0x450eef});throw _0xbb65ba;});}async function getDataCenterRacklist({ipAddress:_0x2f63cc,macAddress:_0x47746e,minerName:_0x53d925}){const _0x49d028=_0x187b5b,_0x1f5c3e=loopback[_0x49d028(0x1e8)]('minerInfo');let _0x204f64={'where':{'placement.position':{'nin':[0x0,'',null,undefined,![]]}},'fields':{'placement':!![]},'order':[_0x49d028(0x21b),_0x49d028(0x142)]},_0x1501df=await _0x1f5c3e[_0x49d028(0x214)](_0x204f64)['map'](_0x5ad171=>{const {placement:_0x3fe912}=_0x5ad171,{hall:_0x189a31,rack:_0x413e98}=_0x3fe912||{};return{'hall':_0x189a31,'rack':_0x413e98};}),_0x57136b=_0x1501df[_0x49d028(0x12e)]((_0x4fbbeb,_0x222a67,_0x3ce43c)=>_0x3ce43c[_0x49d028(0x19e)](_0x39e099=>[_0x49d028(0x1e2),_0x49d028(0x153)]['every'](_0x9bc04f=>_0x39e099[_0x9bc04f]===_0x4fbbeb[_0x9bc04f]))===_0x222a67);return _0x57136b=_[_0x49d028(0x1f6)](_0x57136b,_0x3d915f=>_0x3d915f?.[_0x49d028(0x1e2)]||_0x49d028(0x203)),_0x57136b;}function _0x3000(){const _0x4cd20a=['stalled','parse','pools','./miner-proxy','networkScanInterval','rejected','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20,\x20isRunningCool=','../../common/utilities/plugins','ignored','getMinutes','sort','fan1','Batch\x20sync\x20size\x20is\x20','promise-limit','\x20at\x20','),\x20minerInfo(','enableStaticIP',']\x20in\x20','System\x20info\x20request\x20failed\x20during\x20scan\x20for\x20','Debounced\x20miner\x20pools\x20update\x20\x20[','Settings\x20update\x20requested\x20for\x20repositioning','push',',\x20isFailing=','Miner\x20pools\x20set.',',\x20cab:\x20','NETWORK_DIAGNOSTIC','Scan\x20for\x20miners\x20failed','190hYoowM',',\x20shouldAdjustClock=','workerTypeNumber',',\x20step:\x20','catch','keys','deployedOn','\x20to\x20','%,\x20period:','length','username','replace','5SBbNnI','\x20]\x20at\x20','forEach','round','router',']\x20detected.','toLowerCase','action','abort','ceil','\x27tcp\x20detection\x27.','poolIDs','clockingFirmware','accepted','options','Settings\x20update\x20requested\x20for\x20','\x20Status\x20code:\x20','latestStableFirmware','rebooted','floor','enableSSH','hall','\x20Unauthorized.\x20Password\x20incorrect?','rebooting','\x20miners\x20not\x20found\x20at\x20','Unable\x20to\x20sync\x20configuration\x20for\x20','Kernel\x20log\x20request\x20failed\x20during\x20scan\x20for\x20','getModel','test','temperatures','overclock','Miner\x20system\x20info','minerTypeMap','clockFrequencyCap','.\x20no\x20poolIDs\x20saved.',',\x20for\x20','discovered','\x20clock\x20','Setting\x20deployedOn\x20for\x20','message','cardFailureChains','groupBy','temperatureState','484959zgtSWf','9IKFIop','map','\x20from:\x20','Configuring\x20aborted\x20due\x20to\x20unknown\x20minerType:',',\x20live:\x20','failed','Candidate\x20for\x20miner\x20pools\x20update\x20for\x20','Miner\x20state[','Unable\x20to\x20extract\x20pools\x20for\x20unregistered\x20miner\x20system\x20info\x20for\x20','{\x22minerInfos\x22:','Not\x20assigned','Invalid\x20minerType!','configure','historical','(m)v','inactiveAlarmPercentage','Not\x20rebooting\x20','Miner\x20log\x20states','),\x20minerDiagnostic(','./slack-messaging','Adjust\x20failure\x20for\x20miner\x20','tmp/','Unable\x20to\x20determine\x20workerName\x20during\x20new\x20miner\x20pool\x20update','\x20miners/sec','splice','\x20miners.\x20Power\x20consumed\x20','164774CawbzR','find','max','\x20minutes,\x20staying\x20at\x20:','placement','statusCode','stack','Discover\x20miners\x20initiated!\x20Scanning\x20network\x20using\x20','placement.hall\x20DESC','count','startTime','reboot','\x20at\x20[','assign','volts','reduce','inactive',',\x20isOverHeating=','success','hot',']\x20not\x20found\x20in\x20the\x20configuration','monthly','enableManagedClocking','\x20miner\x20[',']\x20pool\x20update.\x20(Check\x20config!)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20,\x20initElapsedMinutes=','stringify','firmwareFileName','name',',\x20isStruggling=','./email','slack','timestamp','lastEffectiveHashingTime','8.8.8.8','mild','trends','Failing\x20miner,\x20','oldWorkerName','rebootTimes','destroy',',\x20hashRatePeriodPercent:\x20','Configured\x20Update\x20not\x20required\x20','.\x20apiVersion:','hashRatePeriodicAverage','failing','Unable\x20to\x20sync\x20incorrect\x20configuration\x20for\x20','m,\x20on:\x20','status','destroyed','warm','.\x20no\x20poolIDs\x20saved.\x20','create','\x20/\x20','scan','getDay','ipAddress','ipAddresses','Detected','Configured\x20','sshEnabled',',\x20volts:','upsert','locationID','loopback','locationName','offlineTimestamp','./ws-server','\x20miners\x20are\x20failing\x20at\x20','Email\x20sent:','reserved','minerInfo','all','Miner\x20status\x20check\x20completed\x20for\x20','clockSettings','Unable\x20to\x20get\x20miner\x20system\x20info\x20from:\x20',',\x20tryRebooting=','toFixed','none','Rack\x20position\x20update\x20[','Miner\x20status\x20request\x20failed\x20during\x20scan\x20for\x20','endTime',',\x20since\x20','persistedLog',',\x20frequency:\x20','Scan\x20results\x20received\x20for\x20','../../common/utilities/miner-settings','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20,\x20hasInitialized=','consumption','enableNetworkLatencyCheck','\x20for\x20account\x20','get-ip-range','lodash','broadcast','Miner\x20diagnostic','),\x20logStates(','initial','],\x20hashrates:[',']\x20failed.','\x20to\x20trigger\x20add\x20to\x20deployments\x20list','elapsed','model','sortBy','env','booting','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20,\x20isStalled=','Sync\x20miner\x20configuration\x20for\x20','match',':,\x20hashRatePercent:\x20','Miner\x20pools\x20overwrite\x20failed\x20for\x20','logStates','enablePoolConfiguration','Overwriting\x20workerName\x20for\x20','Miner\x20pools\x20NOT\x20set.','2036940TULMPu','\x20seconds.\x20Consuming\x20','\x20@\x20','reset','\x27arp-scan\x27.','configured','exhaustSpeed','modelType','positioned','rejecting','edit\x20miner\x20[','then','macAddress','slice','discoverMiners\x20request\x20timed\x20out:','140910NhOOJU','lastAccess','filter','81585dioezZ','cool',',\x20lastEffectiveHashingTime=','Miner\x20pools\x20update\x20ignored\x20for\x20','],\x20cab:\x20','\x20for\x20','struggling','1392531HFIWgd','enabled','indexOf','diagnostic','discoverStartTime','provisionStatus','Configuration\x20not\x20required\x20','runtimeState','maxChipErrorRate','getMonth','trace','includes','placement.rack\x20ASC','netmask','util','(m)v\x20from:\x20','conditionUltimate','\x20for\x20miner\x20','minutes','error','Not\x20uploading\x20OC\x20firmware\x20',',\x20isErroring=','Adjust\x20clock\x20factors\x20for\x20','miner-utils','save','hashRate','hardwareErrors','M,\x20','configureMode','rack','SyncState\x20of\x20','daily','1315224lxHmGy','m,\x20offlineTimestamp=','v\x20from\x20:','live','\x20kw','workerName','updateFirmware','\x20clock\x20to\x20frequency:\x20','provisioning','],\x20during\x20discovery.\x20(Edit\x20config\x20to\x20force\x20override!)','toLocaleString','toString','log','Uploading\x20firmware\x20','apiVersion','warn','condition','conditionPrime','uri','hourly','Miner\x20pools\x20overwritten\x20for\x20','Pool\x20info\x20not\x20available\x20in\x20minerInfo\x20collection\x20for\x20\x20','Retrieve\x20network\x20diagnostic\x20failed\x20for\x20','user','join','16uaPOuU','down','update','Rebooted\x20','scanStats','./dhcp-server','\x20offline!','\x20from\x20\x20to\x20','Settings\x20','Miner\x20status\x20check\x20skipped\x20one\x20time\x20to\x20avoid\x20multiple\x20concurrent\x20scans.',']\x20name\x20','lastEvent','Not\x20assigned.','minerType','Broadcast\x20activity\x20by\x20miner\x20at\x20[','\x09\x20(','hashRateAvg',',\x20\x20','Unable\x20to\x20send\x20email:','getHours','now','frequency','Miner\x20pools\x20NOT\x20overwritten\x20for\x20','intakeSpeed','useArpTable','exports','accountName','url','Skipped\x20miner\x20[','setting','settingsInfo','tempHot',',\x20isReUpload=','dhcpSettings','\x20left\x20to\x20sync','\x20[\x20','fine',',\x20initiatePowerRampUp=','\x20<>\x20','firmwareUpdate','debug','Adjust\x20clock:\x20Update\x20state\x20for\x20miner\x20','../../common/utilities/data-center','].\x20Provisioning\x20required.','Discover\x20error',',\x20cap:\x20','Trend\x20archiving','findIndex','sysInfo','Failing\x20miner\x20','\x20minutes,\x20to\x20','\x20from\x20','n/a','./net-scan',',\x20shouldLogFailingMiners='];_0x3000=function(){return _0x4cd20a;};return _0x3000();}async function provisionMinersByType({ipAddresses:_0x2c8055,poolIDs:_0x2b2294,minerUpdates:_0x2f4ee3,minerConfigOptions:minerConfigOptions={}}){const _0x2ecc85=_0x187b5b,_0x509316=loopback[_0x2ecc85(0x1e8)](_0x2ecc85(0xf2));let _0x17a2e6={};isBatchOperation=!![];let _0x37e2f6=_0x2f4ee3['enableSSH']||_0x2f4ee3['enableStaticIP']||_0x2f4ee3[_0x2ecc85(0xc1)]?promiseLimit(0x6):promiseLimit(0x64);_0x2f4ee3['updateFirmware']&&(_0x37e2f6=promiseLimit(0x1));_0x2c8055&&_0x2c8055[_0x2ecc85(0x1ca)]&&(_0x17a2e6={'where':{'ipAddress':{'inq':_0x2c8055}}});async function _0x38adc1(_0x2632a0){const _0x3e1ab4=_0x2ecc85,{minerType:_0x480f62,ipAddress:_0x35c5d2}=_0x2632a0,_0x553964=getMinerTypeMap(_0x2632a0),_0x1ebe47=deriveApiVersion({'minerInfo':_0x2632a0,'minerTyped':_0x553964});if(_0x35c5d2===dataCenterSettings['dhcpSettings'][_0x3e1ab4(0x1d1)][0x0]||_0x35c5d2===dataCenterSettings[_0x3e1ab4(0x190)][_0x3e1ab4(0x108)])return statusObject(_0x3e1ab4(0xf1),'success',_0x2632a0,minerConfigOptions);!_0x2b2294&&(_0x2b2294=await getPoolIDs(_0x2632a0));if(_0x2f4ee3[_0x3e1ab4(0xd3)])return _0x2632a0['destroy'](()=>statusObject(_0x3e1ab4(0xdc),_0x3e1ab4(0xbd),_0x2632a0,minerConfigOptions));if(_0x2f4ee3[_0x3e1ab4(0xb6)])return getMinerReboot(_0x2632a0,_0x553964,_0x1ebe47)[_0x3e1ab4(0x128)](()=>statusObject(_0x3e1ab4(0x1df),_0x3e1ab4(0xbd),_0x2632a0,minerConfigOptions));if(_0x2f4ee3[_0x3e1ab4(0x120)])return getMinerReset(_0x2632a0,_0x553964,_0x1ebe47)['then'](()=>statusObject(_0x3e1ab4(0x120),_0x3e1ab4(0xbd),_0x2632a0,minerConfigOptions));if(_0x2f4ee3['persistLogs']){let _0x2eef73=_0x3e1ab4(0x20e)+_0x2632a0[_0x3e1ab4(0x15b)]+'.log';return getKernelLogs({'minerInfo':_0x2632a0,'minerTyped':_0x553964,'apiVersion':_0x1ebe47,'maxSockets':0xa,'filepath':_0x2eef73})[_0x3e1ab4(0x128)](()=>statusObject(_0x3e1ab4(0xfe),'success',_0x2632a0,minerConfigOptions));}if(_0x2f4ee3[_0x3e1ab4(0x1e1)])return updateEnableSSH({'minerInfo':_0x2632a0,'minerTyped':_0x553964,'minerInfo':_0x2632a0,'apiVersion':_0x1ebe47})[_0x3e1ab4(0x128)](_0x252d36=>{return _0x2632a0['sshEnabled']=_0x252d36?_0x252d36:![],upsertMinerInfo({'minerInfo':_0x2632a0})['then'](_0x5b9482=>{const _0x32f2cd=_0x2130;return statusObject(_0x32f2cd(0x1e1),_0x2632a0[_0x32f2cd(0xe7)],_0x2632a0,minerConfigOptions);});});if(_0x2f4ee3[_0x3e1ab4(0x1b6)])return updateMinerNetworkSettings({'minerInfo':_0x2632a0,'network':network,'minerTyped':_0x553964,'apiVersion':_0x1ebe47})['then'](_0x2f00e5=>{const _0x548856=_0x3e1ab4;return statusObject(_0x548856(0x1b6),_0x2f00e5?'enabled':'failed',_0x2632a0,minerConfigOptions);});if(_0x2f4ee3['enableManagedClocking'])return _0x2632a0[_0x3e1ab4(0xc1)]=/\bon\b/i[_0x3e1ab4(0x1e9)](_0x2f4ee3[_0x3e1ab4(0xc1)]),upsertMinerInfo({'minerInfo':_0x2632a0})[_0x3e1ab4(0x128)](_0x512577=>{const _0x502081=_0x3e1ab4;return statusObject(_0x502081(0xc1),_0x512577?_0x502081(0x137):_0x502081(0x1fe),_0x2632a0,minerConfigOptions);});if(_0x2f4ee3['updateFirmware']){let _0x1b81a7;if(/overclock/i[_0x3e1ab4(0x1e9)](_0x2f4ee3['updateFirmware'])&&_0x553964[_0x3e1ab4(0x1d9)])_0x1b81a7=_0x553964['clockingFirmware'];else{if(/lsf/i['test'](_0x2f4ee3[_0x3e1ab4(0x15c)])&&_0x553964[_0x3e1ab4(0x1de)])_0x1b81a7=_0x553964[_0x3e1ab4(0x1de)];else{if(/\.(gz|swu)$/i[_0x3e1ab4(0x1e9)](_0x2f4ee3['updateFirmware'])&&_0x2f4ee3['updateFirmware'])_0x1b81a7=_0x2f4ee3['updateFirmware'];else return statusObject('firmwareUpdate',_0x3e1ab4(0x1ae),_0x2632a0,minerConfigOptions);}}return updateMinerFirmware({'minerInfo':_0x2632a0,'minerTyped':_0x553964,'firmwareFileName':_0x1b81a7,'apiVersion':_0x1ebe47})[_0x3e1ab4(0x128)](async _0x3fe6a1=>{const _0xc9ed15=_0x3e1ab4;_0x2632a0[_0xc9ed15(0xe7)]=![],_0x2632a0[_0xc9ed15(0x167)]=null;_0x3fe6a1===SSH_PORT_STATE['OPEN']&&(_0x2632a0[_0xc9ed15(0xc6)]=_0x1b81a7,_0x2632a0[_0xc9ed15(0x164)]=_0x1ebe47);const _0x12f354=await upsertMinerInfo({'minerInfo':_0x2632a0});if(_0x3fe6a1!=SSH_PORT_STATE['OPEN'])return statusObject(_0xc9ed15(0x196),_0xc9ed15(0x1fe),_0x2632a0,minerConfigOptions);return statusObject(_0xc9ed15(0x196),_0xc9ed15(0xbd),_0x2632a0,minerConfigOptions);});}let _0x349cc9=await getMinerSystemInfo({'ipAddress':_0x35c5d2,'minerTyped':_0x553964,'apiVersion':_0x1ebe47})['catch'](_0x5d4d9e=>{const _0x549061=_0x3e1ab4;let _0x3204f9='[provision]\x20System\x20info\x20request\x20failed\x20during\x20provisionJob\x20for,\x20'+_0x35c5d2+'.\x20apiVersion:'+_0x1ebe47;return console['debug'](_0x3204f9,inspect(_0x5d4d9e,![],0x5,!![]),_0x553964),console[_0x549061(0x165)](_0x3204f9),statusObject(_0x549061(0x1d5),_0x549061(0x149),_0x2632a0,minerConfigOptions);});if(!_0x349cc9)return statusObject(_0x3e1ab4(0x1d5),_0x3e1ab4(0x1ae),_0x2632a0,minerConfigOptions);const _0x2404bc=dataCenterSettings[_0x3e1ab4(0x11a)],_0x9a8100=!![],_0x1abdc4=_0x2f4ee3['workerProperties'];return configureMiner({'minerSystemInfo':_0x349cc9,'workerProperties':_0x1abdc4,'minerInfo':_0x2632a0,'minerConfigOptions':minerConfigOptions,'shouldConfigurePools':_0x2404bc,'isBulk':_0x9a8100,'poolIDs':_0x2b2294});};return _0x509316[_0x2ecc85(0x214)](_0x17a2e6)[_0x2ecc85(0x128)](_0xd11c58=>{const _0x460051=_0x2ecc85,_0x4f5068=_0xd11c58[_0x460051(0x1fa)](_0x22683b=>{return _0x37e2f6(()=>_0x38adc1(_0x22683b));}),_0x4fa980=Promise['all'](_0x4f5068);return isBatchOperation=![],_0x4fa980;});}async function configureMiner({minerSystemInfo:_0x460f3e,workerProperties:_0x33cd8d,minerInfo:_0x197a48,minerConfigOptions:_0x330c40,shouldConfigurePools:_0x89eb34,isBulk:_0x1af608,poolIDs:_0x2bba39}){const _0x1fa4ae=_0x187b5b;if(!_0x460f3e)return null;let {minerType:_0x6e27ca,modelType:_0x549dbc,apiVersion:_0x49d011,macAddress:_0x1298b3,ipAddress:_0x4651b3}=_0x460f3e;!_0x549dbc&&_0x197a48&&(_0x549dbc=_0x197a48[_0x1fa4ae(0x124)]||_0x197a48['minerType']);const _0x2110b5=getMinerTypeMap({'modelType':_0x549dbc});if(!_0x2110b5)return console[_0x1fa4ae(0x165)](_0x1fa4ae(0x1fc)+_0x549dbc,_0x460f3e),statusObject(_0x1fa4ae(0x1d5),'error',_0x460f3e,_0x330c40);const {name:_0x3b0e34,minerConfigOptions:_0x4661b8}=_0x2110b5;!Object[_0x1fa4ae(0x1c6)](_0x330c40||{})[_0x1fa4ae(0x1ca)]&&_0x4661b8&&(_0x330c40=_0x4661b8);const _0x4abd41=_0x89eb34,_0x3e93b7=await getDataCenterSettings(_0x3b0e34,!_0x197a48),_0x4a1c77=!_0x197a48;if(_0x4a1c77){let {minerIndex:minerIndex=0x0,placement:_0xdfdef8,accountName:_0x211e01,workerName:_0x4378f2,workerTypeNumber:_0x50df38,configureMode:_0x281d65,equipment:equipment={}}=_0x3e93b7;const _0x1d9cc1=_0x281d65===CONFIGURE_MODE_DETECT&&!_0x1af608&&!(_0x2bba39&&_0x2bba39[_0x1fa4ae(0x1ca)]);_0x1af608?(_0xdfdef8={},minerIndex=0x0,_0x211e01=_0x460f3e[_0x1fa4ae(0x189)]||'',_0x197a48={'macAddress':_0x1298b3,'ipAddress':_0x4651b3,'apiVersion':_0x49d011,'modelType':_0x549dbc,'minerType':_0x6e27ca,..._0x33cd8d}):_0x197a48={'macAddress':_0x1298b3,'ipAddress':_0x4651b3,'apiVersion':_0x49d011,'modelType':_0x549dbc,'minerType':_0x6e27ca,'workerName':_0x4378f2,'workerTypeNumber':_0x50df38,'accountName':_0x211e01,...equipment};_0x197a48=await createMinerInfo({'minerInfo':_0x197a48,'placement':_0xdfdef8,'minerIndex':minerIndex,'accountName':_0x211e01,'minerTyped':_0x2110b5});let _0x454936=null;if(_0x89eb34){const {poolsAreDifferent:_0x4b91a5,poolsConfig:_0x4b099f,workerName:_0x1824ec}=await validateMinerConfig({'minerInfo':_0x197a48,'apiVersion':_0x49d011,'dataCenterSettings':dataCenterSettings,'minerConfigOptions':_0x330c40,'poolIDs':_0x2bba39,'isBulk':_0x1af608}),{pools:_0x3c567f}=_0x4b099f;_0x1824ec?(_0x197a48[_0x1fa4ae(0x15b)]=_0x1824ec,_0x49d011=_0x49d011||deriveApiVersion({'minerInfo':_0x197a48,'minerTyped':_0x2110b5}),registerProxy({'workerName':_0x197a48[_0x1fa4ae(0x15b)],'accountName':_0x211e01,'macAddress':_0x1298b3,'ipAddress':_0x4651b3,'minerTyped':_0x2110b5,'apiVersion':_0x49d011})):console['warn'](_0x1fa4ae(0x20f),_0x197a48);const {rack:rack=0x0,shelf:shelf=0x0,position:position=0x0,hall:hall=''}=_0x197a48[_0x1fa4ae(0x217)]||{};let _0x423b60='Update\x20requested\x20for\x20new\x20miner\x20['+_0x4651b3+',\x20'+_0x1298b3+_0x1fa4ae(0x133)+hall+'.'+rack+'.'+shelf+'.'+position+_0x1fa4ae(0x1f0)+_0x3c567f[0x0][_0x1fa4ae(0x1cb)];console[_0x1fa4ae(0x162)](_0x423b60),sendMessage({'text':_0x1fa4ae(0x177)+_0x423b60}),socketSendMiners([_0x197a48],_0x1fa4ae(0x18c));if(_0x4b91a5){_0x197a48[_0x1fa4ae(0x1d8)]=_0x2bba39,_0x330c40[_0x1fa4ae(0xc6)]=_0x197a48[_0x1fa4ae(0xc6)];const _0x446f21=await updateMinerSettings({'minerInfo':_0x197a48,'minerTyped':_0x2110b5,'pools':_0x3c567f,'minerConfigOptions':_0x330c40,'apiVersion':_0x49d011});_0x423b60=_0x1fa4ae(0xe6)+_0x423b60,console[_0x1fa4ae(0x162)](_0x1fa4ae(0x1bd),_0x4651b3,_0x446f21);}else _0x423b60=_0x1fa4ae(0xd5)+_0x423b60,console[_0x1fa4ae(0x162)](_0x1fa4ae(0x11c),_0x4651b3);_0x197a48[_0x1fa4ae(0x12d)]=new Date(),sendMessage({'text':_0x423b60}),socketSendMiners([_0x197a48],'configured');}else _0x33cd8d&&_0x33cd8d[_0x1fa4ae(0x15b)]&&(_0x197a48[_0x1fa4ae(0x15b)]=_0x33cd8d[_0x1fa4ae(0x15b)],_0x197a48[_0x1fa4ae(0x1c3)]=_0x33cd8d[_0x1fa4ae(0x1c3)]),console[_0x1fa4ae(0x162)]('Skipping\x20miner\x20pool\x20configuration\x20for\x20['+_0x197a48[_0x1fa4ae(0x189)]+'.'+_0x197a48[_0x1fa4ae(0x15b)]+_0x1fa4ae(0x15f));return upsertMinerInfo({'minerInfo':_0x197a48,'configureMode':_0x281d65})[_0x1fa4ae(0x128)](()=>{const _0x4b3cb8=_0x1fa4ae;return statusObject(_0x4b3cb8(0xdf),_0x4b3cb8(0xbd),_0x460f3e,_0x330c40);});}const _0x580c28=_0x197a48[_0x1fa4ae(0x12d)];if(!_0x1af608&&_0x580c28&&_0x580c28>Date['now']()-deploymentDebounceTime){const {rack:rack=0x0,shelf:shelf=0x0,position:position=0x0,hall:hall=''}=_0x197a48['placement']||{};let _0x4c0d9d=_0x1fa4ae(0x1b9)+_0x197a48['ipAddress']+',\x20'+_0x1298b3+_0x1fa4ae(0x133)+hall+'.'+rack+'.'+shelf+'.'+position+_0x1fa4ae(0x134)+_0x197a48[_0x1fa4ae(0x189)]+'.'+_0x197a48[_0x1fa4ae(0x15b)];return console[_0x1fa4ae(0x162)](_0x4c0d9d),sendMessage({'text':_0x4c0d9d}),socketSendMiners([_0x197a48],_0x1fa4ae(0x125)),statusObject(_0x1fa4ae(0x171),'debounce',_0x460f3e,_0x330c40);}else{let _0x13c8cb=_0x1fa4ae(0x1ff)+_0x197a48[_0x1fa4ae(0x189)]+'.'+_0x197a48[_0x1fa4ae(0x15b)]+',\x20'+_0x197a48[_0x1fa4ae(0xe3)]+',\x20'+_0x197a48[_0x1fa4ae(0x129)];console[_0x1fa4ae(0x162)](_0x13c8cb),sendMessage({'text':_0x13c8cb});}_0x197a48[_0x1fa4ae(0x12d)]=new Date();let {placement:_0x59c142,workerTypeNumber:_0x74bb8a,accountName:_0x5f3738,configureMode:_0x1685bd,equipment:equipment={}}=_0x3e93b7,_0x2a9df6=_0x1685bd===CONFIGURE_MODE_PROVISION||_0x2bba39&&_0x2bba39[_0x1fa4ae(0x1ca)],_0x3e3ecb=!_0x1af608&&_0x1685bd===CONFIGURE_MODE_REPOSITION,_0x12d69e=!_0x1af608&&_0x1685bd===CONFIGURE_MODE_PROVISION;if(_0x3e3ecb||_0x12d69e){_0x197a48[_0x1fa4ae(0x217)]={..._0x59c142},_0x197a48=Object[_0x1fa4ae(0xb8)](_0x197a48,equipment);if(_0x3e3ecb){let {workerTypeNumber:_0x4e1b86,workerName:_0x271576,accountName:_0x2efde9}=_0x33cd8d||{};_0x197a48[_0x1fa4ae(0x1c3)]=_0x4e1b86||_0x197a48[_0x1fa4ae(0x1c3)],_0x197a48[_0x1fa4ae(0x189)]=_0x2efde9||_0x197a48[_0x1fa4ae(0x189)],_0x197a48['workerName']=_0x271576||_0x197a48['workerName'];}else _0x12d69e&&_0x5f3738&&parseInt(_0x74bb8a)>0x0&&(_0x197a48[_0x1fa4ae(0x1c3)]=_0x74bb8a,_0x197a48[_0x1fa4ae(0x189)]=_0x5f3738);if(!_0x2a9df6){const {rack:rack=0x0,shelf:shelf=0x0,position:position=0x0,hall:hall=''}=_0x197a48[_0x1fa4ae(0x217)]||{};let _0x2606fc=_0x1fa4ae(0xfa)+_0x197a48[_0x1fa4ae(0xe3)]+',\x20'+_0x1298b3+'],\x20cab:\x20'+hall+'.'+rack+'.'+shelf+'.'+position;console[_0x1fa4ae(0x162)](_0x2606fc),sendMessage({'text':_0x2606fc}),socketSendMiners([_0x197a48],_0x1fa4ae(0x125));}}if(_0x1af608&&_0x33cd8d){let {workerTypeNumber:_0x3d8435,workerName:_0x11282f,deployedOn:_0x505a1d,accountName:_0xfeaef3,placement:_0x1efe88}=_0x33cd8d;if(_0x197a48[_0x1fa4ae(0x110)]!==_0x2110b5[_0x1fa4ae(0x110)]){const {model:_0x1a4ccb,code:_0x51db2f,name:_0x1b80b3}=_0x2110b5,_0xb7fe99={'model':_0x1a4ccb,'code':_0x51db2f,'name':_0x1b80b3,'minerType':_0x6e27ca,'modelType':_0x549dbc,'apiVersion':_0x49d011};_0x197a48=Object[_0x1fa4ae(0xb8)](_0x197a48,_0xb7fe99);}_0x4651b3&&_0x197a48['ipAddress']!==_0x4651b3&&(console['debug']('Updating\x20ipAddress\x20for\x20'+_0x197a48[_0x1fa4ae(0x15b)]+_0x1fa4ae(0x1a2)+_0x197a48[_0x1fa4ae(0xe3)]+'\x20to\x20'+_0x4651b3),_0x197a48[_0x1fa4ae(0xe3)]=_0x4651b3);!_0x197a48['firmwareFileName']&&_0x460f3e[_0x1fa4ae(0xc6)]&&(console[_0x1fa4ae(0x197)]('Overwriting\x20firmwareFileName\x20for\x20'+_0x197a48[_0x1fa4ae(0x15b)]+_0x1fa4ae(0x1a2)+_0x197a48[_0x1fa4ae(0xc6)]+_0x1fa4ae(0x1c8)+_0x460f3e[_0x1fa4ae(0xc6)]),_0x197a48[_0x1fa4ae(0xc6)]=_0x460f3e[_0x1fa4ae(0xc6)]);_0x2a9df6&&_0x505a1d&&(console['debug'](_0x1fa4ae(0x1f3)+_0x197a48[_0x1fa4ae(0x15b)]+_0x1fa4ae(0x1c8)+_0x505a1d+_0x1fa4ae(0x10e)),_0x197a48[_0x1fa4ae(0x1c7)]=_0x505a1d);_0xfeaef3&&_0x197a48[_0x1fa4ae(0x189)]!==_0xfeaef3&&(console[_0x1fa4ae(0x197)]('Overwriting\x20accountName\x20for\x20'+_0x197a48[_0x1fa4ae(0x15b)]+'\x20from\x20'+_0x197a48[_0x1fa4ae(0x189)]+_0x1fa4ae(0x1c8)+_0xfeaef3),_0x197a48[_0x1fa4ae(0x189)]=_0xfeaef3);if(_0x11282f)_0x197a48['workerName']!=_0x11282f&&(_0x197a48[_0x1fa4ae(0x166)][_0x1fa4ae(0xd1)]=_0x11282f,console['debug'](_0x1fa4ae(0x11b)+_0x197a48[_0x1fa4ae(0x189)]+'.'+_0x197a48[_0x1fa4ae(0x15b)]+_0x1fa4ae(0x176)+_0x197a48[_0x1fa4ae(0x189)]+'.'+_0x460f3e[_0x1fa4ae(0x15b)])),_0x197a48['workerTypeNumber']=_0x3d8435||(_0x11282f[_0x1fa4ae(0x116)](/\d+$/)||[0x0])[0x0];else _0x3d8435&&(_0x197a48[_0x1fa4ae(0x1c3)]=_0x3d8435);_0x197a48['placement']=_0x1efe88;}if(!_0x2a9df6){let _0x278a98=_0x3e3ecb?_0x1fa4ae(0x1ba):_0x1fa4ae(0xe5),_0x379ca7='';if(!_0x197a48)_0x379ca7=_0x278a98+_0x1fa4ae(0xc2)+_0x4651b3+',\x20'+_0x1298b3+_0x1fa4ae(0x19a);else{const {rack:rack=0x0,shelf:shelf=0x0,position:position=0x0,hall:hall=''}=_0x197a48['placement']||{};_0x379ca7=_0x278a98+'\x20miner\x20['+_0x4651b3+',\x20'+_0x1298b3+_0x1fa4ae(0x179)+_0x197a48['workerName']+_0x1fa4ae(0x1be)+hall+'.'+rack+'.'+shelf+'.'+position;}return await upsertMinerInfo({'minerInfo':_0x197a48,'configureMode':_0x1685bd}),sendMessage({'text':_0x379ca7}),console[_0x1fa4ae(0x162)](_0x379ca7),socketSendMiners([_0x197a48],'configured'),console[_0x1fa4ae(0x162)](_0x1fa4ae(0x132)+_0x197a48['accountName']+'.'+_0x197a48[_0x1fa4ae(0x15b)],_0x4651b3,_0x1298b3),{'action':_0x278a98[_0x1fa4ae(0x1d3)](),'status':_0x1fa4ae(0xbd),'ipAddress':_0x4651b3,'macAddress':_0x1298b3};}_0x4651b3=_0x197a48[_0x1fa4ae(0xe3)],_0x1298b3=_0x197a48[_0x1fa4ae(0x129)];if(_0x4abd41){const {poolsAreDifferent:_0x2b7e91,remotesPools:_0x892915,poolsConfig:poolsConfig={},workerName:_0x38428f}=await validateMinerConfig({'minerInfo':_0x197a48,'apiVersion':_0x49d011,'dataCenterSettings':dataCenterSettings,'minerConfigOptions':_0x330c40,'poolIDs':_0x2bba39,'isBulk':_0x1af608}),{pools:_0x202034}=poolsConfig;_0x38428f?(_0x197a48['workerName']=_0x38428f,_0x49d011=_0x49d011||deriveApiVersion({'minerInfo':_0x197a48,'minerTyped':_0x2110b5}),registerProxy({'workerName':_0x197a48[_0x1fa4ae(0x15b)],'accountName':_0x5f3738,'macAddress':_0x1298b3,'ipAddress':_0x4651b3,'minerTyped':_0x2110b5,'apiVersion':_0x49d011})):console['warn']('Unable\x20to\x20determine\x20workerName\x20during\x20new\x20miner\x20pool\x20update',_0x197a48);if(!_0x892915){let _0x2e6b3d=_0x1fa4ae(0x16b)+_0x5f3738+'.'+_0x197a48[_0x1fa4ae(0x15b)]+'\x20['+_0x4651b3+',\x20'+_0x1298b3+']';console[_0x1fa4ae(0x197)](_0x2e6b3d),console['warn'](_0x2e6b3d),socketSend(_0x2e6b3d);}if(_0x89eb34){const {rack:rack=0x0,shelf:shelf=0x0,position:position=0x0,hall:hall=''}=_0x197a48[_0x1fa4ae(0x217)]||{};let _0x1a6ef6=_0x1fa4ae(0x127)+_0x4651b3+',\x20'+_0x1298b3+_0x1fa4ae(0x133)+hall+'.'+rack+'.'+shelf+'.'+position+',\x20for\x20'+_0x202034[0x0][_0x1fa4ae(0x1cb)];console[_0x1fa4ae(0x162)](_0x1fa4ae(0x1dc)+_0x1a6ef6),socketSendMiners([_0x197a48],_0x1fa4ae(0x18c)),_0x197a48[_0x1fa4ae(0x1d8)]=_0x2bba39;if(_0x2b7e91){sendMessage({'text':'Settings\x20update\x20requested\x20for\x20'+_0x1a6ef6}),_0x330c40['firmwareFileName']=_0x197a48['firmwareFileName'];const _0x2412b6=await updateMinerSettings({'minerInfo':_0x197a48,'minerTyped':_0x2110b5,'pools':_0x202034,'minerConfigOptions':_0x330c40,'apiVersion':_0x49d011}),{message:message=''}=_0x2412b6||{};if(/error/i['test'](message))return console[_0x1fa4ae(0x162)](_0x1fa4ae(0x118)+_0x197a48[_0x1fa4ae(0x189)]+'.'+_0x38428f,_0x4651b3,_0x1298b3,message),{'action':_0x1fa4ae(0x171),'status':_0x1fa4ae(0x1fe),'ipAddress':_0x4651b3,'macAddress':_0x1298b3,'updatePools':_0x2412b6};const {frequency:_0x45f4e9,volts:_0x169933}=_0x330c40;_0x45f4e9&&(_0x197a48['clockSettings']={'frequency':_0x45f4e9,'volts':_0x169933}),_0x1a6ef6=_0x1fa4ae(0xe6)+_0x1a6ef6,console[_0x1fa4ae(0x162)](_0x1fa4ae(0x16a)+_0x197a48['accountName']+'.'+_0x38428f,_0x4651b3,_0x1298b3);}else _0x1a6ef6=_0x1fa4ae(0x13c)+_0x1a6ef6,console[_0x1fa4ae(0x162)](_0x1fa4ae(0x185)+_0x197a48[_0x1fa4ae(0x189)]+'.'+_0x38428f,_0x4651b3,_0x1298b3);sendMessage({'text':_0x1a6ef6});}else text='Skipped\x20miner\x20['+_0x197a48['accountName']+'.'+_0x197a48[_0x1fa4ae(0x15b)]+_0x1fa4ae(0xc3),_0x4651b3,_0x1298b3,sendMessage({'text':text});return socketSendMiners([_0x197a48],_0x1fa4ae(0x122)),upsertMinerInfo({'minerInfo':_0x197a48,'configureMode':_0x1685bd})[_0x1fa4ae(0x128)](()=>{const _0x25f3c6=_0x1fa4ae;return statusObject('update',_0x25f3c6(0xbd),_0x460f3e,_0x330c40);});}else console[_0x1fa4ae(0x162)](_0x1fa4ae(0x18b)+_0x197a48[_0x1fa4ae(0x189)]+'.'+_0x197a48[_0x1fa4ae(0x15b)]+']\x20update\x20configuration.',_0x4651b3,_0x1298b3);return upsertMinerInfo({'minerInfo':_0x197a48,'configureMode':_0x1685bd})[_0x1fa4ae(0x128)](()=>{const _0xff8e15=_0x1fa4ae;return statusObject(_0xff8e15(0xf9),_0xff8e15(0xbd),_0x460f3e,_0x330c40);});}async function discoverMiners(_0x4e7de1,_0x5bcc50,_0x19051f=!dataCenterSettings['useArpTable']){const _0x52c2f9=_0x187b5b;async function _0x1564bf(_0x127835){const _0x2a02f0=_0x2130;let _0x186e8d=completeMinerVersion(_0x127835);const {ipAddress:_0x26fa6b,minerType:_0x5f2271,macAddress:_0x3e3b54,apiVersion:_0x38dde6}=_0x186e8d;_0x38dde6&&_0x38dde6===_0x5f2271&&console[_0x2a02f0(0x149)](_0x2a02f0(0x204),_0x127835);const _0x1530dc=getMinerTypeMap(_0x186e8d);if(!_0x1530dc){let _0x461975='Unknown\x20miner\x20type\x20at\x20['+_0x26fa6b+',\x20'+_0x3e3b54+'].\x20Miner\x20type\x20['+_0x5f2271+_0x2a02f0(0xbf);return console[_0x2a02f0(0x162)](_0x461975,_0x186e8d),sendMessage(_0x461975);}_0x320208[_0x2a02f0(0x19f)]++,upsertLease(_0x3e3b54,_0x26fa6b);const {pools:pools=[]}=await getRemotesPools(_0x186e8d,_0x1530dc,_0x38dde6),_0x1c399c=pools[_0x2a02f0(0x1fa)](_0x4f856b=>_0x4f856b[_0x2a02f0(0x16d)]),{name:_0x56d1e9}=_0x1530dc;let _0x37f020=await extractAccountAndWorkerNumber({'poolWorkers':_0x1c399c});_0x320208[_0x2a02f0(0x18d)]++;!_0x37f020&&(console['warn'](_0x2a02f0(0x201)+_0x26fa6b+_0x2a02f0(0x1b4)+_0x3e3b54),_0x37f020={'accountName':'unknown','workerName':_0x2a02f0(0x1a3),'workerTypeNumber':0x1});const {accountName:_0x25d3b8,workerName:_0x28eb14,workerTypeNumber:_0x161e79}=_0x37f020;console[_0x2a02f0(0x162)]('Discovered\x20miner\x20'+_0x28eb14+_0x2a02f0(0x105)+_0x25d3b8+_0x2a02f0(0x192)+_0x26fa6b+_0x2a02f0(0x1ce)+_0x3e3b54);const _0x3d852a={'workerTypeNumber':_0x161e79,'workerName':_0x28eb14,'accountName':_0x25d3b8};!_0x186e8d[_0x2a02f0(0xc6)]&&_0x186e8d[_0x2a02f0(0x17c)]!==_0x186e8d['modelType']&&(_0x186e8d[_0x2a02f0(0xc6)]='temp_Antminer_updater');const {enablePoolConfiguration:_0x43b483,enableUpdatePoolOnDiscovery:_0x1f3866}=dataCenterSettings,_0x350bc2=_0x43b483&&_0x1f3866,_0x3c3858=!![];let _0x1104fd=await getMinerInfo({'macAddress':_0x3e3b54,'accountName':_0x25d3b8,'workerName':_0x28eb14,'ipAddress':_0x26fa6b});if(_0x1104fd&&!_0x1104fd?.[_0x2a02f0(0x217)]?.['rack']){const _0x3819a6=_0x5d857f(_0x1104fd,dataCenterSettings);_0x3d852a[_0x2a02f0(0x217)]=_0x3819a6;}let _0x14e62f=await configureMiner({'minerSystemInfo':_0x186e8d,'workerProperties':_0x3d852a,'minerInfo':_0x1104fd,'minerConfigOptions':null,'shouldConfigurePools':_0x350bc2,'isBulk':_0x3c3858})[_0x2a02f0(0x1c5)](_0x4e525e=>{const _0x14f21b=_0x2a02f0;let _0x13d3f0='';return _0x4e525e[_0x14f21b(0x1db)]&&_0x4e525e[_0x14f21b(0x1db)][_0x14f21b(0x168)]&&(_0x13d3f0+=';\x20'+_0x4e525e[_0x14f21b(0x1db)][_0x14f21b(0x168)]),!/ETIMEDOUT/['test'](_0x4e525e[_0x14f21b(0x1f4)])?(_0x13d3f0='discoverMiners\x20error:'+_0x4e525e[_0x14f21b(0x1f4)]+_0x13d3f0,console[_0x14f21b(0x149)](_0x13d3f0,_0x186e8d,_0x4e525e)):(_0x13d3f0=_0x14f21b(0x12b)+_0x13d3f0,console['warn'](_0x13d3f0,_0x4e525e[_0x14f21b(0x219)])),null;});!_0x14e62f&&(_0x14e62f={'action':_0x2a02f0(0x205),'status':_0x2a02f0(0x1fe)});!_0x320208[_0x2a02f0(0x205)][_0x14e62f['action']]&&(_0x320208[_0x2a02f0(0x205)][_0x14e62f[_0x2a02f0(0x1d4)]]={});const _0x153c15=_0x320208[_0x2a02f0(0x205)][_0x14e62f[_0x2a02f0(0x1d4)]];!_0x153c15[_0x14e62f[_0x2a02f0(0xdb)]]&&(_0x153c15[_0x14e62f['status']]={'count':0x0,'ipAddresses':[],'miners':[]});const _0x583093=_0x153c15[_0x14e62f[_0x2a02f0(0xdb)]];return _0x583093[_0x2a02f0(0xb4)]++,_0x583093[_0x2a02f0(0xe4)][_0x2a02f0(0x1bb)](_0x186e8d[_0x2a02f0(0xe3)]),_0x583093['miners'][_0x2a02f0(0x1bb)]({'ipAddress':_0x186e8d[_0x2a02f0(0xe3)],'macAddress':_0x186e8d[_0x2a02f0(0x129)]}),_0x186e8d;}const {getWorkerNumber:_0x106436,getPlacement:_0x5d857f}=getPlugin(_0x52c2f9(0x14d)),_0x320208={'count':0x0,'sysInfo':0x0,'settingsInfo':0x0,'configure':{},'attempted':0x0,'startTime':Date[_0x52c2f9(0x183)]()};let _0x2e4d20=promiseLimit(0xa);return dataCenterSettings[_0x52c2f9(0x152)]=CONFIGURE_MODE_DISCOVERY,dataCenterSettings[_0x52c2f9(0x14e)](),console[_0x52c2f9(0x162)](_0x52c2f9(0x21a)+(dataCenterSettings[_0x52c2f9(0x187)]?_0x52c2f9(0x121):_0x52c2f9(0x1d7))),scanForMinerVersions(_0x4e7de1||dataCenterSettings[_0x52c2f9(0x190)],_0x5bcc50,_0x19051f)[_0x52c2f9(0x1c5)](_0x33c771=>{const _0x976e34=_0x52c2f9;console[_0x976e34(0x149)](_0x976e34(0x1c0),_0x33c771);throw _0x33c771;})[_0x52c2f9(0x128)](_0x5a9833=>{const _0x159814=_0x52c2f9,{stats:_0x7381b,minerVersions:_0x3a0b5f}=_0x5a9833;return _0x320208[_0x159814(0x173)]=_0x7381b,_0x320208[_0x159814(0xb4)]=_0x3a0b5f[_0x159814(0x1ca)],console[_0x159814(0x162)]('Discover\x20started',_0x320208,_0x4e7de1),_0x320208['discoverStartTime']=Date[_0x159814(0x183)](),Promise[_0x159814(0xf3)](_0x3a0b5f[_0x159814(0x1fa)](_0xcf17ad=>{return _0x2e4d20(()=>_0x1564bf(_0xcf17ad));}));})[_0x52c2f9(0x128)](_0x32d996=>{const _0x312e3b=_0x52c2f9;return dataCenterSettings[_0x312e3b(0x152)]=CONFIGURE_MODE_DETECT,dataCenterSettings[_0x312e3b(0x14e)](),_0x320208[_0x312e3b(0xfc)]=Date['now'](),_0x320208[_0x312e3b(0xe1)]={'timespan':_0x320208['discoverStartTime']-_0x320208[_0x312e3b(0xb5)],'count':_0x320208['count']+_0x320208['scanStats'][_0x312e3b(0x1fe)],'rate':Math['floor']((_0x320208['count']+_0x320208[_0x312e3b(0x173)][_0x312e3b(0x1fe)])/((_0x320208[_0x312e3b(0x13a)]-_0x320208[_0x312e3b(0xb5)])/0x2710))/0xa+_0x312e3b(0x210)},_0x320208[_0x312e3b(0xe9)]={'timespan':_0x320208[_0x312e3b(0xfc)]-_0x320208[_0x312e3b(0x13a)],'count':_0x320208[_0x312e3b(0xb4)],'rate':Math[_0x312e3b(0x1e0)](_0x320208[_0x312e3b(0xb4)]/((_0x320208[_0x312e3b(0xfc)]-_0x320208[_0x312e3b(0x13a)])/0x2710))/0xa+'\x20miners/sec'},console['log']('Discover\x20statistics',inspect(_0x320208,![],0x5,!![])),{'stats':_0x320208,'minerVersions':_0x32d996};})[_0x52c2f9(0x1c5)](_0x3008c4=>{const _0x22327f=_0x52c2f9;dataCenterSettings[_0x22327f(0x152)]=CONFIGURE_MODE_DETECT,dataCenterSettings[_0x22327f(0x14e)](),console[_0x22327f(0x149)](_0x22327f(0x19b),inspect(_0x3008c4,![],0x5,!![]));throw _0x3008c4;});}let availableFreqs={};function getOptimumClockSettings(_0x58fad1,_0x373aaa,_0x229d8b,_0x3de856){const _0x30a827=_0x187b5b;let _0x33fd9b=0x0,{scales:_0x5a1612,softwareVersions:_0x8f226f}=_0x229d8b[_0x30a827(0x1eb)]||{},{clockFrequencyCap:_0xb6dd0}=_0x58fad1,_0x504ad8=_0x5a1612&&_0x8f226f&&_0x8f226f[_0x30a827(0x141)](_0x58fad1['softwareVersion']),_0x4eec3d={'frequency':0x0,'volts':0x0,'hashRateBump':0x0};if(!_0x504ad8)return _0x4eec3d;const {frequencies:_0x28ee96,voltages:_0x1bf52f,hashRateBumps:_0x1fe9e1}=_0x5a1612;!availableFreqs[_0x229d8b[_0x30a827(0x110)]]&&(availableFreqs[_0x229d8b[_0x30a827(0x110)]]={},_[_0x30a827(0x1fa)](_0x28ee96,(_0x401b16,_0x685524)=>{const _0x4035f3=_0x30a827;availableFreqs[_0x229d8b[_0x4035f3(0x110)]][_0x401b16]={'index':_0x685524,'frequency':_0x401b16};}));const _0x3be31d=availableFreqs[_0x229d8b[_0x30a827(0x110)]],_0x5df45f=parseInt(_0x373aaa[_0x30a827(0x184)]);console[_0x30a827(0x197)](_0x30a827(0x14c)+_0x58fad1[_0x30a827(0x15b)]+_0x30a827(0xff)+_0x5df45f+_0x30a827(0x19c)+_0xb6dd0+_0x30a827(0x1c4)+_0x3de856);let _0x2fe61b=(_0x3be31d[_0x5df45f]||{})['index'];!_0x2fe61b&&(_0x2fe61b=_0x28ee96['findIndex'](_0x4169f3=>_0x4169f3>=_0x5df45f),!_0x2fe61b&&(_0x2fe61b=parseInt(_0x28ee96[_0x30a827(0x1ca)]/0x2,0xa)));const _0x264434=_0x3de856*0x1;let _0xc19b09=_0x2fe61b+_0x264434;if(_0xc19b09<0x0)_0xc19b09=0x0;else _0xc19b09>=_0x28ee96[_0x30a827(0x1ca)]&&(_0xc19b09=_0x28ee96[_0x30a827(0x1ca)]-0x1);_0x33fd9b=_0x28ee96[_0xc19b09];if(_0xb6dd0&&parseInt(_0x33fd9b)>=_0xb6dd0)return _0x4eec3d;return{'frequency':_0x33fd9b,'volts':_0x1bf52f[_0xc19b09],'hashRateBump':!_0x1fe9e1?0x0:_0x1fe9e1[_0xc19b09]};}function intAdder(_0x4ecb7b,_0x1d0f7a){return parseInt(_0x4ecb7b||0x0)+parseInt(_0x1d0f7a||0x0);};function trackTrends(_0x2c1ac4,_0x395d77=new Date(),_0x6544df){const _0xe66194=_0x187b5b;(!_0x2c1ac4[_0xe66194(0xcf)]||_0x2c1ac4[_0xe66194(0xcf)][_0xe66194(0x206)])&&(_0x2c1ac4[_0xe66194(0xcf)]={'lastEvent':{},'fine':[],'minutes':[],'hourly':[],'daily':[],'monthly':[],'yearly':[]});!_0x6544df&&(_0x6544df=Date[_0xe66194(0x1a7)](new Date())['toString']());const {hashRate:hashRate=0x0,accepted:accepted=0x0,rejected:rejected=0x0,elapsed:elapsed=0x0,sharesPerMinute:sharesPerMinute=0x0,hardwareErrors:hardwareErrors=[0x0],frequency:_0x167f8e,volts:_0x1fd279,temperatures:temperatures=[0x0],consumption:consumption=0x0}=_0x2c1ac4[_0xe66194(0x166)];var _0x5b3b8a=isNaN(elapsed)||elapsed<0x1?0x1:elapsed;const _0x264dbe=(!hardwareErrors[_0xe66194(0xba)]?hardwareErrors||0x0:hardwareErrors['reduce'](intAdder,0x0))/_0x5b3b8a,_0x197177={'elapsed':elapsed,'hashRate':parseInt(hashRate),'accepted':accepted,'rejected':rejected,'shares':parseInt(sharesPerMinute),'frequency':parseInt(_0x167f8e),'volts':parseInt(_0x1fd279),'tempAvg':parseInt(Math['avg'](temperatures)),'tempHot':Math['max'](...temperatures),'power':consumption,'x':Date[_0xe66194(0x1a7)](_0x395d77),'syncId':_0x6544df,'errorRate':_0x264dbe},{trends:_0x54d232,updated:_0x1cb333}=updateTrendTracking(_0x2c1ac4[_0xe66194(0xcf)],_0x395d77,_0x197177,_0x2c1ac4,[_0xe66194(0x184),_0xe66194(0xb9),'elapsed','tempAvg',_0xe66194(0x18e)]);return _0x54d232;}function rollupTrendPoints(_0x3415b1,_0x358781,_0x4e0d5a,_0x2b3208,_0x470608){const _0x44b35d=_0x187b5b;let _0x5a7174={};const _0x42f832={'fine':{'count':0x1,'millis':timeSlotPeriod*0x3c*0x3e8,'sliceSize':CHART_TREND_HISTORY_COUNT},'minutes':{'count':0x3c/timeSlotPeriod,'millis':0x3c*0x3c*0x3e8,'sliceSize':CHART_TREND_HISTORY_COUNT},'hourly':{'count':0x18,'millis':0x18*0x3c*0x3c*0x3e8,'sliceSize':CHART_TREND_HISTORY_COUNT},'daily':{'count':0x1e,'millis':0x1e*0x18*0x3c*0x3c*0x3e8,'sliceSize':CHART_TREND_HISTORY_COUNT},'monthly':{'count':0xc,'millis':0x16d*0x18*0x3c*0x3c*0x3e8,'sliceSize':CHART_TREND_HISTORY_COUNT}},{count:_0x4483d3,millis:_0x3bfb1d,sliceSize:_0x59086b}=_0x42f832[_0x4e0d5a],_0x11dda6=Object[_0x44b35d(0x1c6)](_0x3415b1[0x0]),_0x12e58c=_0x3415b1[_0x44b35d(0x12a)](-_0x4483d3);if(_0x12e58c['length']==0x1)_0x5a7174={..._0x12e58c[0x0]};else{_0x11dda6[_0x44b35d(0x1cf)](_0x24e038=>{const _0x206e14=_0x44b35d,_0x29cf98=_0x2b3208[_0x206e14(0x138)](_0x24e038)!=-0x1;_0x29cf98?_0x5a7174[_0x24e038]=_0x12e58c[_0x206e14(0xba)]((_0x52851b,_0x224c7f)=>Math[_0x206e14(0x215)](_0x52851b,_0x224c7f[_0x24e038]),0x0):_0x5a7174[_0x24e038]=(_0x12e58c[_0x206e14(0xba)]((_0x11c799=0x0,_0x4f4ef6)=>_0x11c799+(_0x4f4ef6[_0x24e038]||0x0),0x0)/_0x12e58c[_0x206e14(0x1ca)])[_0x206e14(0xf8)](0x3),_0x5a7174[_0x24e038]>0x64&&(_0x5a7174[_0x24e038]=parseInt(_0x5a7174[_0x24e038]));});const _0x541318=_0x12e58c[_0x44b35d(0x12a)](-0x1)[0x0]['x'];_0x5a7174['x']=_0x541318-_0x541318%_0x3bfb1d;}const _0x1c579a=_0x5a7174['x'];if(!_0x358781[_0x44b35d(0x1ca)]){const _0x5c9a3e={..._0x5a7174};_0x358781[_0x44b35d(0x1bb)](_0x5c9a3e);}else while(_0x358781[_0x358781['length']-0x1]['x']<_0x1c579a){const _0x4921b5={..._0x5a7174},_0x35fd70=_0x358781[_0x358781['length']-0x1]['x'];_0x4921b5['x']=_0x35fd70-_0x35fd70%_0x3bfb1d+_0x3bfb1d,_0x358781['push'](_0x4921b5);}return console[_0x44b35d(0x197)](_0x470608,_0x44b35d(0x19d),_0x12e58c,_0x5a7174),_0x358781[_0x44b35d(0x1ca)]>_0x59086b&&_0x358781['splice'](0x0,_0x358781[_0x44b35d(0x1ca)]-_0x59086b),_0x3415b1[_0x44b35d(0x1ca)]>_0x59086b&&_0x3415b1[_0x44b35d(0x211)](0x0,_0x3415b1[_0x44b35d(0x1ca)]-_0x59086b),_0x12e58c;}function updateTrendTracking(_0x59de34,_0x2ccde3,_0x3f9b2a={},_0x424782,_0x2eea43){const _0x301f66=_0x187b5b,_0x1add10=_0x2ccde3['getFullYear'](),_0xaaf5e=_0x2ccde3[_0x301f66(0x13f)](),_0x5a9539=_0x2ccde3[_0x301f66(0xe2)](),_0x33e89a=_0x2ccde3[_0x301f66(0x182)](),_0x53c08d=_0x2ccde3[_0x301f66(0x1af)](),_0x5a14f9={};let {fine:fine=[],hourly:hourly=[],minutes:minutes=[],daily:daily=[],monthly:monthly=[],yearly:yearly=[]}=_0x59de34;const {minute:_0x275163,hour:_0xfc6664,day:_0x4f6531,month:_0xa37a6,year:_0x531d34}=_0x59de34[_0x301f66(0x17a)],_0x41494a=_0x275163!==_0x53c08d&&fine['length'],_0x20b623=_0xfc6664!==_0x33e89a&&minutes[_0x301f66(0x1ca)],_0x2e110d=_0x4f6531!==_0x5a9539&&hourly[_0x301f66(0x1ca)],_0xc5d21a=_0xa37a6!==_0xaaf5e&&daily[_0x301f66(0x1ca)],_0xd4772e=_0x531d34!==_0x1add10&&monthly[_0x301f66(0x1ca)];return _0x59de34[_0x301f66(0x17a)]={'minute':_0x53c08d,'hour':_0x33e89a,'day':_0x5a9539,'month':_0xaaf5e,'year':_0x1add10},_0xd4772e&&(rollupTrendPoints(monthly,yearly,_0x301f66(0xc0),_0x2eea43,_0x424782),_0x5a14f9[_0x301f66(0xc0)]=_0x5a14f9['yearly']=!![]),_0xc5d21a&&(rollupTrendPoints(daily,monthly,'daily',_0x2eea43,_0x424782),_0x5a14f9[_0x301f66(0x155)]=_0x5a14f9[_0x301f66(0xc0)]=!![]),_0x2e110d&&(rollupTrendPoints(hourly,daily,_0x301f66(0x169),_0x2eea43,_0x424782),_0x5a14f9[_0x301f66(0x169)]=_0x5a14f9['daily']=!![]),_0x20b623&&(rollupTrendPoints(minutes,hourly,_0x301f66(0x148),_0x2eea43,_0x424782),_0x5a14f9[_0x301f66(0x148)]=_0x5a14f9[_0x301f66(0x169)]=!![]),_0x59de34[_0x301f66(0x193)][_0x301f66(0x1bb)](_0x3f9b2a),_0x41494a&&rollupTrendPoints(fine,minutes,_0x301f66(0x193),_0x2eea43,_0x424782),{'trends':_0x59de34,'updated':_0x5a14f9};}let kilowattsConsumed=0x0,minerCheckCompleted=!![];const SITE_STATE_NORMAL=0x1,SITE_STATE_OUTAGE=0x2,SITE_STATE_UNKNOWN=0x3,getTempStateName=function(_0x25a47c,_0x3684b6){const _0x1e2ddb=_0x187b5b;_0x3684b6=_0x3684b6||{'hot':0x5a,'warm':0x50,'mild':0x46};if(_0x25a47c>=_0x3684b6[_0x1e2ddb(0xbe)])return'hot';else{if(_0x25a47c>=_0x3684b6[_0x1e2ddb(0xdd)])return _0x1e2ddb(0xdd);else{if(_0x25a47c>=_0x3684b6[_0x1e2ddb(0xce)])return _0x1e2ddb(0xce);else{if(_0x25a47c==0x0)return'dead';}}}return _0x1e2ddb(0x130);};async function syncMinerStatusJob(_0x10e8b0,_0x54c170,_0x5d18e7=![]){const _0x295322=_0x187b5b;let {ipAddress:_0x3d50fa,workerName:_0xf0e435,accountName:_0x13ccae,macAddress:_0x480cc4,placement:_0x560aea}=_0x10e8b0,_0x38f605=getMinerTypeMap(_0x10e8b0),_0x5eaab1=deriveApiVersion({'minerInfo':_0x10e8b0,'minerTyped':_0x38f605});const {name:_0x305911,code:_0x35fef1,version:_0x16761f,model:_0x410c20,brand:_0x5f38ff}=_0x38f605;Object[_0x295322(0xb8)](_0x10e8b0,{'name':_0x305911,'code':_0x35fef1,'version':_0x16761f,'model':_0x410c20,'brand':_0x5f38ff});if(isBatchOperation||!_0x3d50fa)return!![];let _0x284d2c=await getMinerSystemInfo({'ipAddress':_0x3d50fa,'minerTyped':_0x38f605,'apiVersion':_0x5eaab1,'maxSockets':0x32})[_0x295322(0x1c5)](_0x7cd0ac=>{const _0x3ba8f0=_0x295322;let _0x295149=_0x3ba8f0(0x1b8)+_0xf0e435+',\x20'+_0x3d50fa+_0x3ba8f0(0xd6)+_0x5eaab1;console[_0x3ba8f0(0x197)](_0x295149,inspect(_0x7cd0ac,![],0x5,!![]),_0x38f605),console[_0x3ba8f0(0x165)](_0x295149);});console[_0x295322(0x197)](_0x295322(0x1ec),inspect(_0x284d2c));_0x284d2c&&(!_0x284d2c[_0x295322(0x17c)]&&(console[_0x295322(0x165)]('getMinerSystemInfo\x20returned\x20undefined\x20minerType',_0x284d2c),delete _0x284d2c[_0x295322(0x17c)],delete _0x284d2c['modelType']),_0x10e8b0=Object[_0x295322(0xb8)](_0x10e8b0,_0x284d2c));let _0x4fd8a4=null,_0x172c53=null,_0x48c8f3=null;_0x5d18e7&&(_0x4fd8a4=await getMinerStatus({'ipAddress':_0x3d50fa,'minerTyped':_0x38f605,'apiVersion':_0x5eaab1,'maxSockets':0xa})[_0x295322(0x1c5)](_0x57f99e=>{const _0x93984e=_0x295322;if(!/ETIMEDOUT/[_0x93984e(0x1e9)](_0x57f99e['message'])){let _0x36732d=_0x93984e(0xfb)+_0xf0e435+',\x20'+_0x3d50fa+'.\x20apiVersion:'+_0x5eaab1;console['debug'](_0x36732d,inspect(_0x57f99e,![],0x5,!![]),_0x38f605),console[_0x93984e(0x165)](_0x36732d);}return null;}),console[_0x295322(0x197)]('Miner\x20status',inspect(_0x4fd8a4)),_0x172c53=await getKernelLogs({'minerInfo':_0x10e8b0,'minerTyped':_0x38f605,'apiVersion':_0x5eaab1,'maxSockets':0xa})['catch'](_0x716d57=>{const _0xdc5976=_0x295322;if(!/ETIMEDOUT/[_0xdc5976(0x1e9)](_0x716d57[_0xdc5976(0x1f4)])){let _0x508917=_0xdc5976(0x1e7)+_0xf0e435+',\x20'+_0x3d50fa+'.\x20apiVersion:'+_0x5eaab1;console[_0xdc5976(0x197)](_0x508917,inspect(_0x716d57,![],0x5,!![]),_0x38f605),console['warn'](_0x508917);}return null;}),console[_0x295322(0x197)](_0x295322(0x20a),inspect(_0x172c53)),dataCenterSettings[_0x295322(0x104)]&&(_0x48c8f3=await retrieveMinerNetworkDiagnostics({'minerInfo':_0x10e8b0,'diagnostic':diagnostic,'minerTyped':_0x38f605,'apiVersion':_0x5eaab1})[_0x295322(0x1c5)](_0x5a1566=>{const _0x21794e=_0x295322;if(!/(404|EHOSTUNREACH|ENOTFOUND)/[_0x21794e(0x1e9)](_0x5a1566[_0x21794e(0x1f4)])){let _0x3b60cc=_0x21794e(0x16c)+_0x10e8b0[_0x21794e(0x15b)]+',\x20'+_0x3d50fa+_0x21794e(0xd6)+_0x5eaab1;console[_0x21794e(0x197)](_0x3b60cc,inspect(_0x5a1566,![],0x5,!![]),_0x38f605),console['warn'](_0x3b60cc);}return null;}),console[_0x295322(0x197)](_0x295322(0x109),inspect(_0x48c8f3))));const {pools:_0x14f15b,cardStatus:_0xb9df39,workerTypeNumber:_0x5c916c,timestamp:_0x33fb47,..._0x5e6a63}=_0x4fd8a4||{'workerName':_0x10e8b0[_0x295322(0x15b)]};console[_0x295322(0x197)]({'logType':_0x295322(0x140)},_0x295322(0x100)+_0xf0e435+_0x295322(0x180)+_0x3d50fa+',\x20liveMinerState\x20('+!!_0x4fd8a4+_0x295322(0x10a)+!!_0x172c53+'),\x20minerSystemInfo('+!!_0x284d2c+_0x295322(0x1b5)+!!_0x10e8b0+_0x295322(0x20b)+!!_0x48c8f3+')'),registerProxy({'workerName':_0xf0e435,'accountName':_0x13ccae,'macAddress':_0x480cc4,'ipAddress':_0x3d50fa,'minerTyped':_0x38f605,'apiVersion':_0x5eaab1});const _0x3b9aae=new Date(),_0x3a173f=Date[_0x295322(0x1a7)](_0x3b9aae);if(!_0x4fd8a4){invalidMiners[_0x480cc4]={'accountName':_0x13ccae,'workerName':_0xf0e435,'ipAddress':_0x3d50fa,'macAddress':_0x480cc4,'placement':_0x560aea},invalidMiners[_0x480cc4][_0x295322(0xdb)]=_0x295322(0xbb),deadMiners[_0x480cc4]=invalidMiners[_0x480cc4];if(!_0x10e8b0[_0x295322(0x166)])_0x10e8b0['condition']={'hashRate':0x0,'hashRateAvg':0x0,'accountName':'','poolName':'','temperatures':[0x0],'frequency':0x0,'pools':[]};else!_0x10e8b0[_0x295322(0x166)][_0x295322(0xed)]&&(_0x10e8b0[_0x295322(0x166)][_0x295322(0x14f)]=0x0,_0x10e8b0[_0x295322(0x166)][_0x295322(0x17f)]=0x0,_0x10e8b0[_0x295322(0x166)][_0x295322(0xed)]=_0x3b9aae);return trackTrends(_0x10e8b0,_0x3b9aae,_0x54c170),{'upsertedMiner':await upsertMinerInfo({'minerInfo':_0x10e8b0}),'state':invalidMiners[_0x480cc4][_0x295322(0xdb)]};}_0x4fd8a4[_0x295322(0xcb)]=_0x3b9aae,_0x4fd8a4[_0x295322(0x139)]=_0x48c8f3||{};let {cardFailureChains:_0x1bcd43,temperatures:_0x214121,intakeSpeed:_0x2ea646,exhaustSpeed:_0x41efc0,..._0xdd414b}=_0x4fd8a4;delete _0xdd414b['cardStatus'];const {condition:_0x1f2ed5,conditionPrime:_0x2c29dc}=_0x10e8b0;!_0x2c29dc&&(_0x10e8b0['conditionPrime']=_0xdd414b);_0x10e8b0[_0x295322(0x119)]=_0x172c53||{};if(!_0x1f2ed5||!_0x1f2ed5['pools'])return _0x10e8b0[_0x295322(0x166)]=_0x4fd8a4,{'upsertedMiner':await upsertMinerInfo({'minerInfo':_0x10e8b0}),'state':_0x295322(0x10b)};trackTrends(_0x10e8b0,_0x3b9aae,_0x54c170);const {poolsAreDifferent:_0x5015d1,remotesPools:_0x58a5e3,poolsConfig:_0x4fb9c9,workerName:_0x39ea4f}=await validateMinerConfig({'minerInfo':_0x10e8b0,'apiVersion':_0x5eaab1,'dataCenterSettings':dataCenterSettings,'isBulk':!![]});if(_0x5015d1){if(_0x10e8b0[_0x295322(0x1d8)]){const {poolIDs:_0xb671f0}=_0x10e8b0;console[_0x295322(0x197)](_0x295322(0x115)+_0xf0e435+_0x295322(0x180)+_0x3d50fa,_0x58a5e3,_0x4fb9c9);}else{let {url:url=_0x295322(0x1a3),user:user='n/a'}=_0x58a5e3['pools'][0x0]||{},{stratum:stratum='n/a',username:username='n/a'}=_0x4fb9c9[_0x295322(0x1a8)][0x0]||{};url=url[_0x295322(0x1cc)](/.*:\/\//,''),stratum=stratum[_0x295322(0x1cc)](/.*:\/\//,''),url==stratum&&user==username?console['debug'](_0x295322(0x1e6)+_0xf0e435+_0x295322(0x180)+_0x3d50fa+_0x295322(0x1ef),_0x39ea4f,_0x58a5e3,_0x4fb9c9):console[_0x295322(0x197)](_0x295322(0xd9)+_0xf0e435+',\x20\x20'+_0x3d50fa+_0x295322(0xde)+user+_0x295322(0x11f)+url+_0x295322(0x195)+username+'\x20@\x20'+stratum);}}const _0x3fed1d=!isNaN(_0x4fd8a4[_0x295322(0x10f)])?parseInt(_0x4fd8a4[_0x295322(0x10f)]):0x0,_0x297129=_0x4fd8a4['hashRateAvg']||0x0,_0x3241ec=_0x4fd8a4['hashRate'],_0x92012b=_0x10e8b0[_0x295322(0x166)][_0x295322(0x14f)]||0x0,_0x555951=_0x10e8b0['condition'][_0x295322(0x1da)];let _0x500bc7=parseInt(_0x10e8b0['conditionPrime'][_0x295322(0x17f)]||0x0);const _0x481d97=_0x10e8b0[_0x295322(0x146)]?parseInt(_0x10e8b0[_0x295322(0x146)]['hashRateAvg']):'-',{intakeFanName:intakeFanName=_0x295322(0x1b1),exhaustFanName:exhaustFanName=_0x295322(0x1b1),minFanSpeed:_0x501a33,tempBoundaries:_0x54638d}=_0x38f605;_0x2ea646=parseInt(_0x4fd8a4[_0x295322(0x186)]||'0',0xa),_0x41efc0=parseInt(_0x4fd8a4[_0x295322(0x123)]||'0',0xa);const _0x24df13=Math[_0x295322(0x1d0)](_0x3241ec/(_0x500bc7||_0x3241ec||0x1)*0x32)*0x2,_0x1523cf=Math[_0x295322(0x1d0)](_0x3241ec/(_0x10e8b0[_0x295322(0xd7)]||_0x3241ec||0x1)*0x64),_0x1892f6=parseInt(_0x3fed1d/0x6)/0xa,_0x551542=_0x1892f6>MINER_BOOT_CHECK_MINUTES,_0x5e987d=_0x10e8b0[_0x295322(0xd2)]?_0x10e8b0['rebootTimes'][_0x295322(0x12a)](-0x1)[0x0]:{},_0x31571f=_0x5e987d[_0x295322(0xcb)]||_0x10e8b0['lastEffectiveHashingTime']||_0x3b9aae,_0x522193=parseInt((_0x3a173f-Date[_0x295322(0x1a7)](_0x31571f))/(0x3c*0x3e8)),_0x5be98b=_0x522193>MINER_BOOT_MAX_MINUTES,_0x569d9f=_0x522193>MINER_LOG_FAILING_MINUTES,_0x48649a=!_0x551542&&_0x1892f6>0x0;let _0x5df987=!_0x551542&&_0x92012b<0x1&&_0x3241ec<0x1&&!_0x41efc0&&!_0x2ea646,_0x17c5d5=![],_0x22c54f=![],_0x30198f=![];_0x5be98b&&!_0x48649a&&(_0x5df987?(_0x17c5d5=!![],_0x5df987=![]):_0x17c5d5=parseInt(_0x3241ec)==parseInt(_0x92012b)&&_0x4fd8a4[_0x295322(0x1da)]==_0x555951||_0x24df13==Infinity,_0x22c54f=_0x1523cf<struggleHighCheckPercent&&_0x24df13<struggleHighCheckPercent,_0x30198f=_0x24df13<failureMinCheckPercent);let _0x72e762=![];if(_0x17c5d5&&_0x10e8b0[_0x295322(0xcc)]&&_0x10e8b0[_0x295322(0xc6)]){const _0x2e3ae1=_0x10e8b0[_0x295322(0xcc)],_0x2faa71=0x2*0x3c*0x3c*0x3e8,_0x58a5f7=Math[_0x295322(0x1d6)](_0x2faa71/dataCenterSettings[_0x295322(0x1aa)]),_0x5d19f0=parseInt((_0x3a173f-Date[_0x295322(0x1a7)](_0x2e3ae1))/dataCenterSettings[_0x295322(0x1aa)]);_0x72e762=_0x5d19f0%_0x58a5f7==0x0;}var _0x4e7f6a=![];if(_0x4fd8a4['rejected']){let _0xde8e93=(_0x4fd8a4[_0x295322(0x1ab)]||0x0)/(_0x4fd8a4[_0x295322(0x1da)]||0x1);_0x4e7f6a=_0xde8e93>MAX_REJECTED_RATE;}let _0x1864ae=(_0x4fd8a4[_0x295322(0x150)]||[0x0])['reduce'](intAdder,0x0),_0x31f1b7=parseInt(_0x1864ae/((_0x4fd8a4[_0x295322(0x10f)]||0x1)/0x3c)),_0x325310=!_0x38f605[_0x295322(0x1eb)]?![]:_0x31f1b7>(_0x38f605[_0x295322(0x1eb)][_0x295322(0x13e)]||MAX_CHIP_ERROR_RATE),_0x13e418=![],_0x57334e=![];if(Array['isArray'](_0x4fd8a4[_0x295322(0x1ea)])&&_0x4fd8a4[_0x295322(0x1ea)][0x0]){let _0x36e895=Math['max'](..._0x4fd8a4['temperatures']||[0x0]);const _0x266299=getTempStateName(_0x36e895,_0x54638d);_0x13e418=/^hot$/i[_0x295322(0x1e9)](_0x266299),_0x57334e=/^(mild|cool)$/i[_0x295322(0x1e9)](_0x266299),_0x4fd8a4[_0x295322(0x1f7)]=_0x266299;}wattsConsumedTally+=isNaN(_0x4fd8a4[_0x295322(0x103)])?0x0:parseFloat(_0x4fd8a4['consumption'],0xa);if(_0x4fd8a4[_0x295322(0x1f5)]&&_0x4fd8a4[_0x295322(0x1f5)][_0x295322(0x1ca)]){}if(!_0x17c5d5&&_0x2ea646<(_0x501a33||MIN_VIABLE_FAN_SPEED)){}if(!_0x17c5d5&&_0x41efc0<(_0x501a33||MIN_VIABLE_FAN_SPEED)){}_0x10e8b0[_0x295322(0x166)]=_0x4fd8a4;_0x4fd8a4[_0x295322(0x189)]&&(_0x10e8b0['accountName']=_0x4fd8a4['accountName']);_0x4fd8a4[_0x295322(0x15b)]&&(_0x10e8b0[_0x295322(0x15b)]=_0x4fd8a4[_0x295322(0x15b)]);_0x4fd8a4[_0x295322(0x1c3)]&&(_0x10e8b0[_0x295322(0x1c3)]=_0x4fd8a4['workerTypeNumber']);if(currentSiteState===SITE_STATE_UNKNOWN){elapsedTally+=_0x3fed1d,++minersScannedCount;if(elapsedTally/minersScannedCount>dataCenterSettings[_0x295322(0x1aa)]/0x1f4)currentSiteState=SITE_STATE_NORMAL;else minersScannedCount>minerCount*0.2&&(initiatePowerRampUp=!![],currentSiteState=SITE_STATE_OUTAGE);}!_0x5be98b&&(_0x500bc7=_0x500bc7*0.8);if(_0x3241ec>_0x500bc7||isNaN(_0x92012b)){const {cardStatus:_0x55d94c,cardFailureChains:_0x1db919,temperatures:_0x5b1e82,intakeSpeed:_0x2d8595,exhaustSpeed:_0x314510,..._0x2c23a0}=_0x4fd8a4;_0x10e8b0['conditionPrime']=_0x2c23a0;const {pools:_0x10fc3d,..._0x254e8b}=_0x2c23a0;if(!_0x10e8b0[_0x295322(0x146)])_0x10e8b0['conditionUltimate']=_0x254e8b;else _0x3241ec>(_0x10e8b0[_0x295322(0x146)]['hashRate']||_0x10e8b0[_0x295322(0x146)]['hashRateAvg']||0x0)&&(_0x10e8b0[_0x295322(0x146)]=_0x254e8b);}const _0x429925={'accountName':_0x13ccae,'workerName':_0xf0e435,'ipAddress':_0x3d50fa,'macAddress':_0x480cc4,'placement':_0x560aea};_0x24df13<0x5&&(deadMiners[_0x480cc4]=_0x429925);let _0x1e4eb5='',_0x3b9b26=![],_0x5763ec=![];if(_0x5df987)_0x1e4eb5=MINER_STATE_BOOTING;else{if(_0x5be98b){if(_0x17c5d5)_0x1e4eb5=MINER_STATE_STALLED;else{if(_0x22c54f)_0x1e4eb5=MINER_STATE_STRUGGLING;else{if(_0x30198f)_0x1e4eb5=MINER_STATE_FAILING;else{if(_0x4e7f6a)_0x1e4eb5=MINER_STATE_REJECTING;else _0x325310&&(_0x1e4eb5=MINER_STATE_ERRORING);}}}_0x3b9b26=_0x22c54f||_0x30198f||_0x17c5d5,_0x5763ec=!!_0x1e4eb5;}else!_0x3b9b26?_0x1e4eb5=MINER_STATE_NORMAL:_0x1e4eb5=MINER_STATE_DEGRADING;}_0x1e4eb5&&(_0x10e8b0[_0x295322(0x13d)]=_0x1e4eb5);let _0x38a799=_0x57334e&&hasAvailablePower&&_0x1892f6>MINER_OC_INTERVAL_MINUTES;const _0x3c119e=!!(_0x38f605[_0x295322(0x1eb)]&&_0x10e8b0[_0x295322(0xc1)]&&(initiatePowerRampUp||_0x325310||_0x13e418||_0x38a799));console['debug'](_0x295322(0x200)+_0x1e4eb5+']\x20'+_0xf0e435+',\x20'+_0x3d50fa+_0x295322(0x117)+_0x24df13+_0x295322(0xd4)+_0x1523cf+'%\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20hasAvailablePower='+hasAvailablePower+_0x295322(0xf7)+_0x5763ec+_0x295322(0x1c2)+_0x3c119e+_0x295322(0x18f)+_0x72e762+_0x295322(0x1ac)+_0x57334e+_0x295322(0xbc)+_0x13e418+_0x295322(0x194)+initiatePowerRampUp+_0x295322(0x14b)+_0x325310+_0x295322(0x102)+_0x551542+',\x20shouldBeHashingByNow='+_0x5be98b+_0x295322(0x1a5)+_0x569d9f+_0x295322(0x114)+_0x17c5d5+_0x295322(0xc8)+_0x22c54f+',\x20isOverRejecting='+_0x4e7f6a+_0x295322(0x1bc)+_0x30198f+_0x295322(0xc4)+_0x1892f6+'m,\x20bootElapsedMinutes='+_0x522193+_0x295322(0x157)+_0x10e8b0[_0x295322(0xed)]+_0x295322(0x131)+_0x10e8b0[_0x295322(0xcc)]);const _0x40f5b6=_0x13ccae+'.'+_0xf0e435+'\x20['+_0x3d50fa+',\x20'+_0x480cc4+_0x295322(0x1b7)+_0x1e4eb5+_0x295322(0x1fd)+_0x1892f6+_0x295322(0xda)+_0x522193+'m.\x20\x20fans:['+_0x2ea646+',\x20'+_0x41efc0+_0x295322(0x10c)+parseInt(_0x3241ec)+',\x20'+_0x500bc7+',\x20'+_0x481d97+'],\x20at:'+_0x24df13+_0x295322(0x1c9)+_0x1523cf+'%';validMiners[_0x480cc4]={'logText':_0x40f5b6,'accountName':_0x13ccae,'workerName':_0xf0e435,'ipAddress':_0x3d50fa,'macAddress':_0x480cc4,'placement':_0x560aea};if(_0x3c119e){delete alertableMiners[_0x480cc4];_0x325310&&(_0x38a799=![]);const _0xf9d3ff=initiatePowerRampUp?-0x9:_0x38a799?0x1:-0x1,_0x3f4e5c=getOptimumClockSettings(_0x10e8b0,_0x4fd8a4,_0x38f605,_0xf9d3ff),{condition:_0x47c8ab,conditionPrime:_0x4c3cf9,clockSettings:_0x5ddb12}=_0x10e8b0,_0x55c29d=_0x47c8ab[_0x295322(0x1a8)]&&_0x47c8ab[_0x295322(0x1a8)]['length']?_0x47c8ab[_0x295322(0x1a8)]:_0x4c3cf9[_0x295322(0x1a8)],_0x1afac4=_0x5ddb12||{},_0x5b23b6=_0x3f4e5c['frequency']&&_0x55c29d&&_0x55c29d[_0x295322(0x1ca)];_0x3f4e5c[_0x295322(0x184)]?console[_0x295322(0x197)](_0x295322(0x198)+_0xf0e435+',\x20'+_0x3d50fa+',\x20power\x20available:\x20'+hasAvailablePower+_0x295322(0xfd)+_0x1892f6+_0x295322(0x1a1)+_0x3f4e5c['frequency']+','+_0x3f4e5c['volts']+_0x295322(0x158)+_0x1afac4[_0x295322(0x184)]+','+_0x1afac4[_0x295322(0xb9)]+'v'):console['debug']('Adjust\x20clock:\x20Keep\x20state\x20for\x20miner\x20'+_0xf0e435+',\x20'+_0x3d50fa+',\x20power\x20available:\x20'+hasAvailablePower+',\x20since\x20'+_0x1892f6+_0x295322(0x216)+_0x1afac4[_0x295322(0x184)]+','+_0x1afac4[_0x295322(0xb9)]+'v');if(_0x5b23b6&&(_0x1afac4[_0x295322(0x184)]!==_0x3f4e5c[_0x295322(0x184)]||_0x1afac4['volts']!==_0x3f4e5c[_0x295322(0xb9)])){const _0x1491f2=_0x3f4e5c,_0xc25373=_['map'](_0x55c29d,(_0xbd9109,_0x2d1178)=>{const _0x483212=_0x295322;return{'index':_0x2d1178+0x1,'stratum':_0xbd9109[_0x483212(0x18a)],'username':_0xbd9109[_0x483212(0x16d)],'password':'x'};});return updateMinerSettings({'minerInfo':_0x10e8b0,'minerTyped':_0x38f605,'pools':_0xc25373,'minerConfigOptions':_0x1491f2,'apiVersion':_0x5eaab1})['then'](async _0x5f4c92=>{const _0x54d09b=_0x295322;if(/\bok\b/i[_0x54d09b(0x1e9)](_0x5f4c92)){_0x10e8b0[_0x54d09b(0x13d)]=MINER_STATE_CLOCKING,console[_0x54d09b(0x162)]('Adjusted\x20miner\x20'+_0xf0e435+',\x20'+_0x10e8b0['ipAddress']+_0x54d09b(0x1f2)+(_0x3f4e5c['frequency']>_0x1afac4[_0x54d09b(0x184)]?'up':_0x54d09b(0x170))+_0x54d09b(0x1c8)+_0x3f4e5c[_0x54d09b(0x184)]+_0x54d09b(0x151)+_0x3f4e5c[_0x54d09b(0xb9)]+_0x54d09b(0x145)+(_0x1afac4['frequency']||0x0)+'M,\x20'+(_0x1afac4['volts']||0x0)+_0x54d09b(0x207)),_0x10e8b0[_0x54d09b(0xf5)]={..._0x1491f2},_0x10e8b0[_0x54d09b(0x167)]=null;const _0x40c05d=!_0x10e8b0[_0x54d09b(0x1ee)]||parseInt(_0x10e8b0[_0x54d09b(0x1ee)])>_0x3f4e5c[_0x54d09b(0x184)];(_0x325310||_0x22c54f)&&_0x40c05d&&(console[_0x54d09b(0x162)]('Adjusting\x20the\x20clocking\x20cap\x20for\x20'+_0xf0e435+_0x54d09b(0x1fb)+_0x10e8b0['clockFrequencyCap']+',\x20to:\x20'+_0x3f4e5c[_0x54d09b(0x184)]),_0x10e8b0[_0x54d09b(0x1ee)]=_0x3f4e5c['frequency']);}else console[_0x54d09b(0x162)](_0x54d09b(0x20d)+_0xf0e435+',\x20'+_0x10e8b0[_0x54d09b(0xe3)]+_0x54d09b(0x15d)+_0x3f4e5c['frequency']+_0x54d09b(0xe8)+_0x3f4e5c[_0x54d09b(0xb9)]);return{'upsertedMiner':await upsertMinerInfo({'minerInfo':_0x10e8b0}),'state':_0x1e4eb5};});}}else{if(_0x72e762){const {firmwareFileName:_0x3a267b}=_0x10e8b0;if(!/updater/[_0x295322(0x1e9)](_0x3a267b))return console[_0x295322(0x162)](_0x295322(0x163)+_0x40f5b6),updateMinerFirmware({'minerInfo':_0x10e8b0,'minerTyped':_0x38f605,'firmwareFileName':_0x3a267b,'apiVersion':_0x5eaab1});else console[_0x295322(0x162)](_0x295322(0x14a)+_0x40f5b6);}else{if(_0x5763ec){if(_0x10e8b0[_0x295322(0x13d)]===MINER_STATE_REBOOTING)console[_0x295322(0x162)](_0x295322(0x172)+_0x40f5b6),_0x10e8b0['runtimeState']=MINER_STATE_BOOTING;else{if(_0x3b9b26){alertableMiners[_0x480cc4]=_0x429925,_0x10e8b0['runtimeState']=MINER_STATE_REBOOTING;!_0x10e8b0[_0x295322(0xd2)]&&(_0x10e8b0[_0x295322(0xd2)]=[]);_0x10e8b0[_0x295322(0xd2)][_0x295322(0x1ca)]>0x14&&_0x10e8b0[_0x295322(0xd2)]['shift']();_0x10e8b0[_0x295322(0x167)]=null,_0x10e8b0[_0x295322(0xd2)]['push']({'reason':_0x1e4eb5,'timestamp':_0x3b9aae,'percentOfPrime':_0x24df13,'liveHashRate':_0x3241ec,'liveHashRateAvg':_0x297129}),console['log']('Rebooting\x20'+_0x40f5b6);const _0x5b88f1=upsertMinerInfo({'minerInfo':_0x10e8b0})[_0x295322(0x128)](()=>getMinerReboot(_0x10e8b0,_0x38f605,_0x5eaab1));return{'upsertedMiner':_0x5b88f1,'state':_0x10e8b0[_0x295322(0x13d)]};}else console[_0x295322(0x197)](_0x295322(0x209)+_0x40f5b6),console[_0x295322(0x162)](_0x295322(0x209)+_0x13ccae+'.'+_0xf0e435+'\x20['+_0x3d50fa+',\x20'+_0x480cc4+']\x20in\x20'+_0x1e4eb5);}}else{if(_0x1e4eb5&&_0x10e8b0['runtimeState']!==MINER_STATE_NORMAL)alertableMiners[_0x480cc4]=_0x429925,alertableMiners[_0x480cc4][_0x295322(0xdb)]=_0x1e4eb5,_0x569d9f&&(console[_0x295322(0x162)](_0x295322(0x1a0)+_0x40f5b6),console[_0x295322(0x197)](_0x295322(0xd0)+_0x1e4eb5+'\x20miner\x20state\x20:'+inspect(_0x5e6a63)));else return _0x10e8b0['lastEffectiveHashingTime']=_0x3b9aae,delete alertableMiners[_0x480cc4],{'upsertedMiner':await upsertMinerInfo({'minerInfo':_0x10e8b0}),'state':_0x1e4eb5};}}}return{'upsertedMiner':await upsertMinerInfo({'minerInfo':_0x10e8b0}),'state':_0x1e4eb5};}let hasAvailablePower=0x0,wattsConsumedTally=0x0,elapsedTally=0x0,minersScannedCount=0x0,initiatePowerRampUp=![],currentSiteState=SITE_STATE_NORMAL,minerCount=0x0,deadMiners={};async function compareMinerStatus(_0x211829,_0x3a6fa6,_0x5e72ac){const _0xf4bbf8=_0x187b5b,_0x24254d=loopback[_0xf4bbf8(0x1e8)](_0xf4bbf8(0xf2)),{availableKilowatts:availableKilowatts=0x0,powerRampUpDisabled:powerRampUpDisabled=![],configureMode:_0xb68d4e}=dataCenterSettings;!kilowattsConsumed&&(kilowattsConsumed=availableKilowatts);hasAvailablePower=!availableKilowatts||availableKilowatts>kilowattsConsumed,wattsConsumedTally=0x0,elapsedTally=0x0,minersScannedCount=0x0,initiatePowerRampUp=![],currentSiteState=powerRampUpDisabled?SITE_STATE_NORMAL:SITE_STATE_UNKNOWN,deadMiners={};let _0x90435f=Date[_0xf4bbf8(0x183)](),_0x57fa52={};if(_0x211829){const {range:_0x24be81}=_0x211829,_0x4a7984=getIPRange(_0x24be81[0x0],_0x24be81[0x1]);_0x57fa52={'where':{'ipAddress':{'inq':_0x4a7984}}};}const _0x58671d=await _0x24254d[_0xf4bbf8(0x214)](_0x57fa52),_0x32f40c=_0x58671d[_0xf4bbf8(0x1fa)](_0x23ba9c=>_0x23ba9c['ipAddress']),_0x57ca1a=await getScanCache(_0x211829||dataCenterSettings[_0xf4bbf8(0x190)],_0x3a6fa6,_0x5e72ac,_0x32f40c);if(_0xb68d4e===CONFIGURE_MODE_PROVISION){console[_0xf4bbf8(0x162)]('Miner\x20status\x20check\x20skipped\x20during\x20'+(_0xb68d4e==CONFIGURE_MODE_DISCOVERY?'discovery':_0xf4bbf8(0x15e))+'.');return;}if(!minerCheckCompleted){console[_0xf4bbf8(0x162)](_0xf4bbf8(0x178)),minerCheckCompleted=!![];return;}minerCheckCompleted=![],minerCount=_0x58671d[_0xf4bbf8(0x1ca)];const _0x51e962=Date[_0xf4bbf8(0x1a7)](new Date())[_0xf4bbf8(0x161)]();console['log']('Miner\x20status\x20check\x20started\x20for\x20'+minerCount+_0xf4bbf8(0x212)+kilowattsConsumed[_0xf4bbf8(0x160)]()+_0xf4bbf8(0xe0)+availableKilowatts[_0xf4bbf8(0x160)]()+_0xf4bbf8(0x15a));const _0x5da477={'skipped':[],'live':[]},_0x234d8a=0x64;while(_0x58671d[_0xf4bbf8(0x1ca)]){await Promise[_0xf4bbf8(0xf3)](_0x58671d[_0xf4bbf8(0x211)](0x0,_0x234d8a)[_0xf4bbf8(0x1fa)](async _0x4e7ca6=>{const _0x43b1f4=_0xf4bbf8;let {ipAddress:_0x359b76}=_0x4e7ca6;const _0x4f9307=!_0x359b76||!!_0x57ca1a[_0x359b76],{upsertedMiner:_0x20e8bf,state:_0x1668d7}=await syncMinerStatusJob(_0x4e7ca6,_0x51e962,_0x4f9307);console['debug'](_0x43b1f4(0x154)+_0x1668d7+_0x43b1f4(0x147)+(_0x20e8bf?.[_0x43b1f4(0xe3)]||_0x359b76)),_0x20e8bf?(!_0x5da477[_0x1668d7]&&(_0x5da477[_0x1668d7]=[]),_0x5da477[_0x1668d7||_0x43b1f4(0x159)][_0x43b1f4(0x1bb)](_0x20e8bf?.[_0x43b1f4(0xe3)])):_0x5da477['skipped'][_0x43b1f4(0x1bb)](_0x359b76);})),console[_0xf4bbf8(0x197)](_0xf4bbf8(0x1b2)+_0x234d8a+'.\x20'+_0x58671d[_0xf4bbf8(0x1ca)]+_0xf4bbf8(0x191));};Object[_0xf4bbf8(0x1c6)](_0x5da477)[_0xf4bbf8(0x1cf)](_0x20aa83=>{const _0x3768dc=_0xf4bbf8;_0x5da477[_0x20aa83][_0x3768dc(0x1b0)](ipDesc);});if(!_0x5da477)return;const _0x33743a=function(_0x43c412){const _0xd8d475=_0xf4bbf8;reportedDates[_0x43c412[_0xd8d475(0x129)]]&&reportedDates[_0x43c412['macAddress']]<Date[_0xd8d475(0x183)]()-notifyTime&&(reportedDates[_0x43c412['macAddress']]=null);if(!reportedDates[_0x43c412['macAddress']])return!![];};let _0x283355=_[_0xf4bbf8(0x111)](_[_0xf4bbf8(0x12e)](invalidMiners,_0x33743a),['accountName','workerName']),_0x2228e7=_['sortBy'](_['filter'](alertableMiners,_0x33743a),[_0xf4bbf8(0x189),_0xf4bbf8(0x15b)]),_0x3e4d8e=_[_0xf4bbf8(0x111)](_[_0xf4bbf8(0x12e)](deadMiners,_0x33743a),(_0xd9263a={})=>{const _0x597e40=_0xf4bbf8,{hall:_0x53ac3b,rack:_0xf4c8ca,shelf:_0xc74935,position:_0x45e41d}=_0xd9263a[_0x597e40(0x217)]||{};return[_0x53ac3b,_0xf4c8ca,_0xc74935,_0x45e41d];}),_0x324221='';const _0x5c324e=(_0x57af3f,_0x3e87a4)=>{const _0x802f51=_0xf4bbf8;_0x3e87a4&&(_0x57af3f[_0x802f51(0x166)]={});const {accountName:_0x1ff871,workerName:_0x33ec39,ipAddress:_0x46cccf,macAddress:_0x2d082c}=_0x57af3f;reportedDates[_0x2d082c]=Date['now']();const {hall:_0x20792d,rack:_0xf455b6,shelf:_0xf43683,position:_0x428032}=_0x57af3f[_0x802f51(0x217)]||{};return _0x1ff871+'.'+_0x33ec39+'\x20at\x20'+_0x20792d+'.'+_0xf455b6+'.'+_0xf43683+'.'+_0x428032+_0x802f51(0x17e)+_0x46cccf+')';};_0x283355[_0xf4bbf8(0x1ca)]&&(_0x324221+='\x0a['+dataCenterSettings[_0xf4bbf8(0xea)]+']\x20'+_0x283355[_0xf4bbf8(0x1ca)]+_0xf4bbf8(0x1e5)+dataCenterSettings[_0xf4bbf8(0xec)]+'.\x0a',_0x324221+=_[_0xf4bbf8(0x1fa)](_0x283355,_0x1d7c1d=>_0x5c324e(_0x1d7c1d,!![]))[_0xf4bbf8(0x16e)]('\x0a'));_0x2228e7[_0xf4bbf8(0x1ca)]&&(_0x324221+='\x0a['+dataCenterSettings[_0xf4bbf8(0xea)]+']\x20'+_0x2228e7[_0xf4bbf8(0x1ca)]+_0xf4bbf8(0xef)+dataCenterSettings[_0xf4bbf8(0xec)]+'.\x0a',_0x324221+=_[_0xf4bbf8(0x1fa)](_0x2228e7,_0x4df7d9=>_0x5c324e(_0x4df7d9))[_0xf4bbf8(0x16e)]('\x0a'));if(_0x3e4d8e['length']>minerCount*(dataCenterSettings[_0xf4bbf8(0x208)]||0x2)/0x64){let _0x2995dd=dataCenterSettings['locationName']+'.\x20'+_0x3e4d8e[_0xf4bbf8(0x1ca)]+_0xf4bbf8(0x175);_0x324221=_[_0xf4bbf8(0xba)](_0x3e4d8e,(_0xc1a6b5,_0x58b987={})=>{const _0xb283fa=_0xf4bbf8,{hall:hall='',rack:rack='',shelf:shelf='',position:position=''}=_0x58b987[_0xb283fa(0x217)]||{};var _0x32615b=hall+'.'+rack+'.'+shelf+'.'+position;return _0x32615b[_0xb283fa(0x1ca)]<=0x4&&(_0x32615b=_0xb283fa(0x17b)),_0xc1a6b5+(_0x32615b+'\x09'+_0x58b987[_0xb283fa(0x15b)]+'\x0d');},'\x0d'),await offlineMiners({'subject':_0x2995dd,'text':_0x324221})[_0xf4bbf8(0x1c5)](_0x24e112=>{const _0x3fb7a4=_0xf4bbf8;console[_0x3fb7a4(0x149)](_0x3fb7a4(0x181),_0x24e112);})[_0xf4bbf8(0x128)](_0x23f3d9=>{const _0x4e309b=_0xf4bbf8;console[_0x4e309b(0x162)](_0x4e309b(0xf0),_0x23f3d9);},_0x2981c5=>{const _0x22714f=_0xf4bbf8;console[_0x22714f(0x149)](_0x2981c5);});}let _0x511508=parseInt(Math[_0xf4bbf8(0x1d0)]((Date[_0xf4bbf8(0x183)]()-_0x90435f)/0x64))/0xa;kilowattsConsumed=parseInt(wattsConsumedTally/0x3e8);const _0x436573=_0xf4bbf8(0xf4)+minerCount+'\x20miners\x20in\x20'+_0x511508+_0xf4bbf8(0x11e)+kilowattsConsumed[_0xf4bbf8(0x160)]()+'\x20/\x20'+availableKilowatts[_0xf4bbf8(0x160)]()+'\x20kw';return console[_0xf4bbf8(0x162)](_0x436573),slackMessage({'text':_0x324221}),socketSendMiners(_0x5da477),minerCheckCompleted=!![],{'message':_0x436573,'minerInfoUpserts':_0x5da477,'invalids':_0x283355,'alertables':_0x2228e7,'deadones':_0x3e4d8e,'validMiners':validMiners,'text':_0x324221};}function socketSendMiners(_0x217101,_0x33a0e0){const _0x1f54f9=_0x187b5b;let _0x20c2a1=_['map'](_0x217101,(_0x3213c2={})=>{const _0x2a936d=_0x2130;if(!_0x3213c2||!_0x3213c2[_0x2a936d(0xc7)])return{};const {name:_0x262c16,minerType:_0x53d5af,ipAddress:_0x99fba9,macAddress:_0x3c9ff6,placement:_0x4e43e2,accountName:_0x421894,workerName:_0x29349a,condition:_0x3db376,conditionPrime:_0x46a595,deployments:_0x27ab83,systemLogicVersion:_0xab6b07,serialNumber:_0x64f846,psuSerialNumber:_0x47b55d,psuModel:_0x1c7e99,networkSwitchRef:_0x3f7b3a,breakerPanelId:_0x4b8367,powerBarId:_0x522143,powerPhase:_0x2af357,transformerLow:_0x496567,transformerMed:_0x501664}=_0x3213c2;let _0x4e710a={'name':_0x262c16,'minerType':_0x53d5af,'ipAddress':_0x99fba9,'macAddress':_0x3c9ff6,'placement':_0x4e43e2,'accountName':_0x421894,'workerName':_0x29349a,'condition':_0x3db376,'conditionPrime':_0x46a595,'deployments':_0x27ab83,'systemLogicVersion':_0xab6b07,'serialNumber':_0x64f846,'psuSerialNumber':_0x47b55d,'psuModel':_0x1c7e99,'networkSwitchRef':_0x3f7b3a,'breakerPanelId':_0x4b8367,'powerBarId':_0x522143,'powerPhase':_0x2af357,'transformerLow':_0x496567,'transformerMed':_0x501664};return _0x3213c2[_0x2a936d(0x17c)]&&minerTypeMap[_0x53d5af]&&(_0x4e710a[_0x2a936d(0x1ed)]=minerTypeMap[_0x53d5af]),_0x4e710a[_0x2a936d(0x13b)]=_0x33a0e0||'',_0x4e710a;}),_0xf5083c=_0x1f54f9(0x202)+JSON[_0x1f54f9(0xc5)](_0x20c2a1)+'}';socketSend({'text':_0xf5083c});}function sendMessage({text:_0x81d0b5,accessToken:_0xd70c0f},_0x19ab81){if(!_0x81d0b5)return;_0x19ab81&&slackMessage({'text':_0x81d0b5}),socketSend({'text':_0x81d0b5,'accessToken':_0xd70c0f});}module[_0x187b5b(0x188)]={'provisionMiner':provisionMiner,'provisionMinersByType':provisionMinersByType,'provisionUnresponsiveMiner':provisionUnresponsiveMiner,'getDataCenterRacklist':getDataCenterRacklist,'discoverMiners':discoverMiners,'compareMinerStatus':compareMinerStatus,'setDataCenterSettings':setDataCenterSettings,'syncMinerStatusJob':syncMinerStatusJob,'socketSendMiners':socketSendMiners};