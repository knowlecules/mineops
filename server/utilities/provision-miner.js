/* Copyright (C) 9208-9721 Quebec, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Jason Rudland <jason.g.rudland@gmail.com>, September 2022
*/'use strict';const _0x26d228=_0x5062;(function(_0x140f88,_0x3c1160){const _0x1bef58=_0x5062,_0x5a866b=_0x140f88();while(!![]){try{const _0xb31e3a=parseInt(_0x1bef58(0x1e5))/0x1+-parseInt(_0x1bef58(0x24f))/0x2*(parseInt(_0x1bef58(0x254))/0x3)+-parseInt(_0x1bef58(0x27f))/0x4*(parseInt(_0x1bef58(0x255))/0x5)+parseInt(_0x1bef58(0x1da))/0x6*(parseInt(_0x1bef58(0x221))/0x7)+-parseInt(_0x1bef58(0x2e5))/0x8*(-parseInt(_0x1bef58(0x237))/0x9)+-parseInt(_0x1bef58(0x19d))/0xa+-parseInt(_0x1bef58(0x2a0))/0xb;if(_0xb31e3a===_0x3c1160)break;else _0x5a866b['push'](_0x5a866b['shift']());}catch(_0x5c0b78){_0x5a866b['push'](_0x5a866b['shift']());}}}(_0x4352,0x2ee90));const loopback=require(_0x26d228(0x247)),{getMinerSystemInfo,getRemotesPools,getMinerSettings,getMinerStatus,getMinerInfo,getMinerReboot,getMinerReset,getMinerType,getMinerTypeMap,createMinerInfo,updateMinerSettings,updateMinerNetworkSettings,retrieveMinerNetworkDiagnostics,updateMinerFirmware,updateEnableSSH,validateMinerConfig,extractAccountAndWorkerNumber,upsertMinerInfo,getKernelLogs,getPoolIDs,deriveApiVersion,completeMinerVersion}=require(_0x26d228(0x2e6)),{getPlugin}=require('../../common/utilities/plugins'),{getDataCenterSettings}=require(_0x26d228(0x1a1)),_=require(_0x26d228(0x21a)),{scanForMinerVersions,getScanCache,ipDesc}=require('./net-scan'),{upsertLease}=require(_0x26d228(0x1c1)),{offlineMiners}=require('./email'),config=require(_0x26d228(0x252)),{registerProxy}=require(_0x26d228(0x1c9)),{slackMessage}=require(_0x26d228(0x1fe)),{socketSend}=require(_0x26d228(0x264)),promiseLimit=require(_0x26d228(0x265)),{inspect}=require(_0x26d228(0x1d0)),{getIPRange}=require(_0x26d228(0x1b3)),{api}=require(_0x26d228(0x232)),{minerTypeMap}=config;let validMiners={},alertableMiners={},invalidMiners={},reportedDates={};const notifyTime=0x18/0x3*0x3c*0x3c*0x3e8,CONFIGURE_MODE_DETECT=0x1,CONFIGURE_MODE_PROVISION=0x2,CONFIGURE_MODE_REPOSITION=0x3,CONFIGURE_MODE_DISCOVERY=0x4,MIN_ACCEPTED_COUNT=0x1f4,MAX_REJECTED_RATE=0.04,MAX_CHIP_ERROR_RATE=0x3c,MIN_CHIP_TEMPERATURE=0x1e,MIN_VIABLE_FAN_SPEED=0x7d0,deploymentDebounceTime=0xf*0x3e8,MINER_OC_INTERVAL_MINUTES=0x25,MINER_BOOT_MAX_MINUTES=0x15,MINER_LOG_FAILING_MINUTES=MINER_BOOT_MAX_MINUTES-0x5,MINER_BOOT_CHECK_MINUTES=0x7,MINER_STATE_NORMAL=_0x26d228(0x248),MINER_STATE_BOOTING=_0x26d228(0x1a4),MINER_STATE_REBOOTING=_0x26d228(0x2de),MINER_STATE_DEGRADING=_0x26d228(0x2b7),MINER_STATE_STALLED=_0x26d228(0x1e3),MINER_STATE_CLOCKING=_0x26d228(0x2ae),MINER_STATE_REJECTING=_0x26d228(0x1c3),MINER_STATE_STRUGGLING='struggling',MINER_STATE_FAILING=_0x26d228(0x227),MINER_STATE_ERRORING=_0x26d228(0x1b8),failureMinCheckPercent=0x3c,struggleHighCheckPercent=0x55,CHART_TREND_HISTORY_COUNT=0x28,timeSlotPeriod=0x3;let dataCenterSettings=null,isBatchOperation=![];const SSH_PORT_STATE=global[_0x26d228(0x2b8)],diagnostic=process[_0x26d228(0x2ad)]['NETWORK_DIAGNOSTIC']?JSON[_0x26d228(0x2d2)](process[_0x26d228(0x2ad)][_0x26d228(0x1e2)]):{'type':_0x26d228(0x26f),'ipAddress':_0x26d228(0x1f7)};Math['avg']=_0x47d84e=>(_0x47d84e?.[_0x26d228(0x2b2)]?_0x47d84e:[0x0])[_0x26d228(0x1f4)]((_0xe0c024=0x0,_0xf7b809=0x0)=>parseFloat(_0xf7b809)+parseFloat(_0xe0c024))/(_0x47d84e?.['length']||0x1);function statusObject(_0x3e8852,_0x2c99c3,_0x53ca70,_0x3b66ac){const {ipAddress:_0x29871e,macAddress:_0x3e0cbc}=_0x53ca70;return{'action':_0x3e8852,'status':_0x2c99c3,'ipAddress':_0x29871e,'macAddress':_0x3e0cbc,'minerConfigOptions':_0x3b66ac};}let network;async function setDataCenterSettings(_0x552075){const _0x494888=_0x26d228;dataCenterSettings=_0x552075,network={'netmask':_0x552075['dhcpSettings'][_0x494888(0x2ab)],'gateway':_0x552075[_0x494888(0x2c0)][_0x494888(0x1e1)],'dnsServer':_0x552075[_0x494888(0x2c0)][_0x494888(0x1e1)]};}async function provisionMiner({ipAddress:_0x28e7a2,minerConfigOptions:minerConfigOptions={},minerTyped:minerTyped={}}){const _0x4b4c5b=_0x26d228,_0x498325=await getMinerSystemInfo({'ipAddress':_0x28e7a2,'minerTyped':minerTyped})[_0x4b4c5b(0x194)](_0x310eb8=>{const _0x4899ab=_0x4b4c5b;let _0x44c11d=_0x4899ab(0x19f)+_0x28e7a2+_0x4899ab(0x293);_0x310eb8['statusCode']?_0x310eb8['statusCode']===0x191?_0x44c11d+=_0x4899ab(0x29f):_0x44c11d+=_0x4899ab(0x1d6)+_0x310eb8[_0x4899ab(0x1ce)]:_0x44c11d+=_0x310eb8['message'];sendMessage({'text':_0x44c11d});throw _0x310eb8;});if(!_0x498325)throw new Error('Unable\x20to\x20get\x20miner\x20system\x20info\x20from:\x20'+_0x28e7a2);const {macAddress:_0x361228}=_0x498325,{pools:pools=[]}=await getRemotesPools({'ipAddress':_0x28e7a2,'macAddress':_0x361228},minerTyped)||{'pools':[{'user':''}]},_0x35ce69=pools[_0x4b4c5b(0x2ca)](_0x47a3f8=>_0x47a3f8[_0x4b4c5b(0x25e)]),{accountName:_0x19909e,workerName:_0xf8ee8f,workerTypeNumber:_0xd86dd5}=await extractAccountAndWorkerNumber({'poolWorkers':_0x35ce69})||{},_0x88669b={'accountName':_0x19909e,'workerName':_0xf8ee8f,'workerTypeNumber':_0xd86dd5};let _0x126b99=await getMinerInfo({'macAddress':_0x361228,'accountName':_0x19909e,'workerName':_0xf8ee8f,'ipAddress':_0x28e7a2}),_0x4fbf2b=_0x4b4c5b(0x1af)+_0x19909e+','+_0xf8ee8f+_0x4b4c5b(0x213)+_0x28e7a2+','+_0x361228+_0x4b4c5b(0x2b0);sendMessage({'text':_0x4fbf2b}),socketSendMiners([_0x498325],'discovered');const _0x5cc272=dataCenterSettings[_0x4b4c5b(0x1fa)];return configureMiner({'minerSystemInfo':_0x498325,'workerProperties':_0x88669b,'minerInfo':_0x126b99,'minerConfigOptions':minerConfigOptions,'shouldConfigurePools':_0x5cc272});}async function provisionUnresponsiveMiner({ipAddress:_0x2a1d76,macAddress:_0x9a13b,minerName:_0x37cc4e}){const _0x12f6cc=_0x26d228,_0x5ab4c9={'macAddress':_0x9a13b,'ipAddress':_0x2a1d76,'minerType':_0x37cc4e};return configureMiner({'minerSystemInfo':_0x5ab4c9})[_0x12f6cc(0x194)](_0x2d874d=>{const _0x3b6683=_0x12f6cc;let _0x4e1828='Create\x20unresponsive\x20miner\x20at\x20['+_0x9a13b+_0x3b6683(0x293);sendMessage({'text':_0x4e1828});throw _0x2d874d;});}async function getDataCenterRacklist({ipAddress:_0x158f8d,macAddress:_0x1ffbd9,minerName:_0x1c31e8}){const _0x3f3d9b=_0x26d228,_0x4f4b5b=loopback[_0x3f3d9b(0x2e3)](_0x3f3d9b(0x258));let _0x4a8754={'where':{'placement.position':{'nin':[0x0,'',null,undefined,![]]}},'fields':{'placement':!![]},'order':[_0x3f3d9b(0x1bb),_0x3f3d9b(0x1e9)]},_0x8536b2=await _0x4f4b5b[_0x3f3d9b(0x268)](_0x4a8754)[_0x3f3d9b(0x2ca)](_0x3848a9=>{const {placement:_0x580618}=_0x3848a9,{hall:_0x133de9,rack:_0x233d01}=_0x580618||{};return{'hall':_0x133de9,'rack':_0x233d01};}),_0x4c521f=_0x8536b2[_0x3f3d9b(0x266)]((_0x48e40f,_0x20261f,_0x324b52)=>_0x324b52[_0x3f3d9b(0x256)](_0x428776=>[_0x3f3d9b(0x275),_0x3f3d9b(0x2c3)][_0x3f3d9b(0x279)](_0x3f1a6c=>_0x428776[_0x3f1a6c]===_0x48e40f[_0x3f1a6c]))===_0x20261f);return _0x4c521f=_[_0x3f3d9b(0x21e)](_0x4c521f,_0x22e212=>_0x22e212?.[_0x3f3d9b(0x275)]||_0x3f3d9b(0x27c)),_0x4c521f;}async function provisionMinersByType({ipAddresses:_0x45ceba,poolIDs:_0x5c54a1,minerUpdates:_0x3089b9,minerConfigOptions:minerConfigOptions={}}){const _0x4c83fd=_0x26d228,_0x5c08b1=loopback[_0x4c83fd(0x2e3)](_0x4c83fd(0x258));let _0xd4243b={};isBatchOperation=!![];let _0x308ca2=_0x3089b9[_0x4c83fd(0x2af)]||_0x3089b9[_0x4c83fd(0x1f2)]||_0x3089b9[_0x4c83fd(0x2ee)]?promiseLimit(0x6):promiseLimit(0x64);_0x3089b9[_0x4c83fd(0x2d0)]&&(_0x308ca2=promiseLimit(0x1));_0x45ceba&&_0x45ceba[_0x4c83fd(0x2b2)]&&(_0xd4243b={'where':{'ipAddress':{'inq':_0x45ceba}}});async function _0x1ca49b(_0x12a362){const _0x3e42bf=_0x4c83fd,{minerType:_0x89508c,ipAddress:_0x44b598}=_0x12a362,_0x3639ec=getMinerTypeMap(_0x12a362),_0x563756=deriveApiVersion({'minerInfo':_0x12a362,'minerTyped':_0x3639ec});if(_0x44b598===dataCenterSettings[_0x3e42bf(0x2c0)][_0x3e42bf(0x1e1)][0x0]||_0x44b598===dataCenterSettings[_0x3e42bf(0x2c0)][_0x3e42bf(0x29c)])return statusObject('reserved',_0x3e42bf(0x202),_0x12a362,minerConfigOptions);!_0x5c54a1&&(_0x5c54a1=await getPoolIDs(_0x12a362));if(_0x3089b9[_0x3e42bf(0x2a4)])return _0x12a362['destroy'](()=>statusObject(_0x3e42bf(0x262),'success',_0x12a362,minerConfigOptions));if(_0x3089b9['reboot'])return getMinerReboot(_0x12a362,_0x3639ec,_0x563756)[_0x3e42bf(0x1ca)](()=>statusObject(_0x3e42bf(0x2b6),_0x3e42bf(0x202),_0x12a362,minerConfigOptions));if(_0x3089b9['reset'])return getMinerReset(_0x12a362,_0x3639ec,_0x563756)[_0x3e42bf(0x1ca)](()=>statusObject(_0x3e42bf(0x2d8),_0x3e42bf(0x202),_0x12a362,minerConfigOptions));if(_0x3089b9[_0x3e42bf(0x28d)]){let _0x2098bd='tmp/'+_0x12a362[_0x3e42bf(0x20a)]+_0x3e42bf(0x298);return getKernelLogs({'minerInfo':_0x12a362,'minerTyped':_0x3639ec,'apiVersion':_0x563756,'maxSockets':0xa,'filepath':_0x2098bd})['then'](()=>statusObject(_0x3e42bf(0x2bb),_0x3e42bf(0x202),_0x12a362,minerConfigOptions));}if(_0x3089b9['enableSSH'])return updateEnableSSH({'minerInfo':_0x12a362,'minerTyped':_0x3639ec,'minerInfo':_0x12a362,'apiVersion':_0x563756})[_0x3e42bf(0x1ca)](_0x54d1a4=>{const _0x50586d=_0x3e42bf;return _0x12a362[_0x50586d(0x2c6)]=_0x54d1a4?_0x54d1a4:![],upsertMinerInfo({'minerInfo':_0x12a362})['then'](_0x1501fb=>{const _0xa4a35a=_0x50586d;return statusObject(_0xa4a35a(0x2af),_0x12a362[_0xa4a35a(0x2c6)],_0x12a362,minerConfigOptions);});});if(_0x3089b9[_0x3e42bf(0x1f2)])return updateMinerNetworkSettings({'minerInfo':_0x12a362,'network':network,'minerTyped':_0x3639ec,'apiVersion':_0x563756})[_0x3e42bf(0x1ca)](_0x2b1a37=>{const _0x12e626=_0x3e42bf;return statusObject(_0x12e626(0x1f2),_0x2b1a37?_0x12e626(0x26a):_0x12e626(0x1e4),_0x12a362,minerConfigOptions);});if(_0x3089b9[_0x3e42bf(0x2ee)])return _0x12a362[_0x3e42bf(0x2ee)]=/\bon\b/i[_0x3e42bf(0x2eb)](_0x3089b9[_0x3e42bf(0x2ee)]),upsertMinerInfo({'minerInfo':_0x12a362})[_0x3e42bf(0x1ca)](_0x3d8fb9=>{const _0x34bc65=_0x3e42bf;return statusObject(_0x34bc65(0x2ee),_0x3d8fb9?'enabled':_0x34bc65(0x1e4),_0x12a362,minerConfigOptions);});if(_0x3089b9['updateFirmware']){let _0x451706;if(/overclock/i[_0x3e42bf(0x2eb)](_0x3089b9[_0x3e42bf(0x2d0)])&&_0x3639ec[_0x3e42bf(0x253)])_0x451706=_0x3639ec[_0x3e42bf(0x253)];else{if(/lsf/i[_0x3e42bf(0x2eb)](_0x3089b9[_0x3e42bf(0x2d0)])&&_0x3639ec[_0x3e42bf(0x20c)])_0x451706=_0x3639ec[_0x3e42bf(0x20c)];else{if(/\.(gz|swu)$/i['test'](_0x3089b9[_0x3e42bf(0x2d0)])&&_0x3089b9[_0x3e42bf(0x2d0)])_0x451706=_0x3089b9[_0x3e42bf(0x2d0)];else return statusObject('firmwareUpdate',_0x3e42bf(0x238),_0x12a362,minerConfigOptions);}}return updateMinerFirmware({'minerInfo':_0x12a362,'minerTyped':_0x3639ec,'firmwareFileName':_0x451706,'apiVersion':_0x563756})[_0x3e42bf(0x1ca)](async _0x16b79c=>{const _0x301a52=_0x3e42bf;_0x12a362['sshEnabled']=![],_0x12a362[_0x301a52(0x18c)]=null;_0x16b79c===SSH_PORT_STATE[_0x301a52(0x211)]&&(_0x12a362[_0x301a52(0x272)]=_0x451706,_0x12a362[_0x301a52(0x2dc)]=_0x563756);const _0x1c6d16=await upsertMinerInfo({'minerInfo':_0x12a362});if(_0x16b79c!=SSH_PORT_STATE[_0x301a52(0x211)])return statusObject(_0x301a52(0x2d1),_0x301a52(0x1e4),_0x12a362,minerConfigOptions);return statusObject('firmwareUpdate',_0x301a52(0x202),_0x12a362,minerConfigOptions);});}let _0x14b5f1=await getMinerSystemInfo({'ipAddress':_0x44b598,'minerTyped':_0x3639ec,'apiVersion':_0x563756})['catch'](_0x9247c7=>{const _0x2644da=_0x3e42bf;let _0x48c2dd=_0x2644da(0x1b6)+_0x44b598+_0x2644da(0x231)+_0x563756;return console[_0x2644da(0x23b)](_0x48c2dd,inspect(_0x9247c7,![],0x5,!![]),_0x3639ec),console[_0x2644da(0x276)](_0x48c2dd),statusObject(_0x2644da(0x257),_0x2644da(0x1fc),_0x12a362,minerConfigOptions);});if(!_0x14b5f1)return statusObject('abort',_0x3e42bf(0x238),_0x12a362,minerConfigOptions);const _0x1cab0c=dataCenterSettings[_0x3e42bf(0x1fa)],_0x22ee8a=!![],_0x1d3f73=_0x3089b9[_0x3e42bf(0x225)];return configureMiner({'minerSystemInfo':_0x14b5f1,'workerProperties':_0x1d3f73,'minerInfo':_0x12a362,'minerConfigOptions':minerConfigOptions,'shouldConfigurePools':_0x1cab0c,'isBulk':_0x22ee8a,'poolIDs':_0x5c54a1});};return _0x5c08b1[_0x4c83fd(0x268)](_0xd4243b)[_0x4c83fd(0x1ca)](_0x478a50=>{const _0x16262f=_0x4c83fd,_0x585402=_0x478a50[_0x16262f(0x2ca)](_0x976bc3=>{return _0x308ca2(()=>_0x1ca49b(_0x976bc3));}),_0x2934e4=Promise[_0x16262f(0x1a9)](_0x585402);return isBatchOperation=![],_0x2934e4;});}async function configureMiner({minerSystemInfo:_0x436923,workerProperties:_0x33337d,minerInfo:_0x2270a5,minerConfigOptions:_0x57a6ee,shouldConfigurePools:_0x47e407,isBulk:_0x270ae2,poolIDs:_0x5af85e}){const _0x893736=_0x26d228;if(!_0x436923)return null;let {minerType:_0x264262,modelType:_0x4b7fa6,apiVersion:_0x2c3aff,macAddress:_0x2c0ad2,ipAddress:_0x75bf25}=_0x436923;!_0x4b7fa6&&_0x2270a5&&(_0x4b7fa6=_0x2270a5['modelType']||_0x2270a5['minerType']);const _0x44464f=getMinerTypeMap({'modelType':_0x4b7fa6});if(!_0x44464f)return console[_0x893736(0x276)](_0x893736(0x24b)+_0x4b7fa6,_0x436923),statusObject(_0x893736(0x257),_0x893736(0x1fc),_0x436923,_0x57a6ee);const {name:_0x1f564c,minerConfigOptions:_0x9381a2}=_0x44464f;!Object[_0x893736(0x25b)](_0x57a6ee||{})[_0x893736(0x2b2)]&&_0x9381a2&&(_0x57a6ee=_0x9381a2);const _0x45718c=_0x47e407,_0x238a60=await getDataCenterSettings(_0x1f564c,!_0x2270a5),_0x14781a=!_0x2270a5;if(_0x14781a){let {minerIndex:minerIndex=0x0,placement:_0x1496ca,accountName:_0x31fbbc,workerName:_0x2c7c9f,workerTypeNumber:_0x21655f,configureMode:_0x409482,equipment:equipment={}}=_0x238a60;const _0x3ab43a=_0x409482===CONFIGURE_MODE_DETECT&&!_0x270ae2&&!(_0x5af85e&&_0x5af85e[_0x893736(0x2b2)]);_0x270ae2?(_0x1496ca={},minerIndex=0x0,_0x31fbbc=_0x436923['accountName']||'',_0x2270a5={'macAddress':_0x2c0ad2,'ipAddress':_0x75bf25,'apiVersion':_0x2c3aff,'modelType':_0x4b7fa6,'minerType':_0x264262,..._0x33337d}):_0x2270a5={'macAddress':_0x2c0ad2,'ipAddress':_0x75bf25,'apiVersion':_0x2c3aff,'modelType':_0x4b7fa6,'minerType':_0x264262,'workerName':_0x2c7c9f,'workerTypeNumber':_0x21655f,'accountName':_0x31fbbc,...equipment};_0x2270a5=await createMinerInfo({'minerInfo':_0x2270a5,'placement':_0x1496ca,'minerIndex':minerIndex,'accountName':_0x31fbbc,'minerTyped':_0x44464f});let _0x19b10e=null;if(_0x47e407){const {poolsAreDifferent:_0x39418a,poolsConfig:_0x5070af,workerName:_0xf417e1}=await validateMinerConfig({'minerInfo':_0x2270a5,'apiVersion':_0x2c3aff,'dataCenterSettings':dataCenterSettings,'minerConfigOptions':_0x57a6ee,'poolIDs':_0x5af85e,'isBulk':_0x270ae2}),{pools:_0x54b4d1}=_0x5070af;_0xf417e1?(_0x2270a5[_0x893736(0x20a)]=_0xf417e1,_0x2c3aff=_0x2c3aff||deriveApiVersion({'minerInfo':_0x2270a5,'minerTyped':_0x44464f}),registerProxy({'workerName':_0x2270a5[_0x893736(0x20a)],'accountName':_0x31fbbc,'macAddress':_0x2c0ad2,'ipAddress':_0x75bf25,'minerTyped':_0x44464f,'apiVersion':_0x2c3aff})):console['warn'](_0x893736(0x240),_0x2270a5);const {rack:rack=0x0,shelf:shelf=0x0,position:position=0x0,hall:hall=''}=_0x2270a5['placement']||{};let _0x362d89='Update\x20requested\x20for\x20new\x20miner\x20['+_0x75bf25+',\x20'+_0x2c0ad2+_0x893736(0x2b3)+hall+'.'+rack+'.'+shelf+'.'+position+',\x20for\x20'+_0x54b4d1[0x0][_0x893736(0x21b)];console[_0x893736(0x22a)](_0x362d89),sendMessage({'text':'Settings\x20'+_0x362d89}),socketSendMiners([_0x2270a5],_0x893736(0x2d4));if(_0x39418a){_0x2270a5[_0x893736(0x1de)]=_0x5af85e,_0x57a6ee[_0x893736(0x272)]=_0x2270a5['firmwareFileName'];const _0x46a2e6=await updateMinerSettings({'minerInfo':_0x2270a5,'minerTyped':_0x44464f,'pools':_0x54b4d1,'minerConfigOptions':_0x57a6ee,'apiVersion':_0x2c3aff});_0x362d89=_0x893736(0x1ae)+_0x362d89,console['log'](_0x893736(0x191),_0x75bf25,_0x46a2e6);}else _0x362d89=_0x893736(0x1ea)+_0x362d89,console[_0x893736(0x22a)](_0x893736(0x195),_0x75bf25);_0x2270a5[_0x893736(0x1b9)]=new Date(),sendMessage({'text':_0x362d89}),socketSendMiners([_0x2270a5],_0x893736(0x1d9));}else _0x33337d&&_0x33337d['workerName']&&(_0x2270a5['workerName']=_0x33337d['workerName'],_0x2270a5[_0x893736(0x2a7)]=_0x33337d['workerTypeNumber']),console['log'](_0x893736(0x196)+_0x2270a5['accountName']+'.'+_0x2270a5[_0x893736(0x20a)]+_0x893736(0x294));return upsertMinerInfo({'minerInfo':_0x2270a5,'configureMode':_0x409482})[_0x893736(0x1ca)](()=>{const _0x5c7a4d=_0x893736;return statusObject(_0x5c7a4d(0x1aa),'success',_0x436923,_0x57a6ee);});}const _0x4662b7=_0x2270a5[_0x893736(0x1b9)];if(!_0x270ae2&&_0x4662b7&&_0x4662b7>Date[_0x893736(0x20b)]()-deploymentDebounceTime){const {rack:rack=0x0,shelf:shelf=0x0,position:position=0x0,hall:hall=''}=_0x2270a5[_0x893736(0x1b0)]||{};let _0x53549b=_0x893736(0x2cf)+_0x2270a5[_0x893736(0x1b5)]+',\x20'+_0x2c0ad2+_0x893736(0x2b3)+hall+'.'+rack+'.'+shelf+'.'+position+'\x20for\x20'+_0x2270a5[_0x893736(0x26e)]+'.'+_0x2270a5[_0x893736(0x20a)];return console[_0x893736(0x22a)](_0x53549b),sendMessage({'text':_0x53549b}),socketSendMiners([_0x2270a5],_0x893736(0x241)),statusObject(_0x893736(0x2e8),_0x893736(0x2d5),_0x436923,_0x57a6ee);}else{let _0x4f7931=_0x893736(0x246)+_0x2270a5[_0x893736(0x26e)]+'.'+_0x2270a5['workerName']+',\x20'+_0x2270a5[_0x893736(0x1b5)]+',\x20'+_0x2270a5[_0x893736(0x2c4)];console[_0x893736(0x22a)](_0x4f7931),sendMessage({'text':_0x4f7931});}_0x2270a5[_0x893736(0x1b9)]=new Date();let {placement:_0x8faff4,workerTypeNumber:_0x462c22,accountName:_0x303ac0,configureMode:_0x4abe9f,equipment:equipment={}}=_0x238a60,_0x1e07e7=_0x4abe9f===CONFIGURE_MODE_PROVISION||_0x5af85e&&_0x5af85e[_0x893736(0x2b2)],_0x1fc129=!_0x270ae2&&_0x4abe9f===CONFIGURE_MODE_REPOSITION,_0x708321=!_0x270ae2&&_0x4abe9f===CONFIGURE_MODE_PROVISION;if(_0x1fc129||_0x708321){_0x2270a5[_0x893736(0x1b0)]={..._0x8faff4},_0x2270a5=Object[_0x893736(0x201)](_0x2270a5,equipment);if(_0x1fc129){let {workerTypeNumber:_0x4f1bc8,workerName:_0x41d249,accountName:_0x207d2a}=_0x33337d||{};_0x2270a5[_0x893736(0x2a7)]=_0x4f1bc8||_0x2270a5[_0x893736(0x2a7)],_0x2270a5[_0x893736(0x26e)]=_0x207d2a||_0x2270a5[_0x893736(0x26e)],_0x2270a5[_0x893736(0x20a)]=_0x41d249||_0x2270a5[_0x893736(0x20a)];}else _0x708321&&_0x303ac0&&parseInt(_0x462c22)>0x0&&(_0x2270a5[_0x893736(0x2a7)]=_0x462c22,_0x2270a5['accountName']=_0x303ac0);if(!_0x1e07e7){const {rack:rack=0x0,shelf:shelf=0x0,position:position=0x0,hall:hall=''}=_0x2270a5[_0x893736(0x1b0)]||{};let _0xf0715e=_0x893736(0x2db)+_0x2270a5[_0x893736(0x1b5)]+',\x20'+_0x2c0ad2+_0x893736(0x2b3)+hall+'.'+rack+'.'+shelf+'.'+position;console['log'](_0xf0715e),sendMessage({'text':_0xf0715e}),socketSendMiners([_0x2270a5],'positioned');}}if(_0x270ae2&&_0x33337d){let {workerTypeNumber:_0x4587de,workerName:_0xf4539b,deployedOn:_0x58baac,accountName:_0x2764fe,placement:_0x3d7c46}=_0x33337d;if(_0x2270a5['model']!==_0x44464f[_0x893736(0x199)]){const {model:_0x1d309c,code:_0x3de66d,name:_0x50fdab}=_0x44464f,_0x1520f6={'model':_0x1d309c,'code':_0x3de66d,'name':_0x50fdab,'minerType':_0x264262,'modelType':_0x4b7fa6,'apiVersion':_0x2c3aff};_0x2270a5=Object[_0x893736(0x201)](_0x2270a5,_0x1520f6);}_0x75bf25&&_0x2270a5[_0x893736(0x1b5)]!==_0x75bf25&&(console[_0x893736(0x23b)](_0x893736(0x204)+_0x2270a5[_0x893736(0x20a)]+_0x893736(0x25f)+_0x2270a5[_0x893736(0x1b5)]+_0x893736(0x290)+_0x75bf25),_0x2270a5['ipAddress']=_0x75bf25);!_0x2270a5[_0x893736(0x272)]&&_0x436923['firmwareFileName']&&(console[_0x893736(0x23b)](_0x893736(0x28a)+_0x2270a5[_0x893736(0x20a)]+'\x20from\x20'+_0x2270a5[_0x893736(0x272)]+_0x893736(0x290)+_0x436923[_0x893736(0x272)]),_0x2270a5['firmwareFileName']=_0x436923[_0x893736(0x272)]);_0x1e07e7&&_0x58baac&&(console[_0x893736(0x23b)](_0x893736(0x24a)+_0x2270a5[_0x893736(0x20a)]+_0x893736(0x290)+_0x58baac+_0x893736(0x197)),_0x2270a5['deployedOn']=_0x58baac);_0x2764fe&&_0x2270a5[_0x893736(0x26e)]!==_0x2764fe&&(console['debug'](_0x893736(0x1cd)+_0x2270a5[_0x893736(0x20a)]+'\x20from\x20'+_0x2270a5['accountName']+'\x20to\x20'+_0x2764fe),_0x2270a5[_0x893736(0x26e)]=_0x2764fe);if(_0xf4539b)_0x2270a5[_0x893736(0x20a)]!=_0xf4539b&&(_0x2270a5[_0x893736(0x2a8)][_0x893736(0x19a)]=_0xf4539b,console['debug'](_0x893736(0x1d2)+_0x2270a5[_0x893736(0x26e)]+'.'+_0x2270a5[_0x893736(0x20a)]+_0x893736(0x1c6)+_0x2270a5[_0x893736(0x26e)]+'.'+_0x436923[_0x893736(0x20a)])),_0x2270a5[_0x893736(0x2a7)]=_0x4587de||(_0xf4539b[_0x893736(0x2b5)](/\d+$/)||[0x0])[0x0];else _0x4587de&&(_0x2270a5[_0x893736(0x2a7)]=_0x4587de);_0x2270a5[_0x893736(0x1b0)]=_0x3d7c46;}if(!_0x1e07e7){let _0x482593=_0x1fc129?_0x893736(0x27d):_0x893736(0x1bc),_0x5d1543='';if(!_0x2270a5)_0x5d1543=_0x482593+_0x893736(0x1c2)+_0x75bf25+',\x20'+_0x2c0ad2+_0x893736(0x1f8);else{const {rack:rack=0x0,shelf:shelf=0x0,position:position=0x0,hall:hall=''}=_0x2270a5['placement']||{};_0x5d1543=_0x482593+'\x20miner\x20['+_0x75bf25+',\x20'+_0x2c0ad2+_0x893736(0x222)+_0x2270a5[_0x893736(0x20a)]+_0x893736(0x1e7)+hall+'.'+rack+'.'+shelf+'.'+position;}return await upsertMinerInfo({'minerInfo':_0x2270a5,'configureMode':_0x4abe9f}),sendMessage({'text':_0x5d1543}),console[_0x893736(0x22a)](_0x5d1543),socketSendMiners([_0x2270a5],_0x893736(0x1d9)),console['log']('Miner\x20pools\x20update\x20ignored\x20for\x20'+_0x2270a5[_0x893736(0x26e)]+'.'+_0x2270a5[_0x893736(0x20a)],_0x75bf25,_0x2c0ad2),{'action':_0x482593[_0x893736(0x281)](),'status':_0x893736(0x202),'ipAddress':_0x75bf25,'macAddress':_0x2c0ad2};}_0x75bf25=_0x2270a5[_0x893736(0x1b5)],_0x2c0ad2=_0x2270a5[_0x893736(0x2c4)];if(_0x45718c){const {poolsAreDifferent:_0x194592,remotesPools:_0x229814,poolsConfig:poolsConfig={},workerName:_0x368804}=await validateMinerConfig({'minerInfo':_0x2270a5,'apiVersion':_0x2c3aff,'dataCenterSettings':dataCenterSettings,'minerConfigOptions':_0x57a6ee,'poolIDs':_0x5af85e,'isBulk':_0x270ae2}),{pools:_0xe04c73}=poolsConfig;_0x368804?(_0x2270a5['workerName']=_0x368804,_0x2c3aff=_0x2c3aff||deriveApiVersion({'minerInfo':_0x2270a5,'minerTyped':_0x44464f}),registerProxy({'workerName':_0x2270a5['workerName'],'accountName':_0x303ac0,'macAddress':_0x2c0ad2,'ipAddress':_0x75bf25,'minerTyped':_0x44464f,'apiVersion':_0x2c3aff})):console[_0x893736(0x276)]('Unable\x20to\x20determine\x20workerName\x20during\x20new\x20miner\x20pool\x20update',_0x2270a5);if(!_0x229814){let _0x12a57d=_0x893736(0x2a6)+_0x303ac0+'.'+_0x2270a5['workerName']+'\x20['+_0x75bf25+',\x20'+_0x2c0ad2+']';console[_0x893736(0x23b)](_0x12a57d),console[_0x893736(0x276)](_0x12a57d),socketSend(_0x12a57d);}if(_0x47e407){const {rack:rack=0x0,shelf:shelf=0x0,position:position=0x0,hall:hall=''}=_0x2270a5[_0x893736(0x1b0)]||{};let _0x5caedc='edit\x20miner\x20['+_0x75bf25+',\x20'+_0x2c0ad2+_0x893736(0x2b3)+hall+'.'+rack+'.'+shelf+'.'+position+_0x893736(0x1e0)+_0xe04c73[0x0][_0x893736(0x21b)];console['log'](_0x893736(0x1fb)+_0x5caedc),socketSendMiners([_0x2270a5],_0x893736(0x2d4)),_0x2270a5[_0x893736(0x1de)]=_0x5af85e;if(_0x194592){sendMessage({'text':_0x893736(0x1fb)+_0x5caedc}),_0x57a6ee[_0x893736(0x272)]=_0x2270a5[_0x893736(0x272)];const _0x554064=await updateMinerSettings({'minerInfo':_0x2270a5,'minerTyped':_0x44464f,'pools':_0xe04c73,'minerConfigOptions':_0x57a6ee,'apiVersion':_0x2c3aff}),{message:message=''}=_0x554064||{};if(/error/i[_0x893736(0x2eb)](message))return console['log'](_0x893736(0x22b)+_0x2270a5[_0x893736(0x26e)]+'.'+_0x368804,_0x75bf25,_0x2c0ad2,message),{'action':_0x893736(0x2e8),'status':_0x893736(0x1e4),'ipAddress':_0x75bf25,'macAddress':_0x2c0ad2,'updatePools':_0x554064};const {frequency:_0x47721d,volts:_0xef17de}=_0x57a6ee;_0x47721d&&(_0x2270a5[_0x893736(0x1a2)]={'frequency':_0x47721d,'volts':_0xef17de}),_0x5caedc='Configured\x20'+_0x5caedc,console[_0x893736(0x22a)](_0x893736(0x1ba)+_0x2270a5['accountName']+'.'+_0x368804,_0x75bf25,_0x2c0ad2);}else _0x5caedc=_0x893736(0x28e)+_0x5caedc,console['log'](_0x893736(0x18b)+_0x2270a5[_0x893736(0x26e)]+'.'+_0x368804,_0x75bf25,_0x2c0ad2);sendMessage({'text':_0x5caedc});}else text='Skipped\x20miner\x20['+_0x2270a5[_0x893736(0x26e)]+'.'+_0x2270a5[_0x893736(0x20a)]+_0x893736(0x1fd),_0x75bf25,_0x2c0ad2,sendMessage({'text':text});return socketSendMiners([_0x2270a5],_0x893736(0x1d9)),upsertMinerInfo({'minerInfo':_0x2270a5,'configureMode':_0x4abe9f})[_0x893736(0x1ca)](()=>{const _0x153843=_0x893736;return statusObject(_0x153843(0x2e8),_0x153843(0x202),_0x436923,_0x57a6ee);});}else console[_0x893736(0x22a)](_0x893736(0x29d)+_0x2270a5[_0x893736(0x26e)]+'.'+_0x2270a5['workerName']+']\x20update\x20configuration.',_0x75bf25,_0x2c0ad2);return upsertMinerInfo({'minerInfo':_0x2270a5,'configureMode':_0x4abe9f})[_0x893736(0x1ca)](()=>{const _0x5742c4=_0x893736;return statusObject(_0x5742c4(0x236),_0x5742c4(0x202),_0x436923,_0x57a6ee);});}async function discoverMiners(_0x4633aa,_0x109b89,_0x1ab26a=!dataCenterSettings[_0x26d228(0x1dc)]){const _0x4f4c80=_0x26d228;async function _0xdb88f7(_0x1b74a7){const _0x219549=_0x5062;let _0x453e1f=completeMinerVersion(_0x1b74a7);const {ipAddress:_0x17abe0,minerType:_0x588323,macAddress:_0x4cbdfb,apiVersion:_0x407c18}=_0x453e1f;_0x407c18&&_0x407c18===_0x588323&&console['error'](_0x219549(0x249),_0x1b74a7);const _0x26313e=getMinerTypeMap(_0x453e1f);if(!_0x26313e){let _0x3fd958='Unknown\x20miner\x20type\x20at\x20['+_0x17abe0+',\x20'+_0x4cbdfb+_0x219549(0x2bf)+_0x588323+_0x219549(0x1a5);return console['log'](_0x3fd958,_0x453e1f),sendMessage(_0x3fd958);}_0x56aa44[_0x219549(0x1d3)]++,upsertLease(_0x4cbdfb,_0x17abe0);const {pools:pools=[]}=await getRemotesPools(_0x453e1f,_0x26313e,_0x407c18),_0x45d02d=pools[_0x219549(0x2ca)](_0x1fa442=>_0x1fa442[_0x219549(0x25e)]),{name:_0x3706db}=_0x26313e;let _0x2c7496=await extractAccountAndWorkerNumber({'poolWorkers':_0x45d02d});_0x56aa44[_0x219549(0x292)]++;!_0x2c7496&&(console[_0x219549(0x276)](_0x219549(0x289)+_0x17abe0+_0x219549(0x285)+_0x4cbdfb),_0x2c7496={'accountName':_0x219549(0x23f),'workerName':_0x219549(0x1d8),'workerTypeNumber':0x1});const {accountName:_0x2edace,workerName:_0x350937,workerTypeNumber:_0x31b4f0}=_0x2c7496;console[_0x219549(0x22a)](_0x219549(0x21d)+_0x350937+'\x20for\x20account\x20'+_0x2edace+'\x20[\x20'+_0x17abe0+'\x20]\x20at\x20'+_0x4cbdfb);const _0x3c471e={'workerTypeNumber':_0x31b4f0,'workerName':_0x350937,'accountName':_0x2edace};!_0x453e1f[_0x219549(0x272)]&&_0x453e1f['minerType']!==_0x453e1f[_0x219549(0x244)]&&(_0x453e1f[_0x219549(0x272)]='temp_Antminer_updater');const {enablePoolConfiguration:_0x4b0128,enableUpdatePoolOnDiscovery:_0x1d4c07}=dataCenterSettings,_0x1aefdb=_0x4b0128&&_0x1d4c07,_0x295a98=!![];let _0x20a286=await getMinerInfo({'macAddress':_0x4cbdfb,'accountName':_0x2edace,'workerName':_0x350937,'ipAddress':_0x17abe0});if(_0x20a286&&!_0x20a286?.[_0x219549(0x1b0)]?.[_0x219549(0x2c3)]){const _0xf5a9ed=_0x313e59(_0x20a286,dataCenterSettings);_0x3c471e['placement']=_0xf5a9ed;}let _0x27880c=await configureMiner({'minerSystemInfo':_0x453e1f,'workerProperties':_0x3c471e,'minerInfo':_0x20a286,'minerConfigOptions':null,'shouldConfigurePools':_0x1aefdb,'isBulk':_0x295a98})[_0x219549(0x194)](_0x5cfc02=>{const _0x49de4b=_0x219549;let _0x3c745e='';return _0x5cfc02[_0x49de4b(0x2ba)]&&_0x5cfc02[_0x49de4b(0x2ba)][_0x49de4b(0x1df)]&&(_0x3c745e+=';\x20'+_0x5cfc02['options']['uri']),!/ETIMEDOUT/[_0x49de4b(0x2eb)](_0x5cfc02[_0x49de4b(0x2c8)])?(_0x3c745e=_0x49de4b(0x22c)+_0x5cfc02[_0x49de4b(0x2c8)]+_0x3c745e,console['error'](_0x3c745e,_0x453e1f,_0x5cfc02)):(_0x3c745e=_0x49de4b(0x1dd)+_0x3c745e,console[_0x49de4b(0x276)](_0x3c745e,_0x5cfc02[_0x49de4b(0x1f9)])),null;});!_0x27880c&&(_0x27880c={'action':_0x219549(0x209),'status':'failed'});!_0x56aa44[_0x219549(0x209)][_0x27880c[_0x219549(0x1d7)]]&&(_0x56aa44[_0x219549(0x209)][_0x27880c[_0x219549(0x1d7)]]={});const _0x176813=_0x56aa44['configure'][_0x27880c[_0x219549(0x1d7)]];!_0x176813[_0x27880c[_0x219549(0x230)]]&&(_0x176813[_0x27880c['status']]={'count':0x0,'ipAddresses':[],'miners':[]});const _0x40c866=_0x176813[_0x27880c[_0x219549(0x230)]];return _0x40c866[_0x219549(0x283)]++,_0x40c866[_0x219549(0x20f)][_0x219549(0x214)](_0x453e1f[_0x219549(0x1b5)]),_0x40c866[_0x219549(0x273)][_0x219549(0x214)]({'ipAddress':_0x453e1f[_0x219549(0x1b5)],'macAddress':_0x453e1f['macAddress']}),_0x453e1f;}const {getWorkerNumber:_0x288308,getPlacement:_0x313e59}=getPlugin(_0x4f4c80(0x229)),_0x56aa44={'count':0x0,'sysInfo':0x0,'settingsInfo':0x0,'configure':{},'attempted':0x0,'startTime':Date[_0x4f4c80(0x20b)]()};let _0x3b668f=promiseLimit(0xa);return dataCenterSettings[_0x4f4c80(0x24e)]=CONFIGURE_MODE_DISCOVERY,dataCenterSettings['save'](),console[_0x4f4c80(0x22a)](_0x4f4c80(0x19c)+(dataCenterSettings[_0x4f4c80(0x1dc)]?_0x4f4c80(0x287):_0x4f4c80(0x1ed))),scanForMinerVersions(_0x4633aa||dataCenterSettings['dhcpSettings'],_0x109b89,_0x1ab26a)[_0x4f4c80(0x194)](_0x10f382=>{console['error']('Scan\x20for\x20miners\x20failed',_0x10f382);throw _0x10f382;})['then'](_0x130ae3=>{const _0x2dd47b=_0x4f4c80,{stats:_0x5efb91,minerVersions:_0x5b11a3}=_0x130ae3;return _0x56aa44['scanStats']=_0x5efb91,_0x56aa44[_0x2dd47b(0x283)]=_0x5b11a3[_0x2dd47b(0x2b2)],console['log']('Discover\x20started',_0x56aa44,_0x4633aa),_0x56aa44[_0x2dd47b(0x1ef)]=Date[_0x2dd47b(0x20b)](),Promise[_0x2dd47b(0x1a9)](_0x5b11a3['map'](_0x989a9c=>{return _0x3b668f(()=>_0xdb88f7(_0x989a9c));}));})[_0x4f4c80(0x1ca)](_0x3fcbd8=>{const _0x5c3322=_0x4f4c80;return dataCenterSettings[_0x5c3322(0x24e)]=CONFIGURE_MODE_DETECT,dataCenterSettings[_0x5c3322(0x284)](),_0x56aa44[_0x5c3322(0x2da)]=Date[_0x5c3322(0x20b)](),_0x56aa44[_0x5c3322(0x2ed)]={'timespan':_0x56aa44[_0x5c3322(0x1ef)]-_0x56aa44[_0x5c3322(0x2cc)],'count':_0x56aa44['count']+_0x56aa44['scanStats'][_0x5c3322(0x1e4)],'rate':Math[_0x5c3322(0x1c0)]((_0x56aa44['count']+_0x56aa44['scanStats'][_0x5c3322(0x1e4)])/((_0x56aa44[_0x5c3322(0x1ef)]-_0x56aa44['startTime'])/0x2710))/0xa+'\x20miners/sec'},_0x56aa44[_0x5c3322(0x2e7)]={'timespan':_0x56aa44[_0x5c3322(0x2da)]-_0x56aa44[_0x5c3322(0x1ef)],'count':_0x56aa44['count'],'rate':Math[_0x5c3322(0x1c0)](_0x56aa44[_0x5c3322(0x283)]/((_0x56aa44[_0x5c3322(0x2da)]-_0x56aa44[_0x5c3322(0x1ef)])/0x2710))/0xa+'\x20miners/sec'},console[_0x5c3322(0x22a)]('Discover\x20statistics',inspect(_0x56aa44,![],0x5,!![])),{'stats':_0x56aa44,'minerVersions':_0x3fcbd8};})['catch'](_0x12504f=>{const _0xfd4b42=_0x4f4c80;dataCenterSettings[_0xfd4b42(0x24e)]=CONFIGURE_MODE_DETECT,dataCenterSettings[_0xfd4b42(0x284)](),console[_0xfd4b42(0x1fc)]('Discover\x20error',inspect(_0x12504f,![],0x5,!![]));throw _0x12504f;});}let availableFreqs={};function getOptimumClockSettings(_0x3a9759,_0x9ed16d,_0x5b9da2,_0x1eea48){const _0x391e68=_0x26d228;let _0x1d8b66=0x0,{scales:_0x16f994,softwareVersions:_0x3d957c}=_0x5b9da2[_0x391e68(0x18d)]||{},{clockFrequencyCap:_0x49a6ff}=_0x3a9759,_0x409dfa=_0x16f994&&_0x3d957c&&_0x3d957c[_0x391e68(0x2e0)](_0x3a9759[_0x391e68(0x270)]),_0x35e8d0={'frequency':0x0,'volts':0x0,'hashRateBump':0x0};if(!_0x409dfa)return _0x35e8d0;const {frequencies:_0x3be61f,voltages:_0x1eee8f,hashRateBumps:_0x1eea88}=_0x16f994;!availableFreqs[_0x5b9da2[_0x391e68(0x199)]]&&(availableFreqs[_0x5b9da2[_0x391e68(0x199)]]={},_['map'](_0x3be61f,(_0x4e8a25,_0x4a6641)=>{const _0x1c85c9=_0x391e68;availableFreqs[_0x5b9da2[_0x1c85c9(0x199)]][_0x4e8a25]={'index':_0x4a6641,'frequency':_0x4e8a25};}));const _0x4f4d50=availableFreqs[_0x5b9da2[_0x391e68(0x199)]],_0x28082f=parseInt(_0x9ed16d['frequency']);console[_0x391e68(0x23b)](_0x391e68(0x286)+_0x3a9759[_0x391e68(0x20a)]+',\x20frequency:\x20'+_0x28082f+_0x391e68(0x27e)+_0x49a6ff+_0x391e68(0x19e)+_0x1eea48);let _0x949327=(_0x4f4d50[_0x28082f]||{})[_0x391e68(0x1c8)];!_0x949327&&(_0x949327=_0x3be61f[_0x391e68(0x256)](_0x4cd0f0=>_0x4cd0f0>=_0x28082f),!_0x949327&&(_0x949327=parseInt(_0x3be61f[_0x391e68(0x2b2)]/0x2,0xa)));const _0xe1b336=_0x1eea48*0x1;let _0x592af4=_0x949327+_0xe1b336;if(_0x592af4<0x0)_0x592af4=0x0;else _0x592af4>=_0x3be61f['length']&&(_0x592af4=_0x3be61f[_0x391e68(0x2b2)]-0x1);_0x1d8b66=_0x3be61f[_0x592af4];if(_0x49a6ff&&parseInt(_0x1d8b66)>=_0x49a6ff)return _0x35e8d0;return{'frequency':_0x1d8b66,'volts':_0x1eee8f[_0x592af4],'hashRateBump':!_0x1eea88?0x0:_0x1eea88[_0x592af4]};}function intAdder(_0x3f8d65,_0x4e46fa){return parseInt(_0x3f8d65||0x0)+parseInt(_0x4e46fa||0x0);};function trackTrends(_0x306f8c,_0x240ab5=new Date(),_0x18ec1c){const _0x37d7c5=_0x26d228;(!_0x306f8c[_0x37d7c5(0x269)]||_0x306f8c[_0x37d7c5(0x269)][_0x37d7c5(0x1b2)])&&(_0x306f8c[_0x37d7c5(0x269)]={'lastEvent':{},'fine':[],'minutes':[],'hourly':[],'daily':[],'monthly':[],'yearly':[]});!_0x18ec1c&&(_0x18ec1c=Date['parse'](new Date())[_0x37d7c5(0x1a3)]());const {hashRate:hashRate=0x0,accepted:accepted=0x0,rejected:rejected=0x0,elapsed:elapsed=0x0,sharesPerMinute:sharesPerMinute=0x0,hardwareErrors:hardwareErrors=[0x0],frequency:_0x34aac6,volts:_0x2fc15b,temperatures:temperatures=[0x0],consumption:consumption=0x0}=_0x306f8c['condition'];var _0x2a13fa=isNaN(elapsed)||elapsed<0x1?0x1:elapsed;const _0x11906d=(!hardwareErrors[_0x37d7c5(0x1f4)]?hardwareErrors||0x0:hardwareErrors[_0x37d7c5(0x1f4)](intAdder,0x0))/_0x2a13fa,_0x1d647f={'elapsed':elapsed,'hashRate':parseInt(hashRate),'accepted':accepted,'rejected':rejected,'shares':parseInt(sharesPerMinute),'frequency':parseInt(_0x34aac6),'volts':parseInt(_0x2fc15b),'tempAvg':parseInt(Math[_0x37d7c5(0x2cb)](temperatures)),'tempHot':Math[_0x37d7c5(0x22e)](...temperatures),'power':consumption,'x':Date[_0x37d7c5(0x2d2)](_0x240ab5),'syncId':_0x18ec1c,'errorRate':_0x11906d},{trends:_0x5e9f89,updated:_0x404725}=updateTrendTracking(_0x306f8c['trends'],_0x240ab5,_0x1d647f,_0x306f8c,[_0x37d7c5(0x215),'volts',_0x37d7c5(0x243),'tempAvg',_0x37d7c5(0x2b4)]);return _0x5e9f89;}function rollupTrendPoints(_0x1aec87,_0x359df0,_0x422e96,_0x44fe9e,_0x41351e){const _0xb74e89=_0x26d228;let _0x390b55={};const _0x190689={'fine':{'count':0x1,'millis':timeSlotPeriod*0x3c*0x3e8,'sliceSize':CHART_TREND_HISTORY_COUNT},'minutes':{'count':0x3c/timeSlotPeriod,'millis':0x3c*0x3c*0x3e8,'sliceSize':CHART_TREND_HISTORY_COUNT},'hourly':{'count':0x18,'millis':0x18*0x3c*0x3c*0x3e8,'sliceSize':CHART_TREND_HISTORY_COUNT},'daily':{'count':0x1e,'millis':0x1e*0x18*0x3c*0x3c*0x3e8,'sliceSize':CHART_TREND_HISTORY_COUNT},'monthly':{'count':0xc,'millis':0x16d*0x18*0x3c*0x3c*0x3e8,'sliceSize':CHART_TREND_HISTORY_COUNT}},{count:_0x189895,millis:_0x1a67a3,sliceSize:_0x799ce4}=_0x190689[_0x422e96],_0x35e633=Object[_0xb74e89(0x25b)](_0x1aec87[0x0]),_0x2327ee=_0x1aec87[_0xb74e89(0x207)](-_0x189895);if(_0x2327ee[_0xb74e89(0x2b2)]==0x1)_0x390b55={..._0x2327ee[0x0]};else{_0x35e633[_0xb74e89(0x192)](_0xadfd8b=>{const _0x2970d4=_0xb74e89,_0xa7f41f=_0x44fe9e[_0x2970d4(0x203)](_0xadfd8b)!=-0x1;_0xa7f41f?_0x390b55[_0xadfd8b]=_0x2327ee['reduce']((_0x3308d7,_0x20c552)=>Math[_0x2970d4(0x22e)](_0x3308d7,_0x20c552[_0xadfd8b]),0x0):_0x390b55[_0xadfd8b]=(_0x2327ee[_0x2970d4(0x1f4)]((_0x33bc0b=0x0,_0x17dcf9)=>_0x33bc0b+(_0x17dcf9[_0xadfd8b]||0x0),0x0)/_0x2327ee['length'])[_0x2970d4(0x280)](0x3),_0x390b55[_0xadfd8b]>0x64&&(_0x390b55[_0xadfd8b]=parseInt(_0x390b55[_0xadfd8b]));});const _0x239c95=_0x2327ee[_0xb74e89(0x207)](-0x1)[0x0]['x'];_0x390b55['x']=_0x239c95-_0x239c95%_0x1a67a3;}const _0x1634f5=_0x390b55['x'];if(!_0x359df0[_0xb74e89(0x2b2)]){const _0x30aa7f={..._0x390b55};_0x359df0['push'](_0x30aa7f);}else while(_0x359df0[_0x359df0[_0xb74e89(0x2b2)]-0x1]['x']<_0x1634f5){const _0x1a46dd={..._0x390b55},_0x9cf92d=_0x359df0[_0x359df0['length']-0x1]['x'];_0x1a46dd['x']=_0x9cf92d-_0x9cf92d%_0x1a67a3+_0x1a67a3,_0x359df0[_0xb74e89(0x214)](_0x1a46dd);}return console[_0xb74e89(0x23b)](_0x41351e,_0xb74e89(0x1f1),_0x2327ee,_0x390b55),_0x359df0[_0xb74e89(0x2b2)]>_0x799ce4&&_0x359df0[_0xb74e89(0x2c5)](0x0,_0x359df0[_0xb74e89(0x2b2)]-_0x799ce4),_0x1aec87[_0xb74e89(0x2b2)]>_0x799ce4&&_0x1aec87['splice'](0x0,_0x1aec87['length']-_0x799ce4),_0x2327ee;}function updateTrendTracking(_0x2efb32,_0x1a01cf,_0x4b5b7e={},_0x240ec8,_0x188351){const _0x52963c=_0x26d228,_0xee95e=_0x1a01cf['getFullYear'](),_0x2d17b3=_0x1a01cf[_0x52963c(0x23e)](),_0x204e70=_0x1a01cf[_0x52963c(0x1cb)](),_0x9fcf12=_0x1a01cf['getHours'](),_0x225a33=_0x1a01cf[_0x52963c(0x245)](),_0x47ecde={};let {fine:fine=[],hourly:hourly=[],minutes:minutes=[],daily:daily=[],monthly:monthly=[],yearly:yearly=[]}=_0x2efb32;const {minute:_0x1d51ea,hour:_0xed22ea,day:_0x449714,month:_0x44ac51,year:_0x4823ca}=_0x2efb32[_0x52963c(0x2a2)],_0x56d5b4=_0x1d51ea!==_0x225a33&&fine['length'],_0x21d3cd=_0xed22ea!==_0x9fcf12&&minutes['length'],_0x2608ca=_0x449714!==_0x204e70&&hourly[_0x52963c(0x2b2)],_0x6a9464=_0x44ac51!==_0x2d17b3&&daily['length'],_0x7bfe2e=_0x4823ca!==_0xee95e&&monthly[_0x52963c(0x2b2)];return _0x2efb32[_0x52963c(0x2a2)]={'minute':_0x225a33,'hour':_0x9fcf12,'day':_0x204e70,'month':_0x2d17b3,'year':_0xee95e},_0x7bfe2e&&(rollupTrendPoints(monthly,yearly,_0x52963c(0x23d),_0x188351,_0x240ec8),_0x47ecde['monthly']=_0x47ecde[_0x52963c(0x1ff)]=!![]),_0x6a9464&&(rollupTrendPoints(daily,monthly,_0x52963c(0x228),_0x188351,_0x240ec8),_0x47ecde['daily']=_0x47ecde[_0x52963c(0x23d)]=!![]),_0x2608ca&&(rollupTrendPoints(hourly,daily,'hourly',_0x188351,_0x240ec8),_0x47ecde[_0x52963c(0x2c1)]=_0x47ecde['daily']=!![]),_0x21d3cd&&(rollupTrendPoints(minutes,hourly,_0x52963c(0x1a6),_0x188351,_0x240ec8),_0x47ecde[_0x52963c(0x1a6)]=_0x47ecde[_0x52963c(0x2c1)]=!![]),_0x2efb32[_0x52963c(0x1f5)][_0x52963c(0x214)](_0x4b5b7e),_0x56d5b4&&rollupTrendPoints(fine,minutes,_0x52963c(0x1f5),_0x188351,_0x240ec8),{'trends':_0x2efb32,'updated':_0x47ecde};}let kilowattsConsumed=0x0,minerCheckCompleted=!![];const SITE_STATE_NORMAL=0x1,SITE_STATE_OUTAGE=0x2,SITE_STATE_UNKNOWN=0x3,getTempStateName=function(_0x36f068,_0x47d9fa){const _0x301712=_0x26d228;_0x47d9fa=_0x47d9fa||{'hot':0x5a,'warm':0x50,'mild':0x46};if(_0x36f068>=_0x47d9fa[_0x301712(0x282)])return _0x301712(0x282);else{if(_0x36f068>=_0x47d9fa[_0x301712(0x2e2)])return _0x301712(0x2e2);else{if(_0x36f068>=_0x47d9fa[_0x301712(0x216)])return _0x301712(0x216);else{if(_0x36f068==0x0)return'dead';}}}return'cool';};function _0x4352(){const _0x562091=['apiVersion','Not\x20assigned.','rebooting','SyncState\x20of\x20','includes','Miner\x20status\x20request\x20failed\x20during\x20scan\x20for\x20','warm','getModel','Kernel\x20log\x20request\x20failed\x20during\x20scan\x20for\x20','8ibmEaK','../../common/utilities/miner-settings','upsert','update','Not\x20rebooting\x20','Rebooting\x20','test','.\x20no\x20poolIDs\x20saved.\x20','scan','enableManagedClocking','m,\x20bootElapsedMinutes=','\x20seconds.\x20Consuming\x20','cardFailureChains',']\x20in\x20','Miner\x20pools\x20NOT\x20overwritten\x20for\x20','conditionPrime','overclock','m,\x20offlineTimestamp=','Miner\x20diagnostic','fan1','Miner\x20pools\x20set.','forEach',',\x20shouldBeHashingByNow=','catch','Miner\x20pools\x20NOT\x20set.','Skipping\x20miner\x20pool\x20configuration\x20for\x20[','\x20to\x20trigger\x20add\x20to\x20deployments\x20list','temperatures','model','oldWorkerName','Miner\x20status\x20check\x20completed\x20for\x20','Discover\x20miners\x20initiated!\x20Scanning\x20network\x20using\x20','1781960BsRWgE',',\x20step:\x20','Broadcast\x20activity\x20by\x20miner\x20at\x20[','isArray','../../common/utilities/data-center','clockSettings','toString','booting',']\x20not\x20found\x20in\x20the\x20configuration','minutes','Not\x20uploading\x20OC\x20firmware\x20','v\x20from\x20:','all','create','skipped','\x20miners\x20in\x20','logStates','Configured\x20','Broadcast\x20by\x20miner\x20','placement','inactiveAlarmPercentage','historical','get-ip-range','initial','ipAddress','[provision]\x20System\x20info\x20request\x20failed\x20during\x20provisionJob\x20for,\x20','Unable\x20to\x20sync\x20configuration\x20for\x20','erroring','lastAccess','Miner\x20pools\x20overwritten\x20for\x20','placement.hall\x20DESC','Detected','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20,\x20initElapsedMinutes=','\x20<>\x20','live','floor','./dhcp-server','\x20miner\x20[','rejecting','conditionUltimate','Retrieve\x20network\x20diagnostic\x20failed\x20for\x20','\x20from\x20\x20to\x20','toLocaleString','index','./miner-proxy','then','getDay','hashRate','Overwriting\x20accountName\x20for\x20','statusCode','timestamp','util','ceil','Overwriting\x20workerName\x20for\x20','sysInfo','exports',',\x20isOverRejecting=','\x20Status\x20code:\x20','action','n/a','configured','19326fmzQYt',',\x20shouldLogFailingMiners=','useArpTable','discoverMiners\x20request\x20timed\x20out:','poolIDs','uri',',\x20for\x20','router','NETWORK_DIAGNOSTIC','stalled','failed','167445BIwdYn',',\x20lastEffectiveHashingTime=',',\x20cab:\x20','\x20miners.\x20Power\x20consumed\x20','placement.rack\x20ASC','Configured\x20Update\x20not\x20required\x20',',\x20since\x20','\x20kw','\x27tcp\x20detection\x27.',',\x20power\x20available:\x20','discoverStartTime','runtimeState','Trend\x20archiving','enableStaticIP',',\x20liveMinerState\x20(','reduce','fine','Miner\x20status\x20check\x20skipped\x20one\x20time\x20to\x20avoid\x20multiple\x20concurrent\x20scans.','8.8.8.8','].\x20Provisioning\x20required.','stack','enablePoolConfiguration','Settings\x20update\x20requested\x20for\x20','error',']\x20pool\x20update.\x20(Check\x20config!)','./slack-messaging','yearly','stringify','assign','success','indexOf','Updating\x20ipAddress\x20for\x20',',\x20to:\x20',',\x20isErroring=','slice','Failing\x20miner\x20','configure','workerName','now','latestStableFirmware','clockFrequencyCap','Batch\x20sync\x20size\x20is\x20','ipAddresses','minerType','OPEN',',\x20\x20','\x20at\x20[','push','frequency','mild','discovery','volts','\x20for\x20miner\x20','lodash','username','Email\x20sent:','Discovered\x20miner\x20','groupBy','join','m.\x20\x20fans:[','658hphBbQ',']\x20name\x20','),\x20minerSystemInfo(',',\x20tryRebooting=','workerProperties','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20,\x20isStalled=','failing','daily','miner-utils','log','Miner\x20pools\x20overwrite\x20failed\x20for\x20','discoverMiners\x20error:','Adjusting\x20the\x20clocking\x20cap\x20for\x20','max','\x20offline!','status','.\x20apiVersion:','slack','round','lastEffectiveHashingTime','\x20miners\x20not\x20found\x20at\x20','none','2569059nZULpZ','ignored','offlineTimestamp','down','debug','),\x20minerDiagnostic(','monthly','getMonth','unknown','Unable\x20to\x20determine\x20workerName\x20during\x20new\x20miner\x20pool\x20update','positioned','Miner\x20status','elapsed','modelType','getMinutes','Candidate\x20for\x20miner\x20pools\x20update\x20for\x20','loopback','hashing','Invalid\x20minerType!','Setting\x20deployedOn\x20for\x20','Configuring\x20aborted\x20due\x20to\x20unknown\x20minerType:','\x20@\x20','.\x20no\x20poolIDs\x20saved.','configureMode','4jWKJCc','Miner\x20status\x20check\x20skipped\x20during\x20','locationID','../../common/config','clockingFirmware','198222lwAUke','20535nLjzZx','findIndex','abort','minerInfo','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20,\x20hasInitialized=','rebootTimes','keys','Miner\x20system\x20info',',\x20hashRatePeriodPercent:\x20','user','\x20from\x20','System\x20info\x20request\x20failed\x20during\x20scan\x20for\x20','),\x20minerInfo(','destroyed','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20,\x20isRunningCool=','./ws-server','promise-limit','filter','),\x20logStates(','find','trends','enabled',',\x20isOverHeating=','\x09\x20(','M,\x20','accountName','ping','softwareVersion','accepted','firmwareFileName','miners','locationName','hall','warn',',\x20volts:','Failing\x20miner,\x20','every','Adjust\x20clock:\x20Keep\x20state\x20for\x20miner\x20','],\x20at:','Not\x20assigned','Settings\x20update\x20requested\x20for\x20repositioning',',\x20cap:\x20','196XjTWQh','toFixed','toLowerCase','hot','count','save','\x20at\x20','Adjust\x20clock\x20factors\x20for\x20','\x27arp-scan\x27.','Uploading\x20firmware\x20','Unable\x20to\x20extract\x20pools\x20for\x20unregistered\x20miner\x20system\x20info\x20for\x20','Overwriting\x20firmwareFileName\x20for\x20','hardwareErrors','shift','persistLogs','Configuration\x20not\x20required\x20','\x20minutes,\x20staying\x20at\x20:','\x20to\x20','Sync\x20miner\x20configuration\x20for\x20','settingsInfo',']\x20failed.','],\x20during\x20discovery.\x20(Edit\x20config\x20to\x20force\x20override!)',',\x20isStruggling=','Scan\x20results\x20received\x20for\x20','\x20minutes,\x20to\x20','.log','provisionStatus','replace','Unable\x20to\x20sync\x20incorrect\x20configuration\x20for\x20','broadcast','Skipped\x20miner\x20[','\x20from:\x20','\x20Unauthorized.\x20Password\x20incorrect?','571329JQLMdT','consumption','lastEvent','diagnostic','destroy','(m)v\x20from:\x20','Pool\x20info\x20not\x20available\x20in\x20minerInfo\x20collection\x20for\x20\x20','workerTypeNumber','condition','Adjust\x20failure\x20for\x20miner\x20','Miner\x20log\x20states','netmask','sort','env','clocking','enableSSH',']\x20detected.','Adjust\x20clock:\x20Update\x20state\x20for\x20miner\x20','length','],\x20cab:\x20','tempHot','match','rebooted','degrading','SSH_PORT_STATE','],\x20hashrates:[','options','persistedLog',',\x20isFailing=','pools','hashRatePeriodicAverage','].\x20Miner\x20type\x20[','dhcpSettings','hourly','trace','rack','macAddress','splice','sshEnabled','temperatureState','message','networkScanInterval','map','avg','startTime','sortBy','\x20clock\x20','Debounced\x20miner\x20pools\x20update\x20\x20[','updateFirmware','firmwareUpdate','parse','rejected','setting','debounce','\x20/\x20','name','reset','hashRateAvg','endTime','Rack\x20position\x20update\x20['];_0x4352=function(){return _0x562091;};return _0x4352();}async function syncMinerStatusJob(_0x1dcf30,_0x2534e2,_0x2a11e6=![]){const _0x45cb96=_0x26d228;let {ipAddress:_0x254578,workerName:_0x2ca41d,accountName:_0x3e1ffb,macAddress:_0x103784,placement:_0x54d817}=_0x1dcf30,_0x3d029b=getMinerTypeMap(_0x1dcf30),_0x4b6d4e=deriveApiVersion({'minerInfo':_0x1dcf30,'minerTyped':_0x3d029b});const {name:_0x5c9197,code:_0x47d289,version:_0x4bb9fb,model:_0x57850c,brand:_0x5a0611}=_0x3d029b;Object[_0x45cb96(0x201)](_0x1dcf30,{'name':_0x5c9197,'code':_0x47d289,'version':_0x4bb9fb,'model':_0x57850c,'brand':_0x5a0611});if(isBatchOperation||!_0x254578)return!![];let _0x11e2f7=await getMinerSystemInfo({'ipAddress':_0x254578,'minerTyped':_0x3d029b,'apiVersion':_0x4b6d4e,'maxSockets':0x32})[_0x45cb96(0x194)](_0x3c5963=>{const _0x4f6dbc=_0x45cb96;let _0x3f85fd=_0x4f6dbc(0x260)+_0x2ca41d+',\x20'+_0x254578+_0x4f6dbc(0x231)+_0x4b6d4e;console[_0x4f6dbc(0x23b)](_0x3f85fd,inspect(_0x3c5963,![],0x5,!![]),_0x3d029b),console[_0x4f6dbc(0x276)](_0x3f85fd);});console[_0x45cb96(0x23b)](_0x45cb96(0x25c),inspect(_0x11e2f7));_0x11e2f7&&(!_0x11e2f7[_0x45cb96(0x210)]&&(console[_0x45cb96(0x276)]('getMinerSystemInfo\x20returned\x20undefined\x20minerType',_0x11e2f7),delete _0x11e2f7[_0x45cb96(0x210)],delete _0x11e2f7[_0x45cb96(0x244)]),_0x1dcf30=Object[_0x45cb96(0x201)](_0x1dcf30,_0x11e2f7));let _0x1f009a=null,_0xf37986=null,_0x124e08=null;_0x2a11e6&&(_0x1f009a=await getMinerStatus({'ipAddress':_0x254578,'minerTyped':_0x3d029b,'apiVersion':_0x4b6d4e,'maxSockets':0xa})['catch'](_0x36ddba=>{const _0x26dcce=_0x45cb96;if(!/ETIMEDOUT/[_0x26dcce(0x2eb)](_0x36ddba[_0x26dcce(0x2c8)])){let _0x351281=_0x26dcce(0x2e1)+_0x2ca41d+',\x20'+_0x254578+_0x26dcce(0x231)+_0x4b6d4e;console[_0x26dcce(0x23b)](_0x351281,inspect(_0x36ddba,![],0x5,!![]),_0x3d029b),console[_0x26dcce(0x276)](_0x351281);}return null;}),console[_0x45cb96(0x23b)](_0x45cb96(0x242),inspect(_0x1f009a)),_0xf37986=await getKernelLogs({'minerInfo':_0x1dcf30,'minerTyped':_0x3d029b,'apiVersion':_0x4b6d4e,'maxSockets':0xa})[_0x45cb96(0x194)](_0x26fa29=>{const _0xdb701=_0x45cb96;if(!/ETIMEDOUT/[_0xdb701(0x2eb)](_0x26fa29[_0xdb701(0x2c8)])){let _0x4c9242=_0xdb701(0x2e4)+_0x2ca41d+',\x20'+_0x254578+_0xdb701(0x231)+_0x4b6d4e;console['debug'](_0x4c9242,inspect(_0x26fa29,![],0x5,!![]),_0x3d029b),console[_0xdb701(0x276)](_0x4c9242);}return null;}),console[_0x45cb96(0x23b)](_0x45cb96(0x2aa),inspect(_0xf37986)),dataCenterSettings['enableNetworkLatencyCheck']&&(_0x124e08=await retrieveMinerNetworkDiagnostics({'minerInfo':_0x1dcf30,'diagnostic':diagnostic,'minerTyped':_0x3d029b,'apiVersion':_0x4b6d4e})['catch'](_0xd983bb=>{const _0x4cf2c5=_0x45cb96;if(!/(404|EHOSTUNREACH|ENOTFOUND)/[_0x4cf2c5(0x2eb)](_0xd983bb[_0x4cf2c5(0x2c8)])){let _0x2d252e=_0x4cf2c5(0x1c5)+_0x1dcf30[_0x4cf2c5(0x20a)]+',\x20'+_0x254578+_0x4cf2c5(0x231)+_0x4b6d4e;console['debug'](_0x2d252e,inspect(_0xd983bb,![],0x5,!![]),_0x3d029b),console[_0x4cf2c5(0x276)](_0x2d252e);}return null;}),console[_0x45cb96(0x23b)](_0x45cb96(0x18f),inspect(_0x124e08))));const {pools:_0x2c3cb3,cardStatus:_0x38571d,workerTypeNumber:_0xd83a3a,timestamp:_0x396d40,..._0x320a1a}=_0x1f009a||{'workerName':_0x1dcf30[_0x45cb96(0x20a)]};console[_0x45cb96(0x23b)]({'logType':_0x45cb96(0x2c2)},_0x45cb96(0x296)+_0x2ca41d+_0x45cb96(0x212)+_0x254578+_0x45cb96(0x1f3)+!!_0x1f009a+_0x45cb96(0x267)+!!_0xf37986+_0x45cb96(0x223)+!!_0x11e2f7+_0x45cb96(0x261)+!!_0x1dcf30+_0x45cb96(0x23c)+!!_0x124e08+')'),registerProxy({'workerName':_0x2ca41d,'accountName':_0x3e1ffb,'macAddress':_0x103784,'ipAddress':_0x254578,'minerTyped':_0x3d029b,'apiVersion':_0x4b6d4e});const _0x53bb29=new Date(),_0xe5184a=Date['parse'](_0x53bb29);if(!_0x1f009a){invalidMiners[_0x103784]={'accountName':_0x3e1ffb,'workerName':_0x2ca41d,'ipAddress':_0x254578,'macAddress':_0x103784,'placement':_0x54d817},invalidMiners[_0x103784][_0x45cb96(0x230)]='inactive',deadMiners[_0x103784]=invalidMiners[_0x103784];if(!_0x1dcf30[_0x45cb96(0x2a8)])_0x1dcf30[_0x45cb96(0x2a8)]={'hashRate':0x0,'hashRateAvg':0x0,'accountName':'','poolName':'','temperatures':[0x0],'frequency':0x0,'pools':[]};else!_0x1dcf30[_0x45cb96(0x2a8)]['offlineTimestamp']&&(_0x1dcf30[_0x45cb96(0x2a8)]['hashRate']=0x0,_0x1dcf30['condition'][_0x45cb96(0x2d9)]=0x0,_0x1dcf30[_0x45cb96(0x2a8)][_0x45cb96(0x239)]=_0x53bb29);return trackTrends(_0x1dcf30,_0x53bb29,_0x2534e2),{'upsertedMiner':await upsertMinerInfo({'minerInfo':_0x1dcf30}),'state':invalidMiners[_0x103784][_0x45cb96(0x230)]};}_0x1f009a[_0x45cb96(0x1cf)]=_0x53bb29,_0x1f009a[_0x45cb96(0x2a3)]=_0x124e08||{};let {cardFailureChains:_0x414706,temperatures:_0x3677be,intakeSpeed:_0x566e13,exhaustSpeed:_0x140598,..._0xfa1822}=_0x1f009a;delete _0xfa1822['cardStatus'];const {condition:_0x23b175,conditionPrime:_0x549d44}=_0x1dcf30;!_0x549d44&&(_0x1dcf30[_0x45cb96(0x18c)]=_0xfa1822);_0x1dcf30[_0x45cb96(0x1ad)]=_0xf37986||{};if(!_0x23b175||!_0x23b175[_0x45cb96(0x2bd)])return _0x1dcf30[_0x45cb96(0x2a8)]=_0x1f009a,{'upsertedMiner':await upsertMinerInfo({'minerInfo':_0x1dcf30}),'state':_0x45cb96(0x1b4)};trackTrends(_0x1dcf30,_0x53bb29,_0x2534e2);const {poolsAreDifferent:_0x2d07bb,remotesPools:_0x52eadf,poolsConfig:_0x14eea8,workerName:_0x4454ae}=await validateMinerConfig({'minerInfo':_0x1dcf30,'apiVersion':_0x4b6d4e,'dataCenterSettings':dataCenterSettings,'isBulk':!![]});if(_0x2d07bb){if(_0x1dcf30[_0x45cb96(0x1de)]){const {poolIDs:_0x1a297a}=_0x1dcf30;console[_0x45cb96(0x23b)](_0x45cb96(0x291)+_0x2ca41d+',\x20\x20'+_0x254578,_0x52eadf,_0x14eea8);}else{let {url:url='n/a',user:user=_0x45cb96(0x1d8)}=_0x52eadf[_0x45cb96(0x2bd)][0x0]||{},{stratum:stratum=_0x45cb96(0x1d8),username:username=_0x45cb96(0x1d8)}=_0x14eea8[_0x45cb96(0x2bd)][0x0]||{};url=url[_0x45cb96(0x29a)](/.*:\/\//,''),stratum=stratum[_0x45cb96(0x29a)](/.*:\/\//,''),url==stratum&&user==username?console['debug'](_0x45cb96(0x1b7)+_0x2ca41d+_0x45cb96(0x212)+_0x254578+_0x45cb96(0x24d),_0x4454ae,_0x52eadf,_0x14eea8):console['debug'](_0x45cb96(0x29b)+_0x2ca41d+',\x20\x20'+_0x254578+_0x45cb96(0x2ec)+user+_0x45cb96(0x24c)+url+_0x45cb96(0x1be)+username+_0x45cb96(0x24c)+stratum);}}const _0x52a164=!isNaN(_0x1f009a[_0x45cb96(0x243)])?parseInt(_0x1f009a[_0x45cb96(0x243)]):0x0,_0xa36bae=_0x1f009a[_0x45cb96(0x2d9)]||0x0,_0x36c858=_0x1f009a[_0x45cb96(0x1cc)],_0x5a38da=_0x1dcf30['condition']['hashRate']||0x0,_0x36bd15=_0x1dcf30[_0x45cb96(0x2a8)][_0x45cb96(0x271)];let _0x4d20b7=parseInt(_0x1dcf30[_0x45cb96(0x18c)][_0x45cb96(0x2d9)]||0x0);const _0x99cd4=_0x1dcf30[_0x45cb96(0x1c4)]?parseInt(_0x1dcf30[_0x45cb96(0x1c4)][_0x45cb96(0x2d9)]):'-',{intakeFanName:intakeFanName=_0x45cb96(0x190),exhaustFanName:exhaustFanName=_0x45cb96(0x190),minFanSpeed:_0xd25ec7,tempBoundaries:_0x9ed91f}=_0x3d029b;_0x566e13=parseInt(_0x1f009a['intakeSpeed']||'0',0xa),_0x140598=parseInt(_0x1f009a['exhaustSpeed']||'0',0xa);const _0x13721c=Math[_0x45cb96(0x233)](_0x36c858/(_0x4d20b7||_0x36c858||0x1)*0x32)*0x2,_0x18ac5e=Math['round'](_0x36c858/(_0x1dcf30[_0x45cb96(0x2be)]||_0x36c858||0x1)*0x64),_0x2be28e=parseInt(_0x52a164/0x6)/0xa,_0x4eaf38=_0x2be28e>MINER_BOOT_CHECK_MINUTES,_0x24a456=_0x1dcf30[_0x45cb96(0x25a)]?_0x1dcf30[_0x45cb96(0x25a)]['slice'](-0x1)[0x0]:{},_0x23933d=_0x24a456[_0x45cb96(0x1cf)]||_0x1dcf30[_0x45cb96(0x234)]||_0x53bb29,_0x269a1b=parseInt((_0xe5184a-Date[_0x45cb96(0x2d2)](_0x23933d))/(0x3c*0x3e8)),_0x2bf7c9=_0x269a1b>MINER_BOOT_MAX_MINUTES,_0x30d151=_0x269a1b>MINER_LOG_FAILING_MINUTES,_0x348406=!_0x4eaf38&&_0x2be28e>0x0;let _0x38a171=!_0x4eaf38&&_0x5a38da<0x1&&_0x36c858<0x1&&!_0x140598&&!_0x566e13,_0x39ca27=![],_0x317ca5=![],_0x5c032b=![];_0x2bf7c9&&!_0x348406&&(_0x38a171?(_0x39ca27=!![],_0x38a171=![]):_0x39ca27=parseInt(_0x36c858)==parseInt(_0x5a38da)&&_0x1f009a[_0x45cb96(0x271)]==_0x36bd15||_0x13721c==Infinity,_0x317ca5=_0x18ac5e<struggleHighCheckPercent&&_0x13721c<struggleHighCheckPercent,_0x5c032b=_0x13721c<failureMinCheckPercent);let _0x5a2e3b=![];if(_0x39ca27&&_0x1dcf30[_0x45cb96(0x234)]&&_0x1dcf30['firmwareFileName']){const _0x4cf75f=_0x1dcf30[_0x45cb96(0x234)],_0x5c592a=0x2*0x3c*0x3c*0x3e8,_0x63e2f7=Math[_0x45cb96(0x1d1)](_0x5c592a/dataCenterSettings[_0x45cb96(0x2c9)]),_0x59a624=parseInt((_0xe5184a-Date[_0x45cb96(0x2d2)](_0x4cf75f))/dataCenterSettings[_0x45cb96(0x2c9)]);_0x5a2e3b=_0x59a624%_0x63e2f7==0x0;}var _0x2afebe=![];if(_0x1f009a[_0x45cb96(0x2d3)]){let _0x194fe4=(_0x1f009a[_0x45cb96(0x2d3)]||0x0)/(_0x1f009a[_0x45cb96(0x271)]||0x1);_0x2afebe=_0x194fe4>MAX_REJECTED_RATE;}let _0x320381=(_0x1f009a[_0x45cb96(0x28b)]||[0x0])[_0x45cb96(0x1f4)](intAdder,0x0),_0x3b5360=parseInt(_0x320381/((_0x1f009a[_0x45cb96(0x243)]||0x1)/0x3c)),_0x34bef3=!_0x3d029b['overclock']?![]:_0x3b5360>(_0x3d029b[_0x45cb96(0x18d)]['maxChipErrorRate']||MAX_CHIP_ERROR_RATE),_0x1f5841=![],_0x411e36=![];if(Array[_0x45cb96(0x1a0)](_0x1f009a[_0x45cb96(0x198)])&&_0x1f009a['temperatures'][0x0]){let _0x2a63be=Math[_0x45cb96(0x22e)](..._0x1f009a[_0x45cb96(0x198)]||[0x0]);const _0x120635=getTempStateName(_0x2a63be,_0x9ed91f);_0x1f5841=/^hot$/i[_0x45cb96(0x2eb)](_0x120635),_0x411e36=/^(mild|cool)$/i[_0x45cb96(0x2eb)](_0x120635),_0x1f009a[_0x45cb96(0x2c7)]=_0x120635;}wattsConsumedTally+=isNaN(_0x1f009a[_0x45cb96(0x2a1)])?0x0:parseFloat(_0x1f009a['consumption'],0xa);if(_0x1f009a[_0x45cb96(0x2f1)]&&_0x1f009a[_0x45cb96(0x2f1)][_0x45cb96(0x2b2)]){}if(!_0x39ca27&&_0x566e13<(_0xd25ec7||MIN_VIABLE_FAN_SPEED)){}if(!_0x39ca27&&_0x140598<(_0xd25ec7||MIN_VIABLE_FAN_SPEED)){}_0x1dcf30[_0x45cb96(0x2a8)]=_0x1f009a;_0x1f009a[_0x45cb96(0x26e)]&&(_0x1dcf30[_0x45cb96(0x26e)]=_0x1f009a[_0x45cb96(0x26e)]);_0x1f009a[_0x45cb96(0x20a)]&&(_0x1dcf30[_0x45cb96(0x20a)]=_0x1f009a[_0x45cb96(0x20a)]);_0x1f009a[_0x45cb96(0x2a7)]&&(_0x1dcf30['workerTypeNumber']=_0x1f009a[_0x45cb96(0x2a7)]);if(currentSiteState===SITE_STATE_UNKNOWN){elapsedTally+=_0x52a164,++minersScannedCount;if(elapsedTally/minersScannedCount>dataCenterSettings[_0x45cb96(0x2c9)]/0x1f4)currentSiteState=SITE_STATE_NORMAL;else minersScannedCount>minerCount*0.2&&(initiatePowerRampUp=!![],currentSiteState=SITE_STATE_OUTAGE);}!_0x2bf7c9&&(_0x4d20b7=_0x4d20b7*0.8);if(_0x36c858>_0x4d20b7||isNaN(_0x5a38da)){const {cardStatus:_0x49e164,cardFailureChains:_0x29c726,temperatures:_0x518fe5,intakeSpeed:_0x5b58e8,exhaustSpeed:_0x215960,..._0x5a529f}=_0x1f009a;_0x1dcf30['conditionPrime']=_0x5a529f;const {pools:_0x59ffa5,..._0x2a54e5}=_0x5a529f;if(!_0x1dcf30[_0x45cb96(0x1c4)])_0x1dcf30['conditionUltimate']=_0x2a54e5;else _0x36c858>(_0x1dcf30[_0x45cb96(0x1c4)][_0x45cb96(0x1cc)]||_0x1dcf30[_0x45cb96(0x1c4)][_0x45cb96(0x2d9)]||0x0)&&(_0x1dcf30['conditionUltimate']=_0x2a54e5);}const _0x2ab930={'accountName':_0x3e1ffb,'workerName':_0x2ca41d,'ipAddress':_0x254578,'macAddress':_0x103784,'placement':_0x54d817};_0x13721c<0x5&&(deadMiners[_0x103784]=_0x2ab930);let _0x1652d2='',_0x2f8067=![],_0x425607=![];if(_0x38a171)_0x1652d2=MINER_STATE_BOOTING;else{if(_0x2bf7c9){if(_0x39ca27)_0x1652d2=MINER_STATE_STALLED;else{if(_0x317ca5)_0x1652d2=MINER_STATE_STRUGGLING;else{if(_0x5c032b)_0x1652d2=MINER_STATE_FAILING;else{if(_0x2afebe)_0x1652d2=MINER_STATE_REJECTING;else _0x34bef3&&(_0x1652d2=MINER_STATE_ERRORING);}}}_0x2f8067=_0x317ca5||_0x5c032b||_0x39ca27,_0x425607=!!_0x1652d2;}else!_0x2f8067?_0x1652d2=MINER_STATE_NORMAL:_0x1652d2=MINER_STATE_DEGRADING;}_0x1652d2&&(_0x1dcf30['runtimeState']=_0x1652d2);let _0x4afb22=_0x411e36&&hasAvailablePower&&_0x2be28e>MINER_OC_INTERVAL_MINUTES;const _0x2a8770=!!(_0x3d029b[_0x45cb96(0x18d)]&&_0x1dcf30[_0x45cb96(0x2ee)]&&(initiatePowerRampUp||_0x34bef3||_0x1f5841||_0x4afb22));console[_0x45cb96(0x23b)]('Miner\x20state['+_0x1652d2+']\x20'+_0x2ca41d+',\x20'+_0x254578+':,\x20hashRatePercent:\x20'+_0x13721c+_0x45cb96(0x25d)+_0x18ac5e+'%\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20hasAvailablePower='+hasAvailablePower+_0x45cb96(0x224)+_0x425607+',\x20shouldAdjustClock='+_0x2a8770+',\x20isReUpload='+_0x5a2e3b+_0x45cb96(0x263)+_0x411e36+_0x45cb96(0x26b)+_0x1f5841+',\x20initiatePowerRampUp='+initiatePowerRampUp+_0x45cb96(0x206)+_0x34bef3+_0x45cb96(0x259)+_0x4eaf38+_0x45cb96(0x193)+_0x2bf7c9+_0x45cb96(0x1db)+_0x30d151+_0x45cb96(0x226)+_0x39ca27+_0x45cb96(0x295)+_0x317ca5+_0x45cb96(0x1d5)+_0x2afebe+_0x45cb96(0x2bc)+_0x5c032b+_0x45cb96(0x1bd)+_0x2be28e+_0x45cb96(0x2ef)+_0x269a1b+_0x45cb96(0x18e)+_0x1dcf30['offlineTimestamp']+_0x45cb96(0x1e6)+_0x1dcf30['lastEffectiveHashingTime']);const _0xd5b574=_0x3e1ffb+'.'+_0x2ca41d+'\x20['+_0x254578+',\x20'+_0x103784+']\x20in\x20'+_0x1652d2+',\x20live:\x20'+_0x2be28e+'m,\x20on:\x20'+_0x269a1b+_0x45cb96(0x220)+_0x566e13+',\x20'+_0x140598+_0x45cb96(0x2b9)+parseInt(_0x36c858)+',\x20'+_0x4d20b7+',\x20'+_0x99cd4+_0x45cb96(0x27b)+_0x13721c+'%,\x20period:'+_0x18ac5e+'%';validMiners[_0x103784]={'logText':_0xd5b574,'accountName':_0x3e1ffb,'workerName':_0x2ca41d,'ipAddress':_0x254578,'macAddress':_0x103784,'placement':_0x54d817};if(_0x2a8770){delete alertableMiners[_0x103784];_0x34bef3&&(_0x4afb22=![]);const _0xbdba33=initiatePowerRampUp?-0x9:_0x4afb22?0x1:-0x1,_0x9ea049=getOptimumClockSettings(_0x1dcf30,_0x1f009a,_0x3d029b,_0xbdba33),{condition:_0x5f14de,conditionPrime:_0x804163,clockSettings:_0xaa7c90}=_0x1dcf30,_0x4046bb=_0x5f14de[_0x45cb96(0x2bd)]&&_0x5f14de[_0x45cb96(0x2bd)]['length']?_0x5f14de[_0x45cb96(0x2bd)]:_0x804163[_0x45cb96(0x2bd)],_0x51061b=_0xaa7c90||{},_0x47e358=_0x9ea049[_0x45cb96(0x215)]&&_0x4046bb&&_0x4046bb[_0x45cb96(0x2b2)];_0x9ea049[_0x45cb96(0x215)]?console[_0x45cb96(0x23b)](_0x45cb96(0x2b1)+_0x2ca41d+',\x20'+_0x254578+_0x45cb96(0x1ee)+hasAvailablePower+_0x45cb96(0x1eb)+_0x2be28e+_0x45cb96(0x297)+_0x9ea049[_0x45cb96(0x215)]+','+_0x9ea049[_0x45cb96(0x218)]+_0x45cb96(0x1a8)+_0x51061b[_0x45cb96(0x215)]+','+_0x51061b[_0x45cb96(0x218)]+'v'):console[_0x45cb96(0x23b)](_0x45cb96(0x27a)+_0x2ca41d+',\x20'+_0x254578+',\x20power\x20available:\x20'+hasAvailablePower+_0x45cb96(0x1eb)+_0x2be28e+_0x45cb96(0x28f)+_0x51061b['frequency']+','+_0x51061b['volts']+'v');if(_0x47e358&&(_0x51061b[_0x45cb96(0x215)]!==_0x9ea049[_0x45cb96(0x215)]||_0x51061b['volts']!==_0x9ea049[_0x45cb96(0x218)])){const _0x198184=_0x9ea049,_0x3924f0=_['map'](_0x4046bb,(_0x3826a0,_0x5aedf3)=>{const _0x5d09f3=_0x45cb96;return{'index':_0x5aedf3+0x1,'stratum':_0x3826a0['url'],'username':_0x3826a0[_0x5d09f3(0x25e)],'password':'x'};});return updateMinerSettings({'minerInfo':_0x1dcf30,'minerTyped':_0x3d029b,'pools':_0x3924f0,'minerConfigOptions':_0x198184,'apiVersion':_0x4b6d4e})[_0x45cb96(0x1ca)](async _0x4ccf69=>{const _0x4a0a41=_0x45cb96;if(/\bok\b/i['test'](_0x4ccf69)){_0x1dcf30[_0x4a0a41(0x1f0)]=MINER_STATE_CLOCKING,console[_0x4a0a41(0x22a)]('Adjusted\x20miner\x20'+_0x2ca41d+',\x20'+_0x1dcf30[_0x4a0a41(0x1b5)]+_0x4a0a41(0x2ce)+(_0x9ea049[_0x4a0a41(0x215)]>_0x51061b[_0x4a0a41(0x215)]?'up':_0x4a0a41(0x23a))+_0x4a0a41(0x290)+_0x9ea049[_0x4a0a41(0x215)]+_0x4a0a41(0x26d)+_0x9ea049[_0x4a0a41(0x218)]+_0x4a0a41(0x2a5)+(_0x51061b['frequency']||0x0)+'M,\x20'+(_0x51061b[_0x4a0a41(0x218)]||0x0)+'(m)v'),_0x1dcf30['clockSettings']={..._0x198184},_0x1dcf30['conditionPrime']=null;const _0x594711=!_0x1dcf30['clockFrequencyCap']||parseInt(_0x1dcf30[_0x4a0a41(0x20d)])>_0x9ea049[_0x4a0a41(0x215)];(_0x34bef3||_0x317ca5)&&_0x594711&&(console[_0x4a0a41(0x22a)](_0x4a0a41(0x22d)+_0x2ca41d+_0x4a0a41(0x29e)+_0x1dcf30[_0x4a0a41(0x20d)]+_0x4a0a41(0x205)+_0x9ea049[_0x4a0a41(0x215)]),_0x1dcf30[_0x4a0a41(0x20d)]=_0x9ea049[_0x4a0a41(0x215)]);}else console[_0x4a0a41(0x22a)](_0x4a0a41(0x2a9)+_0x2ca41d+',\x20'+_0x1dcf30[_0x4a0a41(0x1b5)]+'\x20clock\x20to\x20frequency:\x20'+_0x9ea049['frequency']+_0x4a0a41(0x277)+_0x9ea049[_0x4a0a41(0x218)]);return{'upsertedMiner':await upsertMinerInfo({'minerInfo':_0x1dcf30}),'state':_0x1652d2};});}}else{if(_0x5a2e3b){const {firmwareFileName:_0x27dbb5}=_0x1dcf30;if(!/updater/[_0x45cb96(0x2eb)](_0x27dbb5))return console[_0x45cb96(0x22a)](_0x45cb96(0x288)+_0xd5b574),updateMinerFirmware({'minerInfo':_0x1dcf30,'minerTyped':_0x3d029b,'firmwareFileName':_0x27dbb5,'apiVersion':_0x4b6d4e});else console['log'](_0x45cb96(0x1a7)+_0xd5b574);}else{if(_0x425607){if(_0x1dcf30[_0x45cb96(0x1f0)]===MINER_STATE_REBOOTING)console[_0x45cb96(0x22a)]('Rebooted\x20'+_0xd5b574),_0x1dcf30[_0x45cb96(0x1f0)]=MINER_STATE_BOOTING;else{if(_0x2f8067){alertableMiners[_0x103784]=_0x2ab930,_0x1dcf30[_0x45cb96(0x1f0)]=MINER_STATE_REBOOTING;!_0x1dcf30[_0x45cb96(0x25a)]&&(_0x1dcf30[_0x45cb96(0x25a)]=[]);_0x1dcf30[_0x45cb96(0x25a)][_0x45cb96(0x2b2)]>0x14&&_0x1dcf30[_0x45cb96(0x25a)][_0x45cb96(0x28c)]();_0x1dcf30[_0x45cb96(0x18c)]=null,_0x1dcf30[_0x45cb96(0x25a)][_0x45cb96(0x214)]({'reason':_0x1652d2,'timestamp':_0x53bb29,'percentOfPrime':_0x13721c,'liveHashRate':_0x36c858,'liveHashRateAvg':_0xa36bae}),console[_0x45cb96(0x22a)](_0x45cb96(0x2ea)+_0xd5b574);const _0xb6d4ab=upsertMinerInfo({'minerInfo':_0x1dcf30})['then'](()=>getMinerReboot(_0x1dcf30,_0x3d029b,_0x4b6d4e));return{'upsertedMiner':_0xb6d4ab,'state':_0x1dcf30[_0x45cb96(0x1f0)]};}else console[_0x45cb96(0x23b)](_0x45cb96(0x2e9)+_0xd5b574),console[_0x45cb96(0x22a)](_0x45cb96(0x2e9)+_0x3e1ffb+'.'+_0x2ca41d+'\x20['+_0x254578+',\x20'+_0x103784+_0x45cb96(0x18a)+_0x1652d2);}}else{if(_0x1652d2&&_0x1dcf30[_0x45cb96(0x1f0)]!==MINER_STATE_NORMAL)alertableMiners[_0x103784]=_0x2ab930,alertableMiners[_0x103784]['status']=_0x1652d2,_0x30d151&&(console[_0x45cb96(0x22a)](_0x45cb96(0x208)+_0xd5b574),console['debug'](_0x45cb96(0x278)+_0x1652d2+'\x20miner\x20state\x20:'+inspect(_0x320a1a)));else return _0x1dcf30[_0x45cb96(0x234)]=_0x53bb29,delete alertableMiners[_0x103784],{'upsertedMiner':await upsertMinerInfo({'minerInfo':_0x1dcf30}),'state':_0x1652d2};}}}return{'upsertedMiner':await upsertMinerInfo({'minerInfo':_0x1dcf30}),'state':_0x1652d2};}let hasAvailablePower=0x0,wattsConsumedTally=0x0,elapsedTally=0x0,minersScannedCount=0x0,initiatePowerRampUp=![],currentSiteState=SITE_STATE_NORMAL,minerCount=0x0,deadMiners={};async function compareMinerStatus(_0x2b237d,_0x1828fa,_0x1c83d2){const _0xdf697a=_0x26d228,_0x10494e=loopback[_0xdf697a(0x2e3)]('minerInfo'),{availableKilowatts:availableKilowatts=0x0,powerRampUpDisabled:powerRampUpDisabled=![],configureMode:_0x10eaa7}=dataCenterSettings;!kilowattsConsumed&&(kilowattsConsumed=availableKilowatts);hasAvailablePower=!availableKilowatts||availableKilowatts>kilowattsConsumed,wattsConsumedTally=0x0,elapsedTally=0x0,minersScannedCount=0x0,initiatePowerRampUp=![],currentSiteState=powerRampUpDisabled?SITE_STATE_NORMAL:SITE_STATE_UNKNOWN,deadMiners={};let _0xb4e02f=Date['now'](),_0x4e4e4f={};if(_0x2b237d){const {range:_0x4c4220}=_0x2b237d,_0x5b638a=getIPRange(_0x4c4220[0x0],_0x4c4220[0x1]);_0x4e4e4f={'where':{'ipAddress':{'inq':_0x5b638a}}};}const _0x344e8e=await _0x10494e['find'](_0x4e4e4f),_0x3fa796=_0x344e8e[_0xdf697a(0x2ca)](_0x4a1556=>_0x4a1556[_0xdf697a(0x1b5)]),_0x1f9e1d=await getScanCache(_0x2b237d||dataCenterSettings['dhcpSettings'],_0x1828fa,_0x1c83d2,_0x3fa796);if(_0x10eaa7===CONFIGURE_MODE_PROVISION){console['log'](_0xdf697a(0x250)+(_0x10eaa7==CONFIGURE_MODE_DISCOVERY?_0xdf697a(0x217):'provisioning')+'.');return;}if(!minerCheckCompleted){console[_0xdf697a(0x22a)](_0xdf697a(0x1f6)),minerCheckCompleted=!![];return;}minerCheckCompleted=![],minerCount=_0x344e8e[_0xdf697a(0x2b2)];const _0x47e171=Date[_0xdf697a(0x2d2)](new Date())['toString']();console['log']('Miner\x20status\x20check\x20started\x20for\x20'+minerCount+_0xdf697a(0x1e8)+kilowattsConsumed[_0xdf697a(0x1c7)]()+_0xdf697a(0x2d6)+availableKilowatts[_0xdf697a(0x1c7)]()+'\x20kw');const _0x224485={'skipped':[],'live':[]},_0x4b80e9=0x64;while(_0x344e8e[_0xdf697a(0x2b2)]){await Promise['all'](_0x344e8e[_0xdf697a(0x2c5)](0x0,_0x4b80e9)[_0xdf697a(0x2ca)](async _0x203c05=>{const _0x34958e=_0xdf697a;let {ipAddress:_0x2eab2f}=_0x203c05;const _0x5bc706=!_0x2eab2f||!!_0x1f9e1d[_0x2eab2f],{upsertedMiner:_0x557ba5,state:_0x312826}=await syncMinerStatusJob(_0x203c05,_0x47e171,_0x5bc706);console[_0x34958e(0x23b)](_0x34958e(0x2df)+_0x312826+_0x34958e(0x219)+(_0x557ba5?.[_0x34958e(0x1b5)]||_0x2eab2f)),_0x557ba5?(!_0x224485[_0x312826]&&(_0x224485[_0x312826]=[]),_0x224485[_0x312826||_0x34958e(0x1bf)][_0x34958e(0x214)](_0x557ba5?.['ipAddress'])):_0x224485[_0x34958e(0x1ab)][_0x34958e(0x214)](_0x2eab2f);})),console[_0xdf697a(0x23b)](_0xdf697a(0x20e)+_0x4b80e9+'.\x20'+_0x344e8e[_0xdf697a(0x2b2)]+'\x20left\x20to\x20sync');};Object[_0xdf697a(0x25b)](_0x224485)[_0xdf697a(0x192)](_0xbf254a=>{const _0x277f1e=_0xdf697a;_0x224485[_0xbf254a][_0x277f1e(0x2ac)](ipDesc);});if(!_0x224485)return;const _0x24ae33=function(_0x1c5e61){const _0x42f91e=_0xdf697a;reportedDates[_0x1c5e61[_0x42f91e(0x2c4)]]&&reportedDates[_0x1c5e61[_0x42f91e(0x2c4)]]<Date[_0x42f91e(0x20b)]()-notifyTime&&(reportedDates[_0x1c5e61[_0x42f91e(0x2c4)]]=null);if(!reportedDates[_0x1c5e61[_0x42f91e(0x2c4)]])return!![];};let _0x43044f=_['sortBy'](_[_0xdf697a(0x266)](invalidMiners,_0x24ae33),[_0xdf697a(0x26e),'workerName']),_0x2516a5=_['sortBy'](_[_0xdf697a(0x266)](alertableMiners,_0x24ae33),['accountName',_0xdf697a(0x20a)]),_0x305b7d=_[_0xdf697a(0x2cd)](_[_0xdf697a(0x266)](deadMiners,_0x24ae33),(_0x1d17e3={})=>{const {hall:_0x424174,rack:_0x254ab4,shelf:_0x1fc3fd,position:_0x3e6728}=_0x1d17e3['placement']||{};return[_0x424174,_0x254ab4,_0x1fc3fd,_0x3e6728];}),_0x53914b='';const _0x350504=(_0x3a4d14,_0x7292a2)=>{const _0x4a5de6=_0xdf697a;_0x7292a2&&(_0x3a4d14['condition']={});const {accountName:_0x82d677,workerName:_0x8442f2,ipAddress:_0xa9c8b4,macAddress:_0x517c46}=_0x3a4d14;reportedDates[_0x517c46]=Date[_0x4a5de6(0x20b)]();const {hall:_0x5ecdfc,rack:_0xa36ce5,shelf:_0x111ed0,position:_0x5ff6d7}=_0x3a4d14['placement']||{};return _0x82d677+'.'+_0x8442f2+_0x4a5de6(0x285)+_0x5ecdfc+'.'+_0xa36ce5+'.'+_0x111ed0+'.'+_0x5ff6d7+_0x4a5de6(0x26c)+_0xa9c8b4+')';};_0x43044f[_0xdf697a(0x2b2)]&&(_0x53914b+='\x0a['+dataCenterSettings[_0xdf697a(0x251)]+']\x20'+_0x43044f[_0xdf697a(0x2b2)]+_0xdf697a(0x235)+dataCenterSettings[_0xdf697a(0x274)]+'.\x0a',_0x53914b+=_[_0xdf697a(0x2ca)](_0x43044f,_0x30fcea=>_0x350504(_0x30fcea,!![]))['join']('\x0a'));_0x2516a5['length']&&(_0x53914b+='\x0a['+dataCenterSettings[_0xdf697a(0x251)]+']\x20'+_0x2516a5[_0xdf697a(0x2b2)]+'\x20miners\x20are\x20failing\x20at\x20'+dataCenterSettings[_0xdf697a(0x274)]+'.\x0a',_0x53914b+=_[_0xdf697a(0x2ca)](_0x2516a5,_0x77d8c2=>_0x350504(_0x77d8c2))[_0xdf697a(0x21f)]('\x0a'));if(_0x305b7d[_0xdf697a(0x2b2)]>minerCount*(dataCenterSettings[_0xdf697a(0x1b1)]||0x2)/0x64){let _0x16032a=dataCenterSettings[_0xdf697a(0x274)]+'.\x20'+_0x305b7d[_0xdf697a(0x2b2)]+_0xdf697a(0x22f);_0x53914b=_['reduce'](_0x305b7d,(_0x3b2f17,_0x151342={})=>{const _0xd2372=_0xdf697a,{hall:hall='',rack:rack='',shelf:shelf='',position:position=''}=_0x151342[_0xd2372(0x1b0)]||{};var _0x2804f5=hall+'.'+rack+'.'+shelf+'.'+position;return _0x2804f5[_0xd2372(0x2b2)]<=0x4&&(_0x2804f5=_0xd2372(0x2dd)),_0x3b2f17+(_0x2804f5+'\x09'+_0x151342[_0xd2372(0x20a)]+'\x0d');},'\x0d'),await offlineMiners({'subject':_0x16032a,'text':_0x53914b})[_0xdf697a(0x194)](_0x397a91=>{const _0x436a6f=_0xdf697a;console[_0x436a6f(0x1fc)]('Unable\x20to\x20send\x20email:',_0x397a91);})['then'](_0x2be933=>{const _0x44073d=_0xdf697a;console['log'](_0x44073d(0x21c),_0x2be933);},_0x176285=>{const _0x195533=_0xdf697a;console[_0x195533(0x1fc)](_0x176285);});}let _0x43c97a=parseInt(Math['round']((Date[_0xdf697a(0x20b)]()-_0xb4e02f)/0x64))/0xa;kilowattsConsumed=parseInt(wattsConsumedTally/0x3e8);const _0x574ab2=_0xdf697a(0x19b)+minerCount+_0xdf697a(0x1ac)+_0x43c97a+_0xdf697a(0x2f0)+kilowattsConsumed['toLocaleString']()+_0xdf697a(0x2d6)+availableKilowatts[_0xdf697a(0x1c7)]()+_0xdf697a(0x1ec);return console[_0xdf697a(0x22a)](_0x574ab2),slackMessage({'text':_0x53914b}),socketSendMiners(_0x224485),minerCheckCompleted=!![],{'message':_0x574ab2,'minerInfoUpserts':_0x224485,'invalids':_0x43044f,'alertables':_0x2516a5,'deadones':_0x305b7d,'validMiners':validMiners,'text':_0x53914b};}function _0x5062(_0x427c60,_0x53841f){const _0x4352a8=_0x4352();return _0x5062=function(_0x5062de,_0x3fcf38){_0x5062de=_0x5062de-0x18a;let _0x26adda=_0x4352a8[_0x5062de];return _0x26adda;},_0x5062(_0x427c60,_0x53841f);}function socketSendMiners(_0x3c973c,_0x4f80d2){const _0x41f84e=_0x26d228;let _0x3d8738=_[_0x41f84e(0x2ca)](_0x3c973c,(_0x56a374={})=>{const _0x3c61e2=_0x41f84e;if(!_0x56a374||!_0x56a374[_0x3c61e2(0x2d7)])return{};const {name:_0x4530b6,minerType:_0x43fb18,ipAddress:_0xfd48be,macAddress:_0x42514e,placement:_0x16f515,accountName:_0x2a35e1,workerName:_0x191dd6,condition:_0x18c097,conditionPrime:_0xf40317,deployments:_0x222644,systemLogicVersion:_0xa9c5d,serialNumber:_0x3922f2,psuSerialNumber:_0x19a7ed,psuModel:_0xf37d4c,networkSwitchRef:_0x3a8c95,breakerPanelId:_0x450c7c,powerBarId:_0x2633f7,powerPhase:_0x1c46ba,transformerLow:_0x360cb7,transformerMed:_0x399f17}=_0x56a374;let _0x741086={'name':_0x4530b6,'minerType':_0x43fb18,'ipAddress':_0xfd48be,'macAddress':_0x42514e,'placement':_0x16f515,'accountName':_0x2a35e1,'workerName':_0x191dd6,'condition':_0x18c097,'conditionPrime':_0xf40317,'deployments':_0x222644,'systemLogicVersion':_0xa9c5d,'serialNumber':_0x3922f2,'psuSerialNumber':_0x19a7ed,'psuModel':_0xf37d4c,'networkSwitchRef':_0x3a8c95,'breakerPanelId':_0x450c7c,'powerBarId':_0x2633f7,'powerPhase':_0x1c46ba,'transformerLow':_0x360cb7,'transformerMed':_0x399f17};return _0x56a374[_0x3c61e2(0x210)]&&minerTypeMap[_0x43fb18]&&(_0x741086['minerTypeMap']=minerTypeMap[_0x43fb18]),_0x741086[_0x3c61e2(0x299)]=_0x4f80d2||'',_0x741086;}),_0x3eb62e='{\x22minerInfos\x22:'+JSON[_0x41f84e(0x200)](_0x3d8738)+'}';socketSend({'text':_0x3eb62e});}function sendMessage({text:_0xc55096,accessToken:_0x5bf47e},_0xf9abba){if(!_0xc55096)return;_0xf9abba&&slackMessage({'text':_0xc55096}),socketSend({'text':_0xc55096,'accessToken':_0x5bf47e});}module[_0x26d228(0x1d4)]={'provisionMiner':provisionMiner,'provisionMinersByType':provisionMinersByType,'provisionUnresponsiveMiner':provisionUnresponsiveMiner,'getDataCenterRacklist':getDataCenterRacklist,'discoverMiners':discoverMiners,'compareMinerStatus':compareMinerStatus,'setDataCenterSettings':setDataCenterSettings,'syncMinerStatusJob':syncMinerStatusJob,'socketSendMiners':socketSendMiners};