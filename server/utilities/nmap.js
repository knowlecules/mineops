/* Copyright (C) 9208-9721 Quebec, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Jason Rudland <jason.g.rudland@gmail.com>, September 2022
*/'use strict';const _0x4a2194=_0x6dc2;function _0x6dc2(_0x26b370,_0x4cc902){const _0x5e1be3=_0x5e1b();return _0x6dc2=function(_0x6dc2f2,_0x51a69f){_0x6dc2f2=_0x6dc2f2-0xd9;let _0x1f2d6b=_0x5e1be3[_0x6dc2f2];return _0x1f2d6b;},_0x6dc2(_0x26b370,_0x4cc902);}(function(_0x338040,_0xa6fa1b){const _0x225c08=_0x6dc2,_0x998c3b=_0x338040();while(!![]){try{const _0x4fffce=-parseInt(_0x225c08(0xe6))/0x1+-parseInt(_0x225c08(0xda))/0x2*(-parseInt(_0x225c08(0xe1))/0x3)+-parseInt(_0x225c08(0xf6))/0x4+parseInt(_0x225c08(0xf3))/0x5*(parseInt(_0x225c08(0xe2))/0x6)+parseInt(_0x225c08(0xef))/0x7*(-parseInt(_0x225c08(0xde))/0x8)+parseInt(_0x225c08(0xe8))/0x9*(-parseInt(_0x225c08(0xea))/0xa)+parseInt(_0x225c08(0xe4))/0xb*(parseInt(_0x225c08(0xe7))/0xc);if(_0x4fffce===_0xa6fa1b)break;else _0x998c3b['push'](_0x998c3b['shift']());}catch(_0x55e169){_0x998c3b['push'](_0x998c3b['shift']());}}}(_0x5e1b,0xe6c23));function _0x5e1b(){const _0x535fa3=['split','ports','192.168.1.1','nmap\x20-sn\x20','debug','vender','mac','\x20|\x20grep\x20tcp','code','4cxkrho','push','child_process','range','7613048BZzsSG','scanNetwork','1-3000','1215234GfIlqP','1074vwifQn','host','33LDPuAD','length','398571LCjEbs','12767640IFrPTE','7609428ChVQYg','MAC','20pdgZda','Nmap','exports','192.168.1.1/24','replace','7dvKGZk',',\x20error\x20code:\x20','scanPorts','slice','31345yvQKQp','prototype','exec','4551376gzpHpZ'];_0x5e1b=function(){return _0x535fa3;};return _0x5e1b();}let debug=require(_0x4a2194(0xfb))('mineops:nmap'),spawn=require(_0x4a2194(0xdc)),Nmap=function(){};Nmap[_0x4a2194(0xf4)][_0x4a2194(0xdf)]=function(_0x449f47){return new Promise(function(_0x1edb23,_0x914ba1){const _0x3662be=_0x6dc2;let _0x54e5c4=[];_0x449f47=_0x449f47||{'range':_0x3662be(0xed)};let _0x350d46=_0x3662be(0xfa)+_0x449f47[_0x3662be(0xdd)];spawn['exec'](_0x350d46,function(_0xa9e52,_0xad69a5,_0x3a0c3e){const _0x3fec60=_0x3662be;_0xa9e52&&(debug(_0x449f47[_0x3fec60(0xe3)]+_0x3fec60(0xf0)+_0xa9e52[_0x3fec60(0xd9)]+_0x3a0c3e),_0x914ba1(_0x54e5c4));let _0x22e151=_0xad69a5[_0x3fec60(0xf7)]('\x0a'),_0x3ebcba=0x0;while(_0x3ebcba<_0x22e151[_0x3fec60(0xe5)]-0x3){let _0x3088ca={},_0x4fc922=_0x22e151[_0x3ebcba][_0x3fec60(0xf7)]('\x20');if(_0x4fc922[0x0]==='Nmap'){_0x3088ca['ip']=_0x4fc922[0x4],_0x4fc922=_0x22e151[_0x3ebcba+0x2]['split']('\x20');if(_0x4fc922[0x0]===_0x3fec60(0xe9))_0x3088ca[_0x3fec60(0xfd)]=_0x4fc922[0x2],_0x3088ca[_0x3fec60(0xfc)]=_0x22e151[_0x3ebcba+0x2][_0x3fec60(0xf7)]('(')[0x1][_0x3fec60(0xee)](')',''),_0x54e5c4[_0x3fec60(0xdb)](_0x3088ca),_0x3ebcba+=0x3;else _0x3ebcba++;}else _0x3ebcba++;}_0x1edb23(_0x54e5c4);});});},Nmap[_0x4a2194(0xf4)][_0x4a2194(0xf1)]=function(_0x11afff){return new Promise(function(_0x2904e5,_0x3a6745){const _0x52e8fd=_0x6dc2;let _0x548609=[];_0x11afff=_0x11afff||{'ports':_0x52e8fd(0xe0),'host':_0x52e8fd(0xf9)};let _0x2ed440='nmap\x20-p'+_0x11afff[_0x52e8fd(0xf8)]+'\x20'+_0x11afff[_0x52e8fd(0xe3)]+_0x52e8fd(0xfe);spawn[_0x52e8fd(0xf5)](_0x2ed440,function(_0x55d91c,_0x2774c9,_0x2b7346){const _0x3b97da=_0x52e8fd;_0x55d91c&&(debug(_0x11afff[_0x3b97da(0xe3)]+_0x3b97da(0xf0)+_0x55d91c[_0x3b97da(0xd9)]+_0x2b7346),_0x3a6745(_0x548609));let _0x59d54a=_0x2774c9[_0x3b97da(0xf7)]('\x0a');_0x548609['push'](_0x11afff['host']);for(let _0x1e556a=0x0;_0x1e556a<_0x59d54a[_0x3b97da(0xe5)]-0x1;_0x1e556a++){let _0x5cbffc=_0x59d54a[_0x1e556a]['replace'](/\s+/g,'\x20')[_0x3b97da(0xf7)]('\x20');_0x548609[_0x3b97da(0xdb)]({'port':_0x5cbffc[0x0][_0x3b97da(0xf2)](0x0,-0x4),'protocol':_0x5cbffc[0x2]});}_0x2904e5(_0x548609);});});},module[_0x4a2194(0xec)][_0x4a2194(0xeb)]=new Nmap();