/* Copyright (C) 9208-9721 Quebec, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Jason Rudland <jason.g.rudland@gmail.com>, September 2022
*/'use strict';const _0x386cc0=_0x187c;function _0x2781(){const _0x1ea518=['query','socketPort','9431166IprZSV','log','url','1541406DJFfZE','readyState','keys','forEach','55914710AWUkRS','parse','use','listen','5CqojPI','createServer','343840gOjIBR','MineOps\x20sockets\x20connected.','11iIYdIE','\x1b[32m%s\x1b[0m','6WtRykQ','755056JTNnBf','[web-sockets]\x20connected\x20to\x20session:\x20','502116yTgfzA','112IxwakU','Server','access_token','../config.json','connection','address','OPEN','send','10820817DpxgkO'];_0x2781=function(){return _0x1ea518;};return _0x2781();}(function(_0x463b38,_0xfbfc21){const _0x113b1c=_0x187c,_0x43d24d=_0x463b38();while(!![]){try{const _0x4d522d=parseInt(_0x113b1c(0x188))/0x1+parseInt(_0x113b1c(0x197))/0x2*(parseInt(_0x113b1c(0x185))/0x3)+parseInt(_0x113b1c(0x1a1))/0x4+-parseInt(_0x113b1c(0x19f))/0x5*(-parseInt(_0x113b1c(0x194))/0x6)+-parseInt(_0x113b1c(0x189))/0x7*(-parseInt(_0x113b1c(0x186))/0x8)+parseInt(_0x113b1c(0x191))/0x9+parseInt(_0x113b1c(0x19b))/0xa*(-parseInt(_0x113b1c(0x183))/0xb);if(_0x4d522d===_0xfbfc21)break;else _0x43d24d['push'](_0x43d24d['shift']());}catch(_0x279f5a){_0x43d24d['push'](_0x43d24d['shift']());}}}(_0x2781,0xc8c19));const express=require('express'),http=require('http'),url=require(_0x386cc0(0x196)),WebSocket=require('ws'),config=require('../../common/config.json'),svrConfig=require(_0x386cc0(0x18c));let sockets={};function _0x187c(_0x1386ee,_0x2ded55){const _0x2781bf=_0x2781();return _0x187c=function(_0x187c63,_0xd7583f){_0x187c63=_0x187c63-0x183;let _0x5b92d9=_0x2781bf[_0x187c63];return _0x5b92d9;},_0x187c(_0x1386ee,_0x2ded55);}function start(){const _0x9d4803=_0x386cc0,_0x3a90ed=express();_0x3a90ed[_0x9d4803(0x19d)](function(_0x24e485,_0x33a292){const _0x46ee12=_0x9d4803;_0x33a292[_0x46ee12(0x190)]({'msg':'hello'});});const _0x3baedd=http[_0x9d4803(0x1a0)](_0x3a90ed),_0x4e3b3a=new WebSocket[(_0x9d4803(0x18a))]({'server':_0x3baedd});_0x4e3b3a['on'](_0x9d4803(0x18d),function _0x4ce08f(_0x16117b,_0x3a5e7d){const _0x18f21c=_0x9d4803,_0x58bd16=url[_0x18f21c(0x19c)](_0x3a5e7d[_0x18f21c(0x196)],!![]),_0x39f537=_0x58bd16[_0x18f21c(0x192)][_0x18f21c(0x18b)];sockets[_0x39f537]=_0x16117b,socketSend({'text':_0x18f21c(0x1a2),'accessToken':_0x39f537}),console['log'](_0x18f21c(0x187)+_0x39f537);}),_0x3baedd[_0x9d4803(0x19e)](config[_0x9d4803(0x193)],function _0x47fd10(){const _0x54d2f3=_0x9d4803,_0x519864=_0x3baedd[_0x54d2f3(0x18e)]();console[_0x54d2f3(0x195)](_0x54d2f3(0x184),'[web-sockets]\x20server\x20listening\x20'+_0x519864['address']+':'+_0x519864['port']);});}function socketSend({text:_0x4b858e,accessToken:_0x269ed9}){const _0xa47a0e=_0x386cc0;function _0x533e79(_0x4cd88e,_0x5a8761){const _0x15c294=_0x187c;sockets[_0x5a8761][_0x15c294(0x198)]===WebSocket[_0x15c294(0x18f)]?sockets[_0x5a8761]['send'](_0x4cd88e):delete sockets[_0x5a8761];}_0x269ed9?_0x533e79(_0x4b858e,_0x269ed9):Object[_0xa47a0e(0x199)](sockets)[_0xa47a0e(0x19a)](_0x3d6ec4=>{_0x533e79(_0x4b858e,_0x3d6ec4);});}module['exports']={'socketSend':socketSend,'start':start};