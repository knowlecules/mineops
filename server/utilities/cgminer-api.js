/* Copyright (C) 9208-9721 Quebec, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Jason Rudland <jason.g.rudland@gmail.com>, September 2022
*/'use strict';const _0x134d40=_0x1dcb;(function(_0x445764,_0x3c83c5){const _0x18e2d7=_0x1dcb,_0x1fe884=_0x445764();while(!![]){try{const _0x876fd5=-parseInt(_0x18e2d7(0x1f6))/0x1+parseInt(_0x18e2d7(0x1d5))/0x2+-parseInt(_0x18e2d7(0x1b7))/0x3+-parseInt(_0x18e2d7(0x1c4))/0x4*(-parseInt(_0x18e2d7(0x1c7))/0x5)+parseInt(_0x18e2d7(0x1d9))/0x6*(-parseInt(_0x18e2d7(0x1f0))/0x7)+parseInt(_0x18e2d7(0x1bd))/0x8+parseInt(_0x18e2d7(0x1ed))/0x9;if(_0x876fd5===_0x3c83c5)break;else _0x1fe884['push'](_0x1fe884['shift']());}catch(_0x4a30b0){_0x1fe884['push'](_0x1fe884['shift']());}}}(_0x4fb3,0xad837));function _0x4fb3(){const _0x5f33f6=['util','Forced\x20connection\x20timeout\x20during\x20','Miner\x20error:\x20\x20','map','params','debug','replace','port','get','1577463EsxvAt','rpcClient','join',':$1','info','message','353608KiUntZ','stringify','Sending\x20multiple\x20commands\x20to\x20miners\x20is\x20not\x20supported.','toUpperCase','Invalid\x20STATUS\x20','length','Bad\x20JSON\x20response\x20from\x20miner:\x20','579324UYRGHI','response','\x20in\x20response\x20from\x20miner.\x20','35EuTDCE','substr','Invoking\x20CGMiner\x20command\x20','error','warn','function','prototype','XX:','parameter','connect','.\x20Socket\x20timeout\x20is\x20','RPC\x20\x22version\x22\x20command\x20failed\x20for\x20','test','trim','674910vnwDBf','toLowerCase','Response\x20received\x20for\x20CGMiner\x20command\x20','\x20for\x20','318FwGPSq','Timing\x20out\x20CGMiner\x20connection\x20','destroy','toString','data','net','Response\x20sent\x20on\x20for\x20CGMiner\x20command\x20','AvalonMiner','setTimeout','match','split','STATUS','Whatsminer','000','end','stats','summary','connection','\x22:\x22$1\x22','cmd','18576711DHmMLn','exports','keys','162813imghjh','\x22},{\x22','bmminer\x20','Connect\x20for\x20CGMiner\x20command\x20','Firmware\x20Version','timestamp','990293UcvneQ','host','catch','Innosilicon','[scan]\x20miner\x20does\x20not\x20have\x20a\x20\x22version\x22\x20cgminer\x20command:','[scan]\x20miner\x20found\x20at\x20'];_0x4fb3=function(){return _0x5f33f6;};return _0x4fb3();}const net=require(_0x134d40(0x1de)),{inspect}=require(_0x134d40(0x1ae)),cgminerPort=0xfbc,CONN_TIMEOUT=0xbb8,SOCK_TIMEOUT=0xfa0,MSG_TIMEOUT=0x1f40,label='cgminer-api',commandAlwaysArray={'pools':!![],'devs':!![],'edevs':!![],'procs':!![],'notify':!![],'devdetails':!![],'stats':!![],'estats':!![]};function MinerRPCClient(_0x17c246,_0x560f2a){const _0x3ce84c=_0x134d40;let _0x153c98=this;_0x153c98[_0x3ce84c(0x1f7)]=_0x17c246||'localhost',_0x153c98[_0x3ce84c(0x1b5)]=_0x560f2a||cgminerPort;}MinerRPCClient[_0x134d40(0x1cd)]['get']=function(_0x187469,_0x5d1987,_0x1f30f4){const _0x542e17=_0x134d40;let _0xaa8c29=this;if(/\+/[_0x542e17(0x1d3)](_0x187469))return _0x1f30f4(new Error(_0x542e17(0x1bf)));typeof _0x5d1987==_0x542e17(0x1cc)&&(_0x1f30f4=_0x5d1987,_0x5d1987=undefined);let _0x2f4c26='',_0x1d5f5b=![],_0x329a63={'command':_0x187469},_0x2d74f6=net[_0x542e17(0x1d0)]({'host':_0xaa8c29['host'],'port':_0xaa8c29[_0x542e17(0x1b5)]});_0xaa8c29[_0x542e17(0x1b8)]=_0x2d74f6,_0x2d74f6[_0x542e17(0x1e1)](SOCK_TIMEOUT);const _0x81d3bb={'label':label,'ipAddress':_0xaa8c29[_0x542e17(0x1f7)]};console[_0x542e17(0x1b3)](_0x81d3bb,_0x542e17(0x1c9)+_0x187469+',\x20'+(_0x5d1987||'')+_0x542e17(0x1d8)+_0xaa8c29[_0x542e17(0x1f7)]+_0x542e17(0x1d1)+SOCK_TIMEOUT);function _0x615449(_0x5684c7,_0x1f3b6d){return setTimeout(()=>{const _0x1a76ab=_0x1dcb;console[_0x1a76ab(0x1cb)](_0x81d3bb,_0x1a76ab(0x1da)+_0x187469+',\x20'+(_0x5d1987||'')+_0x1a76ab(0x1d8)+_0xaa8c29[_0x1a76ab(0x1f7)]+',\x20During\x20'+_0x1f3b6d),_0x470451(_0x1a76ab(0x1af)+_0x1f3b6d+'!');},_0x5684c7);}var _0x4b6851=_0x615449(CONN_TIMEOUT,_0x542e17(0x1ea)),_0xa25f27=null;typeof _0x5d1987!='undefined'&&(_0x329a63[_0x542e17(0x1cf)]=_0x5d1987);function _0x470451(_0x5eccf9){const _0x95074a=_0x542e17;clearTimeout(_0xa25f27);var _0x41d435=new Error(_0x5eccf9);return _0x41d435[_0x95074a(0x1ec)]=_0x187469,_0x41d435[_0x95074a(0x1b2)]=_0x5d1987,_0x41d435[_0x95074a(0x1c5)]=_0x2f4c26,_0x1f30f4(_0x41d435),_0x1f30f4=()=>{};}function _0x212459(_0x1b5876){_0x470451('Error\x20while\x20connecting\x20to\x20miner:\x20'+_0x1b5876['message']);}_0x2d74f6['on'](_0x542e17(0x1ca),_0x212459),_0x2d74f6['on'](_0x542e17(0x1d0),function(){const _0x81021f=_0x542e17;console[_0x81021f(0x1b3)](_0x81d3bb,_0x81021f(0x1f3)+_0x187469+',\x20'+(_0x5d1987||'')+_0x81021f(0x1d8)+_0xaa8c29['host']),clearTimeout(_0x4b6851),_0x2d74f6['write'](JSON[_0x81021f(0x1be)](_0x329a63)),_0x1d5f5b=!![],_0xa25f27=_0x615449(MSG_TIMEOUT,'post\x20connect');}),_0x2d74f6['on'](_0x542e17(0x1dd),function(_0x5c0568){const _0x24b401=_0x542e17;console[_0x24b401(0x1b3)](_0x81d3bb,_0x24b401(0x1d7)+_0x187469+',\x20'+(_0x5d1987||'')+_0x24b401(0x1d8)+_0xaa8c29[_0x24b401(0x1f7)]),clearTimeout(_0xa25f27),_0x2f4c26+=_0x5c0568[_0x24b401(0x1dc)]();}),_0x2d74f6['on'](_0x542e17(0x1e7),function(){const _0x113f29=_0x542e17;if(!_0x1d5f5b)return _0x470451('Failed\x20to\x20connect\x20to\x20miner.');let _0x3e2cf8='';try{_0x3e2cf8=_0x2f4c26['replace'](/[\x00\n\u0000]/g,'')['replace'](/^[^{]*{/g,'{')[_0x113f29(0x1b4)](/}[^}]*$/g,'}')[_0x113f29(0x1b4)](/\s*:\s*/g,':')[_0x113f29(0x1b4)](/":([^0-9\[{"ft][^,]*)\s*/,_0x113f29(0x1eb))[_0x113f29(0x1b4)](/"\s*}\s*{\s*"/,_0x113f29(0x1f1)),_0x2f4c26=JSON['parse'](_0x3e2cf8);}catch(_0x3b1368){return console[_0x113f29(0x1cb)]('Bad\x20JSON\x20response\x20from\x20miner:\x20',_0x3e2cf8),_0x470451(_0x113f29(0x1c3)+_0x3b1368[_0x113f29(0x1bc)]);}var _0x3b4ab3=_0x2f4c26[_0x113f29(0x1e4)];if(_0x3b4ab3&&_0x3b4ab3[_0x113f29(0x1c2)]==0x1)_0x3b4ab3=_0x3b4ab3[0x0];else{if(!/restart/[_0x113f29(0x1d3)](_0x3b4ab3))return _0x470451(_0x113f29(0x1c1)+_0x3b4ab3+_0x113f29(0x1c6)+inspect(_0x2f4c26,![],0x5,!![]));}if(_0x3b4ab3['STATUS']=='E'||_0x3b4ab3[_0x113f29(0x1e4)]=='F')return _0x470451(_0x113f29(0x1b0)+_0x3b4ab3['Msg']+'.\x20'+inspect(_0x2f4c26,![],0x5,!![]));clearTimeout(_0xa25f27);var _0x3b67c2=null;Object[_0x113f29(0x1ef)](_0x2f4c26)['forEach'](function(_0x20d8aa){const _0x1b4904=_0x113f29;_0x20d8aa!=_0x1b4904(0x1e4)&&_0x20d8aa!='id'&&(_0x3b67c2=_0x20d8aa);});var _0x31e9d0=_0x2f4c26[_0x3b67c2];_0x31e9d0?_0x31e9d0[_0x113f29(0x1c2)]==0x1&&!commandAlwaysArray[_0x187469]&&(_0x31e9d0=_0x31e9d0[0x0]):_0x31e9d0=_0x3b4ab3,console[_0x113f29(0x1b3)](_0x81d3bb,_0x113f29(0x1df)+_0x187469+',\x20'+(_0x5d1987||'')+_0x113f29(0x1d8)+_0xaa8c29[_0x113f29(0x1f7)]),_0x1f30f4(null,_0x31e9d0,_0x2f4c26);});},MinerRPCClient[_0x134d40(0x1cd)][_0x134d40(0x1db)]=function(_0x2efc60){const _0x4b45cf=_0x134d40;let _0x17add1=this;_0x17add1[_0x4b45cf(0x1b8)]&&_0x17add1[_0x4b45cf(0x1b8)][_0x4b45cf(0x1db)]();};function createClient(_0x27a2dd,_0xa455bc){return new MinerRPCClient(_0x27a2dd,_0xa455bc);};function getCommandFromCache(_0x479416,_0x67e33f){const _0x25b254=_0x134d40,_0x3bb0cc=_0x479416+_0x67e33f,_0x44ddf9=Date['now']();return cache?.[_0x3bb0cc]?.[_0x25b254(0x1f5)]<_0x44ddf9-cacheMillis&&(cache[_0x3bb0cc]=''),cache[_0x3bb0cc];};const cacheMillis=0xc8*0x3e8,cache={};function saveCommandToCache(_0x5ea20b,_0x5bcab4,_0x2824e1){const _0x3ebc8a=_0x5ea20b+_0x5bcab4;cache[_0x3ebc8a]={'timestamp':Date['now'](),'data':_0x2824e1};};let clients={};async function sendCommand(_0x51cb22,_0x30d2e2,_0x36176f=undefined){const _0x53e23c=_0x134d40;if(cacheMillis){const _0x29ba46=getCommandFromCache(_0x51cb22,_0x30d2e2);if(_0x29ba46)return _0x29ba46[_0x53e23c(0x1dd)];}const _0x4394e1=await new Promise((_0x496ce8,_0xd09cee)=>{const _0x3dc157=_0x53e23c,_0x142d39=createClient(_0x51cb22,cgminerPort);_0x142d39[_0x3dc157(0x1b6)](_0x30d2e2,_0x36176f,function(_0x4b1131,_0x596d21,_0x3adfdb){_0x142d39['destroy'](_0x252e45=>{if(_0x252e45)return _0xd09cee(_0x252e45);});if(_0x4b1131)return _0xd09cee(_0x4b1131);_0x496ce8(_0x596d21);});});return cacheMillis&&saveCommandToCache(_0x51cb22,_0x30d2e2,_0x4394e1),_0x4394e1;}async function getVersionInfo(_0x292b06,_0x4e489b){const _0xe2fff6=_0x134d40;let _0x175cbd=await sendCommand(_0x292b06,'version')[_0xe2fff6(0x1aa)](_0x501784=>{const _0x52c22c=_0xe2fff6;return console['warn'](_0x52c22c(0x1d2)+_0x292b06+'\x20['+_0x4e489b+']',_0x501784),![];});if(!_0x175cbd)return'';else{if(_0x175cbd[_0xe2fff6(0x1c8)]&&/^\w{2,}/i['test'](_0x175cbd)){const _0x54d9bb=_0x175cbd[0x0][_0xe2fff6(0x1c0)]()+_0x175cbd['substr'](0x1);_0x175cbd={'API':_0x54d9bb,'brand':_0x54d9bb['match'](/(\S+)\s/)[0x1]};}}let {CGMiner:_0x31b601,BMMiner:_0x2adcd5,API:_0x4b0a53,Miner:_0x39c695,CompileTime:_0x3308e4,Type:_0x313a97,PROD:_0x393287,VERSION:_0x185e09,MAC:_0x52e7d6,brand:_0x36c52c}=_0x175cbd,_0x21030c,_0x1c5937;if(_0x4b0a53||/^E/i['test'](_0x175cbd)){console[_0xe2fff6(0x1bb)]({'ipAddress':_0x292b06,'macAddress':_0x4e489b},_0xe2fff6(0x1ad)+_0x292b06);_0x52e7d6&&!/:/[_0xe2fff6(0x1d3)](_0x52e7d6)&&(_0x4e489b=_0x52e7d6[_0xe2fff6(0x1b4)](/(.{2})/g,_0xe2fff6(0x1ba))[_0xe2fff6(0x1c8)](0x1));_0x393287&&(_0x313a97=_0x393287,!_0x36c52c&&(_0x36c52c=_0x313a97[_0xe2fff6(0x1e2)](/(\S+)\s/)[0x1]));if(!_0x313a97){const _0x542a21=await sendCommand(_0x292b06,_0xe2fff6(0x1e8));_0x313a97=_0x542a21?.[0x0]?.['Type'];}if(!_0x36c52c||!_0x313a97)try{const _0x43ca99=await sendCommand(_0x292b06,'devdetails'),{Driver:_0x5d5e0e,Model:_0x5223a4}=_0x43ca99?.[0x0]||{};if(/bitmicro/i[_0xe2fff6(0x1d3)](_0x5d5e0e))_0x36c52c=_0x36c52c||_0xe2fff6(0x1e5),_0x313a97=_0x36c52c+'\x20'+_0x5223a4['replace'](/V\w?\d+$/i,''),_0x39c695=_0x5223a4;else{if(/(DragonmintT1|HLT_Coinflex)/i[_0xe2fff6(0x1d3)](_0x5d5e0e))_0x36c52c=_0xe2fff6(0x1ab);else/avalon/i[_0xe2fff6(0x1d3)](_0x5d5e0e)&&(_0x36c52c=_0xe2fff6(0x1e0));}}catch(_0x2c8aec){}if(!_0x4e489b){const _0xa00a22=await sendCommand(_0x292b06,_0xe2fff6(0x1e9));_0x4e489b=(_0xa00a22?.['MAC']||'')[_0xe2fff6(0x1d6)](),!_0x4e489b&&(_0x4e489b=_0xe2fff6(0x1ce)+_0x292b06[_0xe2fff6(0x1e3)]('.')[_0xe2fff6(0x1b1)](_0x5bfb77=>(_0xe2fff6(0x1e6)+_0x5bfb77)[_0xe2fff6(0x1c8)](_0x5bfb77['length']))[_0xe2fff6(0x1b9)]('')[_0xe2fff6(0x1c8)](0x2)[_0xe2fff6(0x1b4)](/(\d{2})/g,'$1:')[_0xe2fff6(0x1b4)](/:$/,'')),_0x185e09=_0xa00a22?.[_0xe2fff6(0x1f4)];}/\b\s\b/['test'](_0x313a97)&&(!_0x36c52c&&(_0x36c52c=_0x313a97[_0xe2fff6(0x1e2)](/(\S+)\s/)[0x1]),_0x21030c=_0x313a97,_0x1c5937=_0x313a97['replace'](/\s+\(.*$/,'')[_0xe2fff6(0x1d4)]()['replace'](/(\-[^\-]+)+$/,''));const _0x4ee129={'ipAddress':_0x292b06,'macAddress':_0x4e489b,'brand':_0x36c52c,'apiVersion':_0x36c52c,'modelType':_0x21030c,'minerType':_0x1c5937,'systemKernelVersion':_0x4b0a53,'hardwareVersion':_0x39c695||_0x185e09,'fileSystemTimestamp':_0x3308e4,'softwareVersion':_0x31b601?'cgminer\x20'+_0x31b601:!_0x2adcd5?'':_0xe2fff6(0x1f2)+_0x2adcd5};return _0x4ee129;}else return console['warn']({'ipAddress':_0x292b06,'macAddress':_0x4e489b},_0xe2fff6(0x1ac)+_0x292b06),'';}function _0x1dcb(_0x403277,_0x2a10f9){const _0x4fb37d=_0x4fb3();return _0x1dcb=function(_0x1dcb6d,_0x11fbe5){_0x1dcb6d=_0x1dcb6d-0x1aa;let _0x3c0c9a=_0x4fb37d[_0x1dcb6d];return _0x3c0c9a;},_0x1dcb(_0x403277,_0x2a10f9);}module[_0x134d40(0x1ee)]={'sendCommand':sendCommand,'getVersionInfo':getVersionInfo};