/* Copyright (C) 9208-9721 Quebec, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Jason Rudland <jason.g.rudland@gmail.com>, September 2022
*/'use strict';const _0x5efb65=_0x2f12;(function(_0x507fe9,_0x5482ef){const _0x408e4d=_0x2f12,_0x403f91=_0x507fe9();while(!![]){try{const _0x185a8a=-parseInt(_0x408e4d(0xf0))/0x1+-parseInt(_0x408e4d(0xc3))/0x2*(parseInt(_0x408e4d(0xc6))/0x3)+-parseInt(_0x408e4d(0xe8))/0x4+parseInt(_0x408e4d(0xc7))/0x5+-parseInt(_0x408e4d(0xfe))/0x6+parseInt(_0x408e4d(0xe9))/0x7*(-parseInt(_0x408e4d(0xc8))/0x8)+-parseInt(_0x408e4d(0xf2))/0x9*(-parseInt(_0x408e4d(0xe1))/0xa);if(_0x185a8a===_0x5482ef)break;else _0x403f91['push'](_0x403f91['shift']());}catch(_0x5d8cb7){_0x403f91['push'](_0x403f91['shift']());}}}(_0x4078,0xe9ebb));const net=require(_0x5efb65(0xe4)),{inspect}=require(_0x5efb65(0x105)),cgminerPort=0xfbc,CONN_TIMEOUT=0xbb8,SOCK_TIMEOUT=0xfa0,MSG_TIMEOUT=0x1f40,label='cgminer-api',commandAlwaysArray={'pools':!![],'devs':!![],'edevs':!![],'procs':!![],'notify':!![],'devdetails':!![],'stats':!![],'estats':!![]};function MinerRPCClient(_0x45f1fa,_0x247b1a){const _0x1b50ec=_0x5efb65;let _0xfe79ef=this;_0xfe79ef[_0x1b50ec(0x10e)]=_0x45f1fa||_0x1b50ec(0xe5),_0xfe79ef['port']=_0x247b1a||cgminerPort;}MinerRPCClient['prototype'][_0x5efb65(0x10a)]=function(_0x621f61,_0x209645,_0x1cd54e){const _0x239265=_0x5efb65;let _0x360c30=this;if(/\+/[_0x239265(0xcf)](_0x621f61))return _0x1cd54e(new Error(_0x239265(0xfc)));typeof _0x209645==_0x239265(0x107)&&(_0x1cd54e=_0x209645,_0x209645=undefined);let _0x2ea31b='',_0x4ffd83=![],_0x3556c0={'command':_0x621f61},_0x2ded60=net['connect']({'host':_0x360c30[_0x239265(0x10e)],'port':_0x360c30[_0x239265(0xda)]});_0x360c30[_0x239265(0xf4)]=_0x2ded60,_0x2ded60[_0x239265(0xcb)](SOCK_TIMEOUT);const _0x589618={'label':label,'ipAddress':_0x360c30[_0x239265(0x10e)]};console[_0x239265(0xf7)](_0x589618,_0x239265(0xfa)+_0x621f61+',\x20'+(_0x209645||'')+_0x239265(0xde)+_0x360c30['host']+_0x239265(0xd8)+SOCK_TIMEOUT);function _0x21a72f(_0xd237c8,_0x4c69ef){return setTimeout(()=>{const _0x25af72=_0x2f12;console[_0x25af72(0x10f)](_0x589618,'Timing\x20out\x20CGMiner\x20connection\x20'+_0x621f61+',\x20'+(_0x209645||'')+_0x25af72(0xde)+_0x360c30[_0x25af72(0x10e)]+',\x20During\x20'+_0x4c69ef),_0x35bde0(_0x25af72(0xf9)+_0x4c69ef+'!');},_0xd237c8);}var _0x4290cd=_0x21a72f(CONN_TIMEOUT,_0x239265(0x101)),_0x3aceaf=null;typeof _0x209645!=_0x239265(0xff)&&(_0x3556c0['parameter']=_0x209645);function _0x35bde0(_0x534b94){const _0x171a57=_0x239265;clearTimeout(_0x3aceaf);var _0x4e7a0e=new Error(_0x534b94);return _0x4e7a0e['cmd']=_0x621f61,_0x4e7a0e[_0x171a57(0xd6)]=_0x209645,_0x4e7a0e[_0x171a57(0xce)]=_0x2ea31b,_0x1cd54e(_0x4e7a0e),_0x1cd54e=()=>{};}function _0x5e3906(_0x57954b){_0x35bde0('Error\x20while\x20connecting\x20to\x20miner:\x20'+_0x57954b['message']);}_0x2ded60['on'](_0x239265(0xd2),_0x5e3906),_0x2ded60['on'](_0x239265(0xea),function(){const _0x9a868f=_0x239265;console[_0x9a868f(0xf7)](_0x589618,_0x9a868f(0xe2)+_0x621f61+',\x20'+(_0x209645||'')+_0x9a868f(0xde)+_0x360c30[_0x9a868f(0x10e)]),clearTimeout(_0x4290cd),_0x2ded60[_0x9a868f(0x106)](JSON[_0x9a868f(0x102)](_0x3556c0)),_0x4ffd83=!![],_0x3aceaf=_0x21a72f(MSG_TIMEOUT,_0x9a868f(0xed));}),_0x2ded60['on'](_0x239265(0xec),function(_0x145c6a){const _0x48640c=_0x239265;console[_0x48640c(0xf7)](_0x589618,_0x48640c(0xeb)+_0x621f61+',\x20'+(_0x209645||'')+_0x48640c(0xde)+_0x360c30[_0x48640c(0x10e)]),clearTimeout(_0x3aceaf),_0x2ea31b+=_0x145c6a[_0x48640c(0x104)]();}),_0x2ded60['on'](_0x239265(0xd1),function(){const _0x4d9668=_0x239265;if(!_0x4ffd83)return _0x35bde0(_0x4d9668(0xee));let _0x5aa83d='';try{_0x5aa83d=_0x2ea31b[_0x4d9668(0xdd)](/[\x00\n\u0000]/g,'')['replace'](/^[^{]*{/g,'{')[_0x4d9668(0xdd)](/}[^}]*$/g,'}')[_0x4d9668(0xdd)](/\s*:\s*/g,':')[_0x4d9668(0xdd)](/":([^0-9\[{"ft][^,]*)\s*/,_0x4d9668(0x109))[_0x4d9668(0xdd)](/"\s*}\s*{\s*"/,_0x4d9668(0xdc)),_0x2ea31b=JSON['parse'](_0x5aa83d);}catch(_0x231dcd){return console[_0x4d9668(0x10f)](_0x4d9668(0x103),_0x5aa83d),_0x35bde0(_0x4d9668(0x103)+_0x231dcd[_0x4d9668(0xc4)]);}var _0x17108b=_0x2ea31b[_0x4d9668(0xd0)];if(_0x17108b&&_0x17108b[_0x4d9668(0xf8)]==0x1)_0x17108b=_0x17108b[0x0];else{if(!/restart/[_0x4d9668(0xcf)](_0x17108b))return _0x35bde0(_0x4d9668(0xd7)+_0x17108b+_0x4d9668(0xe3)+inspect(_0x2ea31b,![],0x5,!![]));}if(_0x17108b['STATUS']=='E'||_0x17108b[_0x4d9668(0xd0)]=='F')return _0x35bde0(_0x4d9668(0xdf)+_0x17108b[_0x4d9668(0xbf)]+'.\x20'+inspect(_0x2ea31b,![],0x5,!![]));clearTimeout(_0x3aceaf);var _0xcac5a1=null;Object[_0x4d9668(0x10d)](_0x2ea31b)[_0x4d9668(0xc9)](function(_0x484bfa){const _0x52cfc1=_0x4d9668;_0x484bfa!=_0x52cfc1(0xd0)&&_0x484bfa!='id'&&(_0xcac5a1=_0x484bfa);});var _0x2e5da1=_0x2ea31b[_0xcac5a1];_0x2e5da1?_0x2e5da1[_0x4d9668(0xf8)]==0x1&&!commandAlwaysArray[_0x621f61]&&(_0x2e5da1=_0x2e5da1[0x0]):_0x2e5da1=_0x17108b,console[_0x4d9668(0xf7)](_0x589618,_0x4d9668(0x10c)+_0x621f61+',\x20'+(_0x209645||'')+'\x20for\x20'+_0x360c30[_0x4d9668(0x10e)]),_0x1cd54e(null,_0x2e5da1,_0x2ea31b);});},MinerRPCClient[_0x5efb65(0xc5)][_0x5efb65(0xd3)]=function(_0x433b0b){const _0x9400b0=_0x5efb65;let _0x3708be=this;_0x3708be['rpcClient']&&_0x3708be[_0x9400b0(0xf4)][_0x9400b0(0xd3)]();};function createClient(_0x4ee8ce,_0x10b488){return new MinerRPCClient(_0x4ee8ce,_0x10b488);};function getCommandFromCache(_0x1f0395,_0x43e1f6){const _0x40f952=_0x5efb65,_0x3dddca=_0x1f0395+_0x43e1f6,_0x334037=Date[_0x40f952(0x10b)]();return cache?.[_0x3dddca]?.['timestamp']<_0x334037-cacheMillis&&(cache[_0x3dddca]=''),cache[_0x3dddca];};const cacheMillis=0xc8*0x3e8,cache={};function saveCommandToCache(_0x30f03a,_0x205e1e,_0x4e1c8b){const _0x43bcf8=_0x5efb65,_0x1cbdd5=_0x30f03a+_0x205e1e;cache[_0x1cbdd5]={'timestamp':Date[_0x43bcf8(0x10b)](),'data':_0x4e1c8b};};let clients={};function _0x2f12(_0x19b636,_0x532ade){const _0x407834=_0x4078();return _0x2f12=function(_0x2f1299,_0x406e01){_0x2f1299=_0x2f1299-0xbf;let _0x5b8f8f=_0x407834[_0x2f1299];return _0x5b8f8f;},_0x2f12(_0x19b636,_0x532ade);}function _0x4078(){const _0x1af7b9=['Response\x20sent\x20on\x20for\x20CGMiner\x20command\x20','keys','host','warn','bmminer\x20','Msg','substr','Innosilicon','toLowerCase','24zIAwXS','message','prototype','329514KWeZVX','6502010nTrclq','285392HTjLnJ','forEach','match','setTimeout','join','stats','response','test','STATUS','end','error','destroy','devdetails','exports','params','Invalid\x20STATUS\x20','.\x20Socket\x20timeout\x20is\x20','cgminer\x20','port','AvalonMiner','\x22},{\x22','replace','\x20for\x20','Miner\x20error:\x20\x20','split','10EchQaZ','Connect\x20for\x20CGMiner\x20command\x20','\x20in\x20response\x20from\x20miner.\x20','net','localhost','[scan]\x20miner\x20does\x20not\x20have\x20a\x20\x22version\x22\x20cgminer\x20command:','info','6176704WepSjX','350DOOHmj','connect','Response\x20received\x20for\x20CGMiner\x20command\x20','data','post\x20connect','Failed\x20to\x20connect\x20to\x20miner.','XX:','438553BrBXMN','toUpperCase','54826299GzMoAY','summary','rpcClient','$1:','version','debug','length','Forced\x20connection\x20timeout\x20during\x20','Invoking\x20CGMiner\x20command\x20','map','Sending\x20multiple\x20commands\x20to\x20miners\x20is\x20not\x20supported.','trim','8097534uDDEoP','undefined','Firmware\x20Version','connection','stringify','Bad\x20JSON\x20response\x20from\x20miner:\x20','toString','util','write','function','RPC\x20\x22version\x22\x20command\x20failed\x20for\x20','\x22:\x22$1\x22','get','now'];_0x4078=function(){return _0x1af7b9;};return _0x4078();}async function sendCommand(_0x558325,_0x25874f,_0x594e3c=undefined){if(cacheMillis){const _0x5787a8=getCommandFromCache(_0x558325,_0x25874f);if(_0x5787a8)return _0x5787a8['data'];}const _0x5bf7c4=await new Promise((_0x424f22,_0x2e3b52)=>{const _0x4e4f9b=_0x2f12,_0x187283=createClient(_0x558325,cgminerPort);_0x187283[_0x4e4f9b(0x10a)](_0x25874f,_0x594e3c,function(_0x302f17,_0x570a64,_0xe31380){const _0x223541=_0x4e4f9b;_0x187283[_0x223541(0xd3)](_0x3da299=>{if(_0x3da299)return _0x2e3b52(_0x3da299);});if(_0x302f17)return _0x2e3b52(_0x302f17);_0x424f22(_0x570a64);});});return cacheMillis&&saveCommandToCache(_0x558325,_0x25874f,_0x5bf7c4),_0x5bf7c4;}async function getVersionInfo(_0x4f1684,_0x1b513e){const _0x3fd543=_0x5efb65;let _0x43f6c1=await sendCommand(_0x4f1684,_0x3fd543(0xf6))['catch'](_0x473f74=>{const _0x2a07ce=_0x3fd543;return console['warn'](_0x2a07ce(0x108)+_0x4f1684+'\x20['+_0x1b513e+']',_0x473f74),![];});if(!_0x43f6c1)return'';else{if(_0x43f6c1[_0x3fd543(0xc0)]&&/^\w{2,}/i['test'](_0x43f6c1)){const _0xc0449a=_0x43f6c1[0x0][_0x3fd543(0xf1)]()+_0x43f6c1['substr'](0x1);_0x43f6c1={'API':_0xc0449a,'brand':_0xc0449a[_0x3fd543(0xca)](/(\S+)\s/)[0x1]};}}let {CGMiner:_0x35105b,BMMiner:_0x3bb3d6,API:_0x5a43d9,Miner:_0x5e4a47,CompileTime:_0xba39a5,Type:_0x4311ab,PROD:_0x4905d4,VERSION:_0x3d8038,MAC:_0x141bdb,brand:_0xe7ea56}=_0x43f6c1,_0x5e030e,_0x268ea4;if(_0x5a43d9||/^E/i['test'](_0x43f6c1)){console[_0x3fd543(0xe7)]({'ipAddress':_0x4f1684,'macAddress':_0x1b513e},'[scan]\x20miner\x20found\x20at\x20'+_0x4f1684);_0x141bdb&&!/:/[_0x3fd543(0xcf)](_0x141bdb)&&(_0x1b513e=_0x141bdb[_0x3fd543(0xdd)](/(.{2})/g,':$1')['substr'](0x1));_0x4905d4&&(_0x4311ab=_0x4905d4,!_0xe7ea56&&(_0xe7ea56=_0x4311ab[_0x3fd543(0xca)](/(\S+)\s/)[0x1]));if(!_0x4311ab){const _0x2f3c12=await sendCommand(_0x4f1684,_0x3fd543(0xcd));_0x4311ab=_0x2f3c12?.[0x0]?.['Type'];}if(!_0xe7ea56||!_0x4311ab)try{const _0x5f56b8=await sendCommand(_0x4f1684,_0x3fd543(0xd4)),{Driver:_0x36b533,Model:_0x41498f}=_0x5f56b8?.[0x0]||{};if(/bitmicro/i[_0x3fd543(0xcf)](_0x36b533))_0xe7ea56=_0xe7ea56||'Whatsminer',_0x4311ab=_0xe7ea56+'\x20'+_0x41498f[_0x3fd543(0xdd)](/V\w?\d+$/i,''),_0x5e4a47=_0x41498f;else{if(/(DragonmintT1|HLT_Coinflex)/i[_0x3fd543(0xcf)](_0x36b533))_0xe7ea56=_0x3fd543(0xc1);else/avalon/i[_0x3fd543(0xcf)](_0x36b533)&&(_0xe7ea56=_0x3fd543(0xdb));}}catch(_0x56b8a9){}if(!_0x1b513e){const _0x471217=await sendCommand(_0x4f1684,_0x3fd543(0xf3));_0x1b513e=(_0x471217?.['MAC']||'')[_0x3fd543(0xc2)](),!_0x1b513e&&(_0x1b513e=_0x3fd543(0xef)+_0x4f1684[_0x3fd543(0xe0)]('.')[_0x3fd543(0xfb)](_0x517e3e=>('000'+_0x517e3e)[_0x3fd543(0xc0)](_0x517e3e[_0x3fd543(0xf8)]))[_0x3fd543(0xcc)]('')[_0x3fd543(0xc0)](0x2)[_0x3fd543(0xdd)](/(\d{2})/g,_0x3fd543(0xf5))[_0x3fd543(0xdd)](/:$/,'')),_0x3d8038=_0x471217?.[_0x3fd543(0x100)];}/\b\s\b/[_0x3fd543(0xcf)](_0x4311ab)&&(!_0xe7ea56&&(_0xe7ea56=_0x4311ab[_0x3fd543(0xca)](/(\S+)\s/)[0x1]),_0x5e030e=_0x4311ab,_0x268ea4=_0x4311ab[_0x3fd543(0xdd)](/\s+\(.*$/,'')[_0x3fd543(0xfd)]()['replace'](/(\-[^\-]+)+$/,''));const _0x39394f={'ipAddress':_0x4f1684,'macAddress':_0x1b513e,'brand':_0xe7ea56,'apiVersion':_0xe7ea56,'modelType':_0x5e030e,'minerType':_0x268ea4,'systemKernelVersion':_0x5a43d9,'hardwareVersion':_0x5e4a47||_0x3d8038,'fileSystemTimestamp':_0xba39a5,'softwareVersion':_0x35105b?_0x3fd543(0xd9)+_0x35105b:!_0x3bb3d6?'':_0x3fd543(0x110)+_0x3bb3d6};return _0x39394f;}else return console[_0x3fd543(0x10f)]({'ipAddress':_0x4f1684,'macAddress':_0x1b513e},_0x3fd543(0xe6)+_0x4f1684),'';}module[_0x5efb65(0xd5)]={'sendCommand':sendCommand,'getVersionInfo':getVersionInfo};