/* Copyright (C) 9208-9721 Quebec, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Jason Rudland <jason.g.rudland@gmail.com>, September 2022
*/'use strict';const _0x16a347=_0x4305;(function(_0x390daa,_0x4726f2){const _0x5e0c71=_0x4305,_0x51783c=_0x390daa();while(!![]){try{const _0x2d0c68=-parseInt(_0x5e0c71(0x1b5))/0x1*(-parseInt(_0x5e0c71(0x1ab))/0x2)+parseInt(_0x5e0c71(0x197))/0x3+parseInt(_0x5e0c71(0x1a4))/0x4+parseInt(_0x5e0c71(0x1b7))/0x5*(parseInt(_0x5e0c71(0x1b2))/0x6)+-parseInt(_0x5e0c71(0x1c1))/0x7+-parseInt(_0x5e0c71(0x1ad))/0x8+parseInt(_0x5e0c71(0x1bf))/0x9*(-parseInt(_0x5e0c71(0x1a8))/0xa);if(_0x2d0c68===_0x4726f2)break;else _0x51783c['push'](_0x51783c['shift']());}catch(_0xa62b94){_0x51783c['push'](_0x51783c['shift']());}}}(_0x730c,0x5653c));const spawn=require(_0x16a347(0x1a9)),IpSubnetCalculator=require('ip-subnet-calculator'),os=require('os'),_=require(_0x16a347(0x1af));function _0x4305(_0x21be5a,_0x40d778){const _0x730ca8=_0x730c();return _0x4305=function(_0x4305fa,_0x2ad432){_0x4305fa=_0x4305fa-0x195;let _0x1547d5=_0x730ca8[_0x4305fa];return _0x1547d5;},_0x4305(_0x21be5a,_0x40d778);}let hostsCache={},staleCacheTimespan=0x3c*0x3c*0x3e8;function _0x730c(){const _0xe37666=['329500fFOCxu','platform','exec','code','2829770ImZvjv','child_process','XX:','2VQLHwO','ipHigh','766328osaLzS','now','lodash','calculateCIDRPrefix','join','30XXpzqJ','IsInCIDR','timeStamp','502489LLLPVV',',\x20cache\x20count:\x20','671345lqjNLH','arp-scan\x20\x20-l\x20','dev','split','filter','test','trim','toDecimal','18NbrcJC','ipLow','3775807tfUWkI','ARP\x20Scan\x20failed\x20with\x20error\x20code:\x20','length','895599ZioYEb',',\x20from\x20an\x20arp\x20count\x20of\x20','arp\x20-a\x20','log','unknown','catch','substr','keys','Viable\x20host\x20collection\x20size:','replace','--interface=','$1:','exports'];_0x730c=function(){return _0xe37666;};return _0x730c();}const genMacPrefix=_0x16a347(0x1aa),reGeneratedMac=/^\s*(XX(\:\d{2}){5}|(FF\:){5}FF)/i,ipToMacAddress=_0x21ff17=>{const _0x3416bb=_0x16a347;return genMacPrefix+_0x21ff17[_0x3416bb(0x1ba)]('.')['map'](_0x266353=>('000'+_0x266353)[_0x3416bb(0x19d)](_0x266353['length']))[_0x3416bb(0x1b1)]('')[_0x3416bb(0x19d)](0x2)[_0x3416bb(0x1a0)](/(\d{2})/g,_0x3416bb(0x1a2))[_0x3416bb(0x1a0)](/:$/,'');},isGeneratedMacAddress=_0x383200=>{const _0x45bc6e=_0x16a347;return reGeneratedMac[_0x45bc6e(0x1bc)](_0x383200);};let validateIpInCIDR;function ipInSubnet(_0xf82d12,_0x198916,_0x1e615a,_0x163ab0){const _0x4f91c1=_0x16a347;if(!validateIpInCIDR){const _0x309299=_0xf82d12[0x1]?{'ipLow':IpSubnetCalculator[_0x4f91c1(0x1be)](_0xf82d12[0x0]),'ipHigh':IpSubnetCalculator[_0x4f91c1(0x1be)](_0xf82d12[0x1])}:IpSubnetCalculator[_0x4f91c1(0x1b0)](_0xf82d12[0x0],_0x198916);validateIpInCIDR=_0xa7ad5e=>{const _0x4f4370=_0x4f91c1;if(!/(\d+\.){3}\d+/[_0x4f4370(0x1bc)](_0xa7ad5e)||_0xa7ad5e==_0x1e615a[0x0]||_0xa7ad5e==_0x163ab0)return![];const _0x5bc128=IpSubnetCalculator[_0x4f4370(0x1be)](_0xa7ad5e),_0x5ccda0=_0x309299[_0x4f4370(0x1c0)]<=_0x5bc128&&_0x5bc128<=_0x309299[_0x4f4370(0x1ac)];return console['debug'](_0x4f4370(0x1b3),_0x5ccda0,_0xa7ad5e,_0x309299,_0x5bc128,_0xf82d12,_0x198916,_0x1e615a,_0x163ab0),_0x5ccda0;};}return validateIpInCIDR;}async function arphosts(_0x216619,_0x1815ee){const _0x2029c3=_0x16a347,{range:_0x2954a4,netmask:_0x5f2faf,router:_0x5e4dc6,broadcast:_0x39281b}=_0x216619;return _0x1815ee&&(hostsCache={}),_0x2954a4&&_0x5f2faf?ipInSubnet(_0x2954a4,_0x5f2faf,_0x5e4dc6,_0x39281b):validateIpInCIDR=_0x560881=>/(\d+\.){3}\d+/[_0x2029c3(0x1bc)](_0x560881),new Promise(function(_0x5a8647,_0x387d8d){const _0x49c102=_0x2029c3;let _0x1721f7=/win/i['test'](os[_0x49c102(0x1a5)]()),_0x1f3c6e=_0x1721f7?_0x49c102(0x199):_0x49c102(0x1b8);_0x216619&&_0x216619[_0x49c102(0x1b9)]?_0x1f3c6e+=(_0x1721f7?'-N\x20':_0x49c102(0x1a1))+_0x216619[_0x49c102(0x1b9)]:_0x1f3c6e+=_0x1721f7?'':'--retry=3\x20',spawn[_0x49c102(0x1a6)](_0x1f3c6e,function(_0x421575,_0xe49e64,_0x2f1841){const _0x353909=_0x49c102;if(_0x421575){let _0x468cc8=_0x353909(0x195)+_0x421575[_0x353909(0x1a7)]+_0x2f1841;return console['log'](_0x468cc8),_0x387d8d(_0x468cc8);}let _0x4eb671,_0x200f3a,_0x4f9373=_0xe49e64[_0x353909(0x1ba)]('\x0a');for(_0x4eb671=0x2;_0x4eb671<_0x4f9373[_0x353909(0x196)];_0x4eb671++){_0x200f3a=_0x4f9373[_0x4eb671][_0x353909(0x1bd)](/\s+/)[_0x353909(0x1ba)](/\s+/);let _0x299669=_0x200f3a[0x0];if(validateIpInCIDR(_0x299669)){let _0x222013=_0x200f3a[0x2]||_0x353909(0x19b),_0x4ceeb2=_0x200f3a[0x1]['toUpperCase']()[_0x353909(0x1a0)](/\-/g,':');!/\w{2}(:\w{2}){5}/[_0x353909(0x1bc)](_0x4ceeb2)&&(_0x4ceeb2=ipToMacAddress(_0x299669)),!hostsCache[_0x4ceeb2]&&(hostsCache[_0x4ceeb2]={'ip':_0x299669,'mac':_0x4ceeb2,'label':_0x222013}),hostsCache[_0x4ceeb2][_0x353909(0x1b4)]=Date[_0x353909(0x1ae)]();}}let _0x15ad05=Date[_0x353909(0x1ae)]()-staleCacheTimespan,_0x1c753a=_[_0x353909(0x1bb)](hostsCache,_0x3eb603=>{return _0x3eb603['timeStamp']>_0x15ad05;});console[_0x353909(0x19a)](_0x353909(0x19f)+_0x1c753a[_0x353909(0x196)]+_0x353909(0x1b6)+Object[_0x353909(0x19e)](hostsCache)[_0x353909(0x196)]+_0x353909(0x198)+_0x4f9373['length']),_0x5a8647(_0x1c753a);});})[_0x2029c3(0x19c)](_0x2e32a6=>{return null;});}module[_0x16a347(0x1a3)]={'arphosts':arphosts,'ipToMacAddress':ipToMacAddress,'isGeneratedMacAddress':isGeneratedMacAddress,'ipInSubnet':ipInSubnet};