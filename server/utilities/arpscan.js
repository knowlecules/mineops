/* Copyright (C) 9208-9721 Quebec, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Jason Rudland <jason.g.rudland@gmail.com>, September 2022
*/'use strict';const _0xd50060=_0x47f8;(function(_0x3252cf,_0x5417a5){const _0x4a552c=_0x47f8,_0x36635c=_0x3252cf();while(!![]){try{const _0x36fa33=-parseInt(_0x4a552c(0x1e4))/0x1+parseInt(_0x4a552c(0x1d1))/0x2*(-parseInt(_0x4a552c(0x1c6))/0x3)+-parseInt(_0x4a552c(0x1d8))/0x4*(-parseInt(_0x4a552c(0x1ce))/0x5)+parseInt(_0x4a552c(0x1d3))/0x6*(parseInt(_0x4a552c(0x1c1))/0x7)+-parseInt(_0x4a552c(0x1cd))/0x8*(-parseInt(_0x4a552c(0x1bf))/0x9)+parseInt(_0x4a552c(0x1d5))/0xa+parseInt(_0x4a552c(0x1d9))/0xb*(-parseInt(_0x4a552c(0x1e2))/0xc);if(_0x36fa33===_0x5417a5)break;else _0x36635c['push'](_0x36635c['shift']());}catch(_0x4ff88e){_0x36635c['push'](_0x36635c['shift']());}}}(_0x3f2c,0x26caa));const spawn=require(_0xd50060(0x1c9)),IpSubnetCalculator=require(_0xd50060(0x1be)),os=require('os'),_=require(_0xd50060(0x1bb));function _0x3f2c(){const _0x396ce1=['now','toDecimal','child_process','keys','$1:','exec','8mfKlIV','5570YnAuNE','arp\x20-a\x20','-N\x20','228YAKZbS','split','40020IKnKbc','replace','2980250nnhdID','catch','IsInCIDR','924arIqXu','308zJbdSF','exports','toUpperCase','ipHigh','ipLow','map','debug','XX:','log','50664sEahkI','code','217368RrBDoU','dev','substr',',\x20from\x20an\x20arp\x20count\x20of\x20','ARP\x20Scan\x20failed\x20with\x20error\x20code:\x20','000','length','test','lodash','filter','platform','ip-subnet-calculator','117891iYGEMk',',\x20cache\x20count:\x20','14izgczM','--interface=','--retry=3\x20','calculateCIDRPrefix','timeStamp','2298adBaWJ'];_0x3f2c=function(){return _0x396ce1;};return _0x3f2c();}let hostsCache={},staleCacheTimespan=0x3c*0x3c*0x3e8;function _0x47f8(_0x1f7393,_0x4e600b){const _0x3f2c16=_0x3f2c();return _0x47f8=function(_0x47f83a,_0x5785d5){_0x47f83a=_0x47f83a-0x1bb;let _0x568783=_0x3f2c16[_0x47f83a];return _0x568783;},_0x47f8(_0x1f7393,_0x4e600b);}const genMacPrefix=_0xd50060(0x1e0),reGeneratedMac=/^\s*(XX(\:\d{2}){5}|(FF\:){5}FF)/i,ipToMacAddress=_0x1c3231=>{const _0x15eddb=_0xd50060;return genMacPrefix+_0x1c3231[_0x15eddb(0x1d2)]('.')[_0x15eddb(0x1de)](_0x500018=>(_0x15eddb(0x1e9)+_0x500018)[_0x15eddb(0x1e6)](_0x500018[_0x15eddb(0x1ea)]))['join']('')[_0x15eddb(0x1e6)](0x2)[_0x15eddb(0x1d4)](/(\d{2})/g,_0x15eddb(0x1cb))['replace'](/:$/,'');},isGeneratedMacAddress=_0x57b345=>{const _0x575768=_0xd50060;return reGeneratedMac[_0x575768(0x1eb)](_0x57b345);};let validateIpInCIDR;function ipInSubnet(_0x353ece,_0x469bd1,_0x1a4dc0,_0x21d83c){const _0x27b917=_0xd50060;if(!validateIpInCIDR){const _0x1dac31=_0x353ece[0x1]?{'ipLow':IpSubnetCalculator['toDecimal'](_0x353ece[0x0]),'ipHigh':IpSubnetCalculator[_0x27b917(0x1c8)](_0x353ece[0x1])}:IpSubnetCalculator[_0x27b917(0x1c4)](_0x353ece[0x0],_0x469bd1);validateIpInCIDR=_0x95f5e6=>{const _0x4105c5=_0x27b917;if(!/(\d+\.){3}\d+/[_0x4105c5(0x1eb)](_0x95f5e6)||_0x95f5e6==_0x1a4dc0[0x0]||_0x95f5e6==_0x21d83c)return![];const _0x438c9e=IpSubnetCalculator[_0x4105c5(0x1c8)](_0x95f5e6),_0x2ac231=_0x1dac31[_0x4105c5(0x1dd)]<=_0x438c9e&&_0x438c9e<=_0x1dac31[_0x4105c5(0x1dc)];return console[_0x4105c5(0x1df)](_0x4105c5(0x1d7),_0x2ac231,_0x95f5e6,_0x1dac31,_0x438c9e,_0x353ece,_0x469bd1,_0x1a4dc0,_0x21d83c),_0x2ac231;};}return validateIpInCIDR;}async function arphosts(_0x5e098d,_0x58c9cb){const _0x132484=_0xd50060,{range:_0x450096,netmask:_0x1c79eb,router:_0x2a41af,broadcast:_0x40d1b8}=_0x5e098d;return _0x58c9cb&&(hostsCache={}),_0x450096&&_0x1c79eb?ipInSubnet(_0x450096,_0x1c79eb,_0x2a41af,_0x40d1b8):validateIpInCIDR=_0x190b64=>/(\d+\.){3}\d+/['test'](_0x190b64),new Promise(function(_0x2b646a,_0xf7cee0){const _0x3eb4f4=_0x47f8;let _0x1a0407=/win/i['test'](os[_0x3eb4f4(0x1bd)]()),_0x29ef83=_0x1a0407?_0x3eb4f4(0x1cf):'arp-scan\x20\x20-l\x20';_0x5e098d&&_0x5e098d[_0x3eb4f4(0x1e5)]?_0x29ef83+=(_0x1a0407?_0x3eb4f4(0x1d0):_0x3eb4f4(0x1c2))+_0x5e098d[_0x3eb4f4(0x1e5)]:_0x29ef83+=_0x1a0407?'':_0x3eb4f4(0x1c3),spawn[_0x3eb4f4(0x1cc)](_0x29ef83,function(_0x44c71a,_0x434315,_0x2f3362){const _0x4b0311=_0x3eb4f4;if(_0x44c71a){let _0x2fe859=_0x4b0311(0x1e8)+_0x44c71a[_0x4b0311(0x1e3)]+_0x2f3362;return console[_0x4b0311(0x1e1)](_0x2fe859),_0xf7cee0(_0x2fe859);}let _0xc6344a,_0x5c5674,_0x249a29=_0x434315[_0x4b0311(0x1d2)]('\x0a');for(_0xc6344a=0x2;_0xc6344a<_0x249a29[_0x4b0311(0x1ea)];_0xc6344a++){_0x5c5674=_0x249a29[_0xc6344a]['trim'](/\s+/)[_0x4b0311(0x1d2)](/\s+/);let _0x54fce1=_0x5c5674[0x0];if(validateIpInCIDR(_0x54fce1)){let _0x32fb55=_0x5c5674[0x2]||'unknown',_0x2c8270=_0x5c5674[0x1][_0x4b0311(0x1db)]()[_0x4b0311(0x1d4)](/\-/g,':');!/\w{2}(:\w{2}){5}/[_0x4b0311(0x1eb)](_0x2c8270)&&(_0x2c8270=ipToMacAddress(_0x54fce1)),!hostsCache[_0x2c8270]&&(hostsCache[_0x2c8270]={'ip':_0x54fce1,'mac':_0x2c8270,'label':_0x32fb55}),hostsCache[_0x2c8270][_0x4b0311(0x1c5)]=Date[_0x4b0311(0x1c7)]();}}let _0x3808cb=Date[_0x4b0311(0x1c7)]()-staleCacheTimespan,_0x1f503a=_[_0x4b0311(0x1bc)](hostsCache,_0x353fda=>{return _0x353fda['timeStamp']>_0x3808cb;});console[_0x4b0311(0x1e1)]('Viable\x20host\x20collection\x20size:'+_0x1f503a[_0x4b0311(0x1ea)]+_0x4b0311(0x1c0)+Object[_0x4b0311(0x1ca)](hostsCache)[_0x4b0311(0x1ea)]+_0x4b0311(0x1e7)+_0x249a29[_0x4b0311(0x1ea)]),_0x2b646a(_0x1f503a);});})[_0x132484(0x1d6)](_0x42f93c=>{return null;});}module[_0xd50060(0x1da)]={'arphosts':arphosts,'ipToMacAddress':ipToMacAddress,'isGeneratedMacAddress':isGeneratedMacAddress,'ipInSubnet':ipInSubnet};