/* Copyright (C) 9208-9721 Quebec, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Jason Rudland <jason.g.rudland@gmail.com>, September 2022
*/'use strict';function _0x4463(_0x4977a1,_0x1d587b){const _0x2ecdb2=_0x2ecd();return _0x4463=function(_0x446377,_0x123db8){_0x446377=_0x446377-0x135;let _0x205a3b=_0x2ecdb2[_0x446377];return _0x205a3b;},_0x4463(_0x4977a1,_0x1d587b);}const _0x3af3a3=_0x4463;(function(_0x28d5e3,_0x17038f){const _0x5d18e3=_0x4463,_0x4c34d0=_0x28d5e3();while(!![]){try{const _0x5128d2=-parseInt(_0x5d18e3(0x13a))/0x1+-parseInt(_0x5d18e3(0x158))/0x2*(parseInt(_0x5d18e3(0x15e))/0x3)+parseInt(_0x5d18e3(0x157))/0x4+parseInt(_0x5d18e3(0x14a))/0x5*(-parseInt(_0x5d18e3(0x159))/0x6)+-parseInt(_0x5d18e3(0x136))/0x7*(-parseInt(_0x5d18e3(0x137))/0x8)+-parseInt(_0x5d18e3(0x147))/0x9*(parseInt(_0x5d18e3(0x143))/0xa)+parseInt(_0x5d18e3(0x15c))/0xb*(parseInt(_0x5d18e3(0x139))/0xc);if(_0x5128d2===_0x17038f)break;else _0x4c34d0['push'](_0x4c34d0['shift']());}catch(_0x2f1033){_0x4c34d0['push'](_0x4c34d0['shift']());}}}(_0x2ecd,0xce042));const spawn=require(_0x3af3a3(0x13e)),IpSubnetCalculator=require(_0x3af3a3(0x162)),os=require('os'),_=require(_0x3af3a3(0x13d));let hostsCache={},staleCacheTimespan=0x3c*0x3c*0x3e8;function _0x2ecd(){const _0x39bdf6=['unknown','52740WjAtHH','--retry=3\x20','arp-scan\x20\x20-l\x20','trim','1467OiJFog','IsInCIDR','exports','477895MwRIBW','now','dev','ipHigh','platform','calculateCIDRPrefix','arp\x20-a\x20','filter','replace','length','catch','debug',',\x20cache\x20count:\x20','6445972SdnpzS','1137592WbChZZ','72tiKTuF','ipLow','keys','33IPtHsJ','toDecimal','6oKfCoc','XX:','$1:','log','ip-subnet-calculator','join','Viable\x20host\x20collection\x20size:','175bEaaZa','218216HVHaZi',',\x20from\x20an\x20arp\x20count\x20of\x20','8254044FWeOXL','368885YSINrS','test','split','lodash','child_process','map','substr','000'];_0x2ecd=function(){return _0x39bdf6;};return _0x2ecd();}const genMacPrefix=_0x3af3a3(0x15f),reGeneratedMac=/^\s*(XX(\:\d{2}){5}|(FF\:){5}FF)/i,ipToMacAddress=_0x5c1ff3=>{const _0x53c30c=_0x3af3a3;return genMacPrefix+_0x5c1ff3[_0x53c30c(0x13c)]('.')[_0x53c30c(0x13f)](_0x34e340=>(_0x53c30c(0x141)+_0x34e340)[_0x53c30c(0x140)](_0x34e340[_0x53c30c(0x153)]))[_0x53c30c(0x163)]('')[_0x53c30c(0x140)](0x2)['replace'](/(\d{2})/g,_0x53c30c(0x160))[_0x53c30c(0x152)](/:$/,'');},isGeneratedMacAddress=_0x1061c3=>{const _0x3e60b2=_0x3af3a3;return reGeneratedMac[_0x3e60b2(0x13b)](_0x1061c3);};let validateIpInCIDR;function ipInSubnet(_0x3f5417,_0x40015b,_0xea0cda,_0x49c696){const _0xf19671=_0x3af3a3;if(!validateIpInCIDR){const _0x2c6fbd=_0x3f5417[0x1]?{'ipLow':IpSubnetCalculator[_0xf19671(0x15d)](_0x3f5417[0x0]),'ipHigh':IpSubnetCalculator[_0xf19671(0x15d)](_0x3f5417[0x1])}:IpSubnetCalculator[_0xf19671(0x14f)](_0x3f5417[0x0],_0x40015b);validateIpInCIDR=_0x43a7c7=>{const _0x567757=_0xf19671;if(!/(\d+\.){3}\d+/[_0x567757(0x13b)](_0x43a7c7)||_0x43a7c7==_0xea0cda[0x0]||_0x43a7c7==_0x49c696)return![];const _0x15e896=IpSubnetCalculator[_0x567757(0x15d)](_0x43a7c7),_0xed92f0=_0x2c6fbd[_0x567757(0x15a)]<=_0x15e896&&_0x15e896<=_0x2c6fbd[_0x567757(0x14d)];return console[_0x567757(0x155)](_0x567757(0x148),_0xed92f0,_0x43a7c7,_0x2c6fbd,_0x15e896,_0x3f5417,_0x40015b,_0xea0cda,_0x49c696),_0xed92f0;};}return validateIpInCIDR;}async function arphosts(_0x23ee8b,_0x13b3f9){const _0x5bb69a=_0x3af3a3,{range:_0xc435c6,netmask:_0x4f15ce,router:_0x4b1a00,broadcast:_0x4ed513}=_0x23ee8b;return _0x13b3f9&&(hostsCache={}),_0xc435c6&&_0x4f15ce?ipInSubnet(_0xc435c6,_0x4f15ce,_0x4b1a00,_0x4ed513):validateIpInCIDR=_0x5475f9=>/(\d+\.){3}\d+/[_0x5bb69a(0x13b)](_0x5475f9),new Promise(function(_0x238e29,_0x140e78){const _0x9b561f=_0x5bb69a;let _0xb8652c=/win/i[_0x9b561f(0x13b)](os[_0x9b561f(0x14e)]()),_0x37bf15=_0xb8652c?_0x9b561f(0x150):_0x9b561f(0x145);_0x23ee8b&&_0x23ee8b[_0x9b561f(0x14c)]?_0x37bf15+=(_0xb8652c?'-N\x20':'--interface=')+_0x23ee8b['dev']:_0x37bf15+=_0xb8652c?'':_0x9b561f(0x144),spawn['exec'](_0x37bf15,function(_0x36269a,_0x17764d,_0x5c6759){const _0x49c0f5=_0x9b561f;if(_0x36269a){let _0x466386='ARP\x20Scan\x20failed\x20with\x20error\x20code:\x20'+_0x36269a['code']+_0x5c6759;return console[_0x49c0f5(0x161)](_0x466386),_0x140e78(_0x466386);}let _0x54b8a5,_0x2908f6,_0x56280a=_0x17764d[_0x49c0f5(0x13c)]('\x0a');for(_0x54b8a5=0x2;_0x54b8a5<_0x56280a[_0x49c0f5(0x153)];_0x54b8a5++){_0x2908f6=_0x56280a[_0x54b8a5][_0x49c0f5(0x146)](/\s+/)[_0x49c0f5(0x13c)](/\s+/);let _0x5187ee=_0x2908f6[0x0];if(validateIpInCIDR(_0x5187ee)){let _0x17d0fa=_0x2908f6[0x2]||_0x49c0f5(0x142),_0x57d52f=_0x2908f6[0x1]['toUpperCase']()[_0x49c0f5(0x152)](/\-/g,':');!/\w{2}(:\w{2}){5}/[_0x49c0f5(0x13b)](_0x57d52f)&&(_0x57d52f=ipToMacAddress(_0x5187ee)),!hostsCache[_0x57d52f]&&(hostsCache[_0x57d52f]={'ip':_0x5187ee,'mac':_0x57d52f,'label':_0x17d0fa}),hostsCache[_0x57d52f]['timeStamp']=Date[_0x49c0f5(0x14b)]();}}let _0x3c8df3=Date[_0x49c0f5(0x14b)]()-staleCacheTimespan,_0x3d754c=_[_0x49c0f5(0x151)](hostsCache,_0x24949f=>{return _0x24949f['timeStamp']>_0x3c8df3;});console[_0x49c0f5(0x161)](_0x49c0f5(0x135)+_0x3d754c['length']+_0x49c0f5(0x156)+Object[_0x49c0f5(0x15b)](hostsCache)[_0x49c0f5(0x153)]+_0x49c0f5(0x138)+_0x56280a[_0x49c0f5(0x153)]),_0x238e29(_0x3d754c);});})[_0x5bb69a(0x154)](_0x5929c2=>{return null;});}module[_0x3af3a3(0x149)]={'arphosts':arphosts,'ipToMacAddress':ipToMacAddress,'isGeneratedMacAddress':isGeneratedMacAddress,'ipInSubnet':ipInSubnet};