/* Copyright (C) 9208-9721 Quebec, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Jason Rudland <jason.g.rudland@gmail.com>, September 2022
*/'use strict';const _0xecbafb=_0x82d2;(function(_0x4081b7,_0x4d0240){const _0x46199d=_0x82d2,_0x8c316=_0x4081b7();while(!![]){try{const _0x42895d=-parseInt(_0x46199d(0x1ff))/0x1*(parseInt(_0x46199d(0x20f))/0x2)+parseInt(_0x46199d(0x1e9))/0x3+parseInt(_0x46199d(0x1f6))/0x4+-parseInt(_0x46199d(0x215))/0x5+-parseInt(_0x46199d(0x1f0))/0x6+parseInt(_0x46199d(0x1f2))/0x7*(parseInt(_0x46199d(0x1f3))/0x8)+-parseInt(_0x46199d(0x201))/0x9;if(_0x42895d===_0x4d0240)break;else _0x8c316['push'](_0x8c316['shift']());}catch(_0x5430ee){_0x8c316['push'](_0x8c316['shift']());}}}(_0x249a,0x7ac7e));const spawn=require('child_process'),IpSubnetCalculator=require(_0xecbafb(0x207)),os=require('os'),_=require(_0xecbafb(0x203));let hostsCache={},staleCacheTimespan=0x3c*0x3c*0x3e8;const genMacPrefix=_0xecbafb(0x20e),reGeneratedMac=/^\s*(XX(\:\d{2}){5}|(FF\:){5}FF)/i,ipToMacAddress=_0x1f0392=>{const _0x1e4609=_0xecbafb;return genMacPrefix+_0x1f0392['split']('.')[_0x1e4609(0x1fc)](_0x3a4733=>(_0x1e4609(0x1f5)+_0x3a4733)[_0x1e4609(0x1fb)](_0x3a4733[_0x1e4609(0x1ec)]))[_0x1e4609(0x200)]('')[_0x1e4609(0x1fb)](0x2)[_0x1e4609(0x20d)](/(\d{2})/g,_0x1e4609(0x216))[_0x1e4609(0x20d)](/:$/,'');},isGeneratedMacAddress=_0x97e8d6=>{const _0x39a9a0=_0xecbafb;return reGeneratedMac[_0x39a9a0(0x202)](_0x97e8d6);};function _0x82d2(_0x5bbc15,_0x255f3a){const _0x249a94=_0x249a();return _0x82d2=function(_0x82d21c,_0x43bd54){_0x82d21c=_0x82d21c-0x1e9;let _0x3fe763=_0x249a94[_0x82d21c];return _0x3fe763;},_0x82d2(_0x5bbc15,_0x255f3a);}let validateIpInCIDR;function ipInSubnet(_0xdfbb4a,_0x5cbc0c,_0x3d54cb,_0x26c5b3){const _0x5341ac=_0xecbafb;if(!validateIpInCIDR){const _0xe95de6=_0xdfbb4a[0x1]?{'ipLow':IpSubnetCalculator[_0x5341ac(0x1eb)](_0xdfbb4a[0x0]),'ipHigh':IpSubnetCalculator[_0x5341ac(0x1eb)](_0xdfbb4a[0x1])}:IpSubnetCalculator[_0x5341ac(0x212)](_0xdfbb4a[0x0],_0x5cbc0c);validateIpInCIDR=_0x1f8b3c=>{const _0x36c37e=_0x5341ac;if(!/(\d+\.){3}\d+/['test'](_0x1f8b3c)||_0x1f8b3c==_0x3d54cb[0x0]||_0x1f8b3c==_0x26c5b3)return![];const _0x1c8c55=IpSubnetCalculator['toDecimal'](_0x1f8b3c),_0x1fc459=_0xe95de6[_0x36c37e(0x1ef)]<=_0x1c8c55&&_0x1c8c55<=_0xe95de6[_0x36c37e(0x1f8)];return console[_0x36c37e(0x211)](_0x36c37e(0x208),_0x1fc459,_0x1f8b3c,_0xe95de6,_0x1c8c55,_0xdfbb4a,_0x5cbc0c,_0x3d54cb,_0x26c5b3),_0x1fc459;};}return validateIpInCIDR;}async function arphosts(_0x4073da,_0x2d116d){const _0xda623d=_0xecbafb,{range:_0x5a9955,netmask:_0x543dbd,router:_0x334875,broadcast:_0x5478e2}=_0x4073da;return _0x2d116d&&(hostsCache={}),_0x5a9955&&_0x543dbd?ipInSubnet(_0x5a9955,_0x543dbd,_0x334875,_0x5478e2):validateIpInCIDR=_0x13957f=>/(\d+\.){3}\d+/[_0xda623d(0x202)](_0x13957f),new Promise(function(_0x46ccb1,_0x7b1e87){const _0x58e380=_0xda623d;let _0x4bd267=/win/i['test'](os[_0x58e380(0x1ed)]()),_0x25eb8e=_0x4bd267?_0x58e380(0x210):_0x58e380(0x1fa);_0x4073da&&_0x4073da['dev']?_0x25eb8e+=(_0x4bd267?'-N\x20':_0x58e380(0x1f1))+_0x4073da[_0x58e380(0x204)]:_0x25eb8e+=_0x4bd267?'':_0x58e380(0x213),spawn[_0x58e380(0x1f7)](_0x25eb8e,function(_0x38583e,_0x5c79f4,_0x1e8fce){const _0xc9c607=_0x58e380;if(_0x38583e){let _0x580618=_0xc9c607(0x1fd)+_0x38583e['code']+_0x1e8fce;return console['log'](_0x580618),_0x7b1e87(_0x580618);}let _0x458808,_0x2ef743,_0x15a730=_0x5c79f4[_0xc9c607(0x1fe)]('\x0a');for(_0x458808=0x2;_0x458808<_0x15a730[_0xc9c607(0x1ec)];_0x458808++){_0x2ef743=_0x15a730[_0x458808]['trim'](/\s+/)['split'](/\s+/);let _0x12d01f=_0x2ef743[0x0];if(validateIpInCIDR(_0x12d01f)){let _0x184d3c=_0x2ef743[0x2]||_0xc9c607(0x205),_0x254097=_0x2ef743[0x1][_0xc9c607(0x1f9)]()[_0xc9c607(0x20d)](/\-/g,':');!/\w{2}(:\w{2}){5}/[_0xc9c607(0x202)](_0x254097)&&(_0x254097=ipToMacAddress(_0x12d01f)),!hostsCache[_0x254097]&&(hostsCache[_0x254097]={'ip':_0x12d01f,'mac':_0x254097,'label':_0x184d3c}),hostsCache[_0x254097][_0xc9c607(0x1ea)]=Date[_0xc9c607(0x214)]();}}let _0x253e42=Date[_0xc9c607(0x214)]()-staleCacheTimespan,_0x21144a=_[_0xc9c607(0x20a)](hostsCache,_0x57c072=>{const _0x32b240=_0xc9c607;return _0x57c072[_0x32b240(0x1ea)]>_0x253e42;});console[_0xc9c607(0x206)]('Viable\x20host\x20collection\x20size:'+_0x21144a[_0xc9c607(0x1ec)]+_0xc9c607(0x20b)+Object[_0xc9c607(0x209)](hostsCache)[_0xc9c607(0x1ec)]+_0xc9c607(0x1ee)+_0x15a730['length']),_0x46ccb1(_0x21144a);});})[_0xda623d(0x20c)](_0x593b74=>{return null;});}module[_0xecbafb(0x1f4)]={'arphosts':arphosts,'ipToMacAddress':ipToMacAddress,'isGeneratedMacAddress':isGeneratedMacAddress,'ipInSubnet':ipInSubnet};function _0x249a(){const _0x311ae2=['000','2792976mFUqeP','exec','ipHigh','toUpperCase','arp-scan\x20\x20-l\x20','substr','map','ARP\x20Scan\x20failed\x20with\x20error\x20code:\x20','split','13SUcpfU','join','2895390IojZEE','test','lodash','dev','unknown','log','ip-subnet-calculator','IsInCIDR','keys','filter',',\x20cache\x20count:\x20','catch','replace','XX:','42618VOjOis','arp\x20-a\x20','debug','calculateCIDRPrefix','--retry=3\x20','now','1856000QEONQG','$1:','2092605JoUkJd','timeStamp','toDecimal','length','platform',',\x20from\x20an\x20arp\x20count\x20of\x20','ipLow','4345146OTECDi','--interface=','133TChWYU','337368gRFwfn','exports'];_0x249a=function(){return _0x311ae2;};return _0x249a();}