/* Copyright (C) 9208-9721 Quebec, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Jason Rudland <jason.g.rudland@gmail.com>, September 2022
*/'use strict';const _0x4b849f=_0x1b25;(function(_0x25f83f,_0x111ed2){const _0xc63dfd=_0x1b25,_0x506d4e=_0x25f83f();while(!![]){try{const _0x2c39bb=parseInt(_0xc63dfd(0xe4))/0x1*(parseInt(_0xc63dfd(0xe3))/0x2)+parseInt(_0xc63dfd(0xf1))/0x3*(parseInt(_0xc63dfd(0x102))/0x4)+parseInt(_0xc63dfd(0xf6))/0x5+-parseInt(_0xc63dfd(0xf7))/0x6+-parseInt(_0xc63dfd(0xef))/0x7*(-parseInt(_0xc63dfd(0xf8))/0x8)+parseInt(_0xc63dfd(0xfe))/0x9*(parseInt(_0xc63dfd(0xdf))/0xa)+-parseInt(_0xc63dfd(0xee))/0xb*(parseInt(_0xc63dfd(0xdb))/0xc);if(_0x2c39bb===_0x111ed2)break;else _0x506d4e['push'](_0x506d4e['shift']());}catch(_0x4612b5){_0x506d4e['push'](_0x506d4e['shift']());}}}(_0x3f15,0xc7bd1));const spawn=require(_0x4b849f(0xea)),IpSubnetCalculator=require(_0x4b849f(0xda)),os=require('os'),_=require(_0x4b849f(0xf0));let hostsCache={},staleCacheTimespan=0x3c*0x3c*0x3e8;function _0x1b25(_0x5c9748,_0x1d6f55){const _0x3f1517=_0x3f15();return _0x1b25=function(_0x1b2572,_0x57e530){_0x1b2572=_0x1b2572-0xd9;let _0x2b1b28=_0x3f1517[_0x1b2572];return _0x2b1b28;},_0x1b25(_0x5c9748,_0x1d6f55);}const genMacPrefix='XX:',reGeneratedMac=/^\s*(XX(\:\d{2}){5}|(FF\:){5}FF)/i,ipToMacAddress=_0x2f98a8=>{const _0x27fddd=_0x4b849f;return genMacPrefix+_0x2f98a8[_0x27fddd(0xed)]('.')[_0x27fddd(0xe1)](_0x189ec2=>(_0x27fddd(0xfd)+_0x189ec2)[_0x27fddd(0xe0)](_0x189ec2[_0x27fddd(0xec)]))[_0x27fddd(0xfa)]('')[_0x27fddd(0xe0)](0x2)['replace'](/(\d{2})/g,_0x27fddd(0x104))[_0x27fddd(0xeb)](/:$/,'');},isGeneratedMacAddress=_0x2aa08c=>{const _0x571d83=_0x4b849f;return reGeneratedMac[_0x571d83(0xf3)](_0x2aa08c);};function _0x3f15(){const _0x722b7c=['unknown',',\x20from\x20an\x20arp\x20count\x20of\x20','exports','50350RcKgbM','substr','map','dev','240502hGwTuI','1ZlTgMR','--retry=3\x20','timeStamp','ipLow','arp-scan\x20\x20-l\x20','ipHigh','child_process','replace','length','split','44JfeEQE','28lhujiT','lodash','402fzIPHh','now','test','log','catch','1592255bHZbID','5058216WFbISL','68304nZoURn','code','join','toDecimal','--interface=','000','2547ouLdNW','ARP\x20Scan\x20failed\x20with\x20error\x20code:\x20','Viable\x20host\x20collection\x20size:','-N\x20','12156XJywTq','trim','$1:','arp\x20-a\x20','exec','ip-subnet-calculator','1931460psEWug'];_0x3f15=function(){return _0x722b7c;};return _0x3f15();}let validateIpInCIDR;function ipInSubnet(_0x417cc6,_0x485bfb,_0x4261a8,_0x354477){const _0x4a0753=_0x4b849f;if(!validateIpInCIDR){const _0x230eee=_0x417cc6[0x1]?{'ipLow':IpSubnetCalculator[_0x4a0753(0xfb)](_0x417cc6[0x0]),'ipHigh':IpSubnetCalculator[_0x4a0753(0xfb)](_0x417cc6[0x1])}:IpSubnetCalculator['calculateCIDRPrefix'](_0x417cc6[0x0],_0x485bfb);validateIpInCIDR=_0xe2d10d=>{const _0x21b322=_0x4a0753;if(!/(\d+\.){3}\d+/[_0x21b322(0xf3)](_0xe2d10d)||_0xe2d10d==_0x4261a8[0x0]||_0xe2d10d==_0x354477)return![];const _0x452ccb=IpSubnetCalculator[_0x21b322(0xfb)](_0xe2d10d),_0x579851=_0x230eee[_0x21b322(0xe7)]<=_0x452ccb&&_0x452ccb<=_0x230eee[_0x21b322(0xe9)];return console['debug']('IsInCIDR',_0x579851,_0xe2d10d,_0x230eee,_0x452ccb,_0x417cc6,_0x485bfb,_0x4261a8,_0x354477),_0x579851;};}return validateIpInCIDR;}async function arphosts(_0x595547,_0x24f45e){const _0x6f1c87=_0x4b849f,{range:_0x318dd6,netmask:_0x54fb77,router:_0x941946,broadcast:_0x2a9b47}=_0x595547;return _0x24f45e&&(hostsCache={}),_0x318dd6&&_0x54fb77?ipInSubnet(_0x318dd6,_0x54fb77,_0x941946,_0x2a9b47):validateIpInCIDR=_0x288626=>/(\d+\.){3}\d+/['test'](_0x288626),new Promise(function(_0x546724,_0x1ceece){const _0x22610a=_0x1b25;let _0xc07e59=/win/i[_0x22610a(0xf3)](os['platform']()),_0x191363=_0xc07e59?_0x22610a(0x105):_0x22610a(0xe8);_0x595547&&_0x595547[_0x22610a(0xe2)]?_0x191363+=(_0xc07e59?_0x22610a(0x101):_0x22610a(0xfc))+_0x595547[_0x22610a(0xe2)]:_0x191363+=_0xc07e59?'':_0x22610a(0xe5),spawn[_0x22610a(0xd9)](_0x191363,function(_0x1c6c8f,_0x565b6f,_0x5a7c97){const _0x395823=_0x22610a;if(_0x1c6c8f){let _0x1101f6=_0x395823(0xff)+_0x1c6c8f[_0x395823(0xf9)]+_0x5a7c97;return console[_0x395823(0xf4)](_0x1101f6),_0x1ceece(_0x1101f6);}let _0x154afc,_0x255ec5,_0x9877d4=_0x565b6f[_0x395823(0xed)]('\x0a');for(_0x154afc=0x2;_0x154afc<_0x9877d4[_0x395823(0xec)];_0x154afc++){_0x255ec5=_0x9877d4[_0x154afc][_0x395823(0x103)](/\s+/)[_0x395823(0xed)](/\s+/);let _0x28ec9a=_0x255ec5[0x0];if(validateIpInCIDR(_0x28ec9a)){let _0x538c6=_0x255ec5[0x2]||_0x395823(0xdc),_0x35b5ae=_0x255ec5[0x1]['toUpperCase']()['replace'](/\-/g,':');!/\w{2}(:\w{2}){5}/[_0x395823(0xf3)](_0x35b5ae)&&(_0x35b5ae=ipToMacAddress(_0x28ec9a)),!hostsCache[_0x35b5ae]&&(hostsCache[_0x35b5ae]={'ip':_0x28ec9a,'mac':_0x35b5ae,'label':_0x538c6}),hostsCache[_0x35b5ae][_0x395823(0xe6)]=Date[_0x395823(0xf2)]();}}let _0x53f337=Date[_0x395823(0xf2)]()-staleCacheTimespan,_0x223a7b=_['filter'](hostsCache,_0x14ca55=>{const _0x294d18=_0x395823;return _0x14ca55[_0x294d18(0xe6)]>_0x53f337;});console[_0x395823(0xf4)](_0x395823(0x100)+_0x223a7b['length']+',\x20cache\x20count:\x20'+Object['keys'](hostsCache)['length']+_0x395823(0xdd)+_0x9877d4[_0x395823(0xec)]),_0x546724(_0x223a7b);});})[_0x6f1c87(0xf5)](_0x2cc3ca=>{return null;});}module[_0x4b849f(0xde)]={'arphosts':arphosts,'ipToMacAddress':ipToMacAddress,'isGeneratedMacAddress':isGeneratedMacAddress,'ipInSubnet':ipInSubnet};