# MineOps-api

## About

MineOps, the simplest way to provision and manage asic miners for multiple clients. 

## Requirements

- nodejs
- mongo
- raspberry PI or better
- git 


### Installation

Prior to starting â€“ please make sure the file dcs_root.json has been properly configured.

Install
- nodejs
- mongodb
- pm2 (*suggested) 

Create database &quot;mineops_local&quot;
open mongodb shell
```bash
mongo
```

create database
```bash
use mineops_local
```

close mongo shell
```bash
exit
```

checkout source and install
dependencies
```bash
npm i
```

import dataCenterSettings (Copy dcs_root.json and edit the properties or you will have to edit directly
in mongo)
```bash
cd mineops/data
mongoimport -c dataCenterSettings -d mineops_local --file dcs_root.json
```

```bash
npm start
```

After logging in, go to the miners page and click the refresh button.

Appendix

```json
{
    "minerIndex" : 356262,
    "cabinetName" : "DH1.7",
    "cabinetPosition" : 52,
    "workerTypeNumber" : "07052",
    "staticAssignment" : true,
    "configureMode" : 1,
    "accountName" : "mineops",
    "enablePoolConfiguration" : true,
    "enableDHCPServer" : false,
    "enableSlack" : true,
    "enableDiscoveryOnStartup" : false,
    "networkScanInterval" : 300000,
    "locationID" : "DBD",
    "locationName" : "Deep Block Data, St-Just",
    "noReplyEmail" : "noreply@mineops.org",
    "active" : true,
    "dhcpSettings" : {
            "range" : [
                    "192.168.0.2",
                    "192.168.7.253"
            ],
            "netmask" : "255.255.248.0",
            "router" : [
                    "192.168.0.1"
            ],
            "broadcast" : "192.168.15.255",
            "server" : "192.168.7.x",
            "dns" : [
                    "8.8.8.8",
                    "8.8.4.4"
            ],
            "hostname" : "mineops",
            "domainName" : "rdc.local",
            "timeServer" : null,
            "nameServer" : null,
            "maxMessageSize" : 1500,
            "leaseTime" : 86400,
            "renewalTime" : 60,
            "rebindingTime" : 120,
            "scanThrottleCount" : 200
    },
    "enableProvisionOnDetect" : true,
    "machinesPerShelf" : "6",
    "minerNumberFormat" : "RRSSP",
    "inactiveAlarmPercentage" : 3,
    "email" : {
            "from" : "Mineops support<support@mineops.org>",
            "to" : "jason.k@mineops.org"
    },
    "availableKilowatts" : 1200
}

```

* To debug in Visual Studio Code:
  * Select the Debug MineOps configuration (default configuration) then press F5.
  * To debug with hot reloading, select the Debug MineOps (Hot Reload) configuration then press F5.
* To debug in Chrome/Brave, from the command line at the root of the application, run `node --inspect-brk app.js`. Once running, the terminal should have an output similar to this.

```text
Debugger listening on port 9229.
Warning: This is an experimental feature and could change at any time.
To start debugging, open the following URL in Chrome:
    chrome-devtools://devtools/bundled/inspector.html?experiments=true&v8only=true&ws=127.0.0.1:9229/bfd80bfb-65e3-4a03-bb44-092dff9e3da7
```

Paste the URL provide in the terminal, e.g. `chrome-devtools://devtools/bundled/inspector.html?experiments=true&v8only=true&ws=127.0.0.1:9229/bfd80bfb-65e3-4a03-bb44-092dff9e3da7` and paste it into the address bar in Chrome/Brave. From there you will be able to debug the application.

### Troubleshooting

* If you have issues with precommit scripts nochrome-devtools://devtools/bundled/inspector.html?experiments=true&v8only=true&ws=127.0.0.1:9229/bfd80bfb-65e3-4a03-bb44-092dff9e3da7t running, it's most likely because you reinstalled your packages and npm reinstalled from its cache. When you reinstall from the cache, post install scripts of packages do not reinstall. To fix this, delete your `node_modules` folder then run `npm install --no-cache`.# My Application

The project is generated by [LoopBack](http://loopback.io).

### .env
```bash
NODE_DEBUG=proxy
smtpTransport={"service": "Gmail","auth": {"user": "username@gmail.com", "pass": "Pa55w0rd"}}
NODE_ENV=
DISABLE_CONSOLE_METHODS=trace,info
CONSOLE_METHODS_FILTER={"debug":{"key":"logType", "matchText":"_trace", "method":"log"}} 
LOG_LEVEL_OPTIONS= ERROR, WARNING, LOG, INFO, DEBUG, ALL
LOG_LEVEL=INFO
MESSAGE_SERVICES=
_NETWORK_DIAGNOSTIC={"type":"ping", "ipAddress":"8.8.8.8"}
_MONGO_URL=mongodb+srv://mineops_admin:secretkey.mongodb.net/mineopsCentral?retryWrites=true&w=majority
DEBUG=loopback:zzzdatasource
UNSAFE_EDITS=true;  
```
